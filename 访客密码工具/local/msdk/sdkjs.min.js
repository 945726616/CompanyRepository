/*
CryptoJS v3.0.2
code.google.com/p/crypto-js
(c) 2009-2012 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*//*
CryptoJS v3.0.2
code.google.com/p/crypto-js
(c) 2009-2012 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*//*
    mcloud_account
    
    base on:
    cryptojs_tripledes.js
    cryptojs_pad-nopadding-min.js

    mlib.core.base.js
    mlib.core.codec.js
    mlib.core.evt.js
    mlib.core.rpc.js
    mlib.crypt.dh.js
    mlib.crypt.md5.js
    
    ----history----------
    author: chengzhiyong date: 2014-08-13 action: create
    
*//*
    mcloud_agent
    depends:
        mlib.cloud.account.js
            cryptojs_tripledes.js
            cryptojs_pad-nopadding-min.js
            mlib.crypt.dh.js
            mlib.crypt.md5.js
            mlib.core.rpc.js
                mlib.core.codec.js
                mlib.core.evt.js
   
    ----history----------
    author: chengzhiyong date: 2014-08-13 action: create
*//*
    depends : none
    author: chengzhiyong date:2014-08-13 action:cut from core.js
*/

/* mining lib js *//*
    mcodec
    depends : none
    
    ----history----------
    author: chengzhiyong date:2014-08-13 action: update to indepent meval
*//* 
    mevt
    depends : none
    author : chengzhiyong    date : 2014-08-13  action: add denpends info
*//*
    mhack
    depends : none
    author : chengzhiyong    date : 2014-08-13   action : add denpends info
*//*
    mme
    depends :
        mlib.core.json.js
        mlib.core.evt.js
    
    author : chengzhiyong   date : 2014-08-13   action : add denpends info
*/
/*-----------------media_engine-------------------------------------------------*/
/* dom's background:black for chrome*//*
    mrpc
    depends :
        mlib.mcore.codec.js
        mlib.mcore.evt.js
        

    author: chenghizyong date: 2014-08-31 action: update depends information
*/
/*-----------------mrpc-------------------------------------------------*/
/* mrpc.call({...});  *//*
    mdh
    depends : none
    
    ----history----------
    author: chengzhiyong date: 2014-08-13 action: update depends info
*//*
    mmd5
    depends : none
    
    ----history----------
    author: chengzhiyong date: 2014-08-13 action: update depends info
*/
/*-----------------mmd5---------------------------------------------------*/
/*--trim by kugle 2012-07-08 for better speed and compress size-------------*//**
 * @license
 * Video.js 6.6.3 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 *//**
 * videojs-hlsjs-plugin
 * v1.0.10
 * 2019-02-26
 * www.streamroot.io
 * Copyright 漏 2018
 **/
/*

 Video.js 6.6.3 <http://videojs.com/>
 Copyright Brightcove, Inc. <https://www.brightcove.com/>
 Available under Apache License Version 2.0
 <https://github.com/videojs/video.js/blob/master/LICENSE>

 Includes vtt.js <https://github.com/mozilla/vtt.js>
 Available under Apache License Version 2.0
 <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
*/
function callNative(t,y,p){"ios"==g_browser?call_ios_native(t,y,p):"android"==g_browser?call_android_native(t,y,p):"web"==g_browser?(new MSdk(y)).sdk_callNative(t,y,p):log("Unsupported system")}function onEvent(t){"ios"==g_browser?call_ios_event(t):"android"==g_browser?call_android_event(t):"web"==g_browser?call_web_event(t):log("Unsupported system")}function callback_live_play(t){t="string"===typeof t?eval("("+t+")"):t;var y={};y.data={ref:t.param.data.ref,result:t.result};y.ref=t.param.ref;onEvent(JSON.stringify(y))}function callback_play_destory(t){t="string"===typeof t?eval("("+t+")"):t;var y={};y.data={ref:t.param.data.ref,result:t.result};y.ref=t.param.ref;onEvent(JSON.stringify(y))}function call_android_native(t,y,p){window.McldActivityNativeJS.callNative(t,y,p)}function call_android_event(t){window.McldActivityNativeJS.onEvent(t)}function call_ios_native(t,y,p){callOCNative(t,y,p)}function call_ios_event(t){callOCOnEvent(t)}function call_web_event(t){(new MSdk(t)).sdk_onEvent(t)}function log(t){g_isLog&&console.log(t)}g_func=[];g_version="v6.6.1.1906101100";g_appId=g_browser="";g_isLog=!1;g_language="en";g_user_pass=g_user_name=msdk_agent=g_time_zone=g_sdk_version="";var g_server_https,g_server_http,g_server_device="";function boxlist_func(t){function y(m,h){function l(){var b,d,f,v;if(1>E)return 1;d=128<=r[B];for(v=0;4>v;v++)f=0==v?r[B]&127:f<<8|r[B+v];B+=4;if(f>C)return 1;if(d){var l;l=r[B]>>4;var h=r[B]&15;if(32<8*h+4)var D=c(b,h,1);else for(v=0;v<h;v++)l|=r[B+1+v]<<8*v+4;for(v=0;v<f;v++){g++;if(g>=C)return 1;e[g]="number"!=typeof e[g-1]||D?a(e[g-1],D?D:l):e[g-1]+l}B=B+1+h}if(!d&&0!=f)for(v=0;v<f;v++){b=r[B]>>4;h=r[B]&15;d=8*h+4;if(32<d)D=c(b,h,0);else for(d=0;d<h;d++)b|=r[B+1+d]<<8*d+4;g++;if(g>=C)return 1;e[g-1];e[g]="number"!=typeof e[g-1]||D?a(e[g-1],D?D:b):e[g-1]+b;B=B+1+h;D=""}return 0}function f(a){a=a.toString(16);return 4==a.length?a:3==a.length?"0"+a:2==a.length?"00"+a:"000"+a}function d(a){return 4==a.length?a:3==a.length?"0"+a:2==a.length?"00"+a:"000"+a}function a(a,c){var e=[],g;a=b(a);c=b(c);g=[];for(var r=0,f=3;-1<f;f--){var v="0x"+a[f].toString(16),C="0x"+c[f].toString(16);g[f]=(parseInt(v)+parseInt(C)+(r?1:0)).toString(16);(r="0x"+g[f]&65536)&&(g[f]=("0x"+g[f]&65535).toString(16))}g="0x"+g[0]+d(g[1])+d(g[2])+d(g[3]);for(r=3;-1<r;r--)g?(e[r]=parseInt(g.substring(0<g.length-4?g.length-4:0,g.length),16),g=g.substring(0,0<g.length-4?g.length-4:0)):e[r]=0;return e}function b(a){if("number"==typeof a){var c=a.toString(2);if(16>c.length)return[0,0,0,a];if(32>c.length)return[0,0,a>>16,a&65535]}else return a}function c(a,c,b){b=b?5:1;a=[0,0,0,a];for(i=0;i<c;i++){var e=r[B+b+i],g=8*i+12;if(16>g)a[3]|=e<<g-8;else if(16<g&&32>g)if(24>g){for(var d=16-(32-g),f=e.toString(2),f=f.substring(f.length-d,f.length),d=0;d<32-g;d++)f+="0";a[3]|=parseInt(f,2);a[2]|=e>>32-g-8}else a[2]|=e<<g-16-8;else if(32<g&&48>g)if(40>g){d=16-(48-g);f=e.toString(2);f=f.substring(f.length-d,f.length);for(d=0;d<48-g;d++)f+="0";a[2]|=parseInt(f,2);a[1]|=e>>48-g-8}else a[1]|=e<<g-32-8;else if(48<g&&72>g)if(56>g){d=16-(64-g);e&&(f=e.toString(2));f=f.substring(f.length-d,f.length);for(d=0;d<64-g;d++)f+="0";a[1]|=parseInt(f,2);a[0]|=e>>64-g-8}else a[0]|=e<<g-48-8}return a}var e=[],g=0,r=mcodec.b64_2_binary(m),E=r.length,C=h,v,D,B=0;if(!function(){var a,b=r[0];if(1>E)return 1;a=b&15;D=a+1;v=b>>4;if(0<a)if(32<8*a+4)v=c(v,a,0);else for(i=1;i<D;i++)v|=r[i]<<8*(i-1)+4;e[0]=v;return 0}()){for(B=D;B<E&&!l(););return function(){for(var a=0;a<e.length;a++)e[a]instanceof Array&&(e[a]="0x"+e[a][0].toString(16)+f(e[a][1])+f(e[a][2])+f(e[a][3]));return e}()}}function p(m){m=parseInt(m);var h=0;60<m&&(h=parseInt(m/60),m=parseInt(m%60));return(9<h?h:"0"+h)+(":"+(9<m?m:"0"+m))}function u(m){var h=[],l=[],f=0,d,a,b,c,e;d=y(m.msg.segs_sdc.cid,m.msg.segs_sdc.record_num);a=y(m.msg.segs_sdc.sid,m.msg.segs_sdc.record_num);b=y(m.msg.segs_sdc.stm,m.msg.segs_sdc.record_num);c=y(m.msg.segs_sdc.etm,m.msg.segs_sdc.record_num);e=y(m.msg.segs_sdc.f,m.msg.segs_sdc.record_num);if(d&&a&&b&&c&&e){for(var g=0;g<(d?d.length:0);g++){var r=parseInt(e[g]),E=parseInt(a[g]);l[g]={cid:d[g],sid:E,stm:b[g],etm:c[g],f:r}}for(g=0;g<l.length;g++)d=parseInt(l[g].stm,16),a=parseInt(l[g].etm,16),0==m.search_type&&(d<m.base_start_time||a>m.base_end_time)||(h[f]={cid:l[g].cid,sid:l[g].sid,pos_start:d,pos_end:a,token:m.dev_sn+"_"+l[g].cid+"_"+l[g].sid,pic_token:m.dev_sn+"_p3_"+l[g].cid+"_"+l[g].sid,f:l[g].f},f++);return h}}function A(m){function h(a,c){c=c?c:{};c.sos_flag=parseInt(a/32)?1:c.sos_flag;c.door_flag=parseInt(a%32/16)?1:c.door_flag;c.motion_flag=parseInt(a%32%16/8)?1:c.motion_flag;c.io_flag=parseInt(a%32%16%8/4)?1:c.io_flag;c.snapshot_flag=parseInt(a%32%16%8%4/2)?1:c.snapshot_flag;c.motion_flag=parseInt(a%32%16%8%4%2)?1:c.motion_flag;return c}var l=[],f=0,d=[],a=0,b=[],c=[],e=0,g=0,r;r="5min"==m.time_length?3E5:"60min"==m.time_length?36E5:18E5;for(var E=m.videosegs,C=m.videosegs?m.videosegs.length:0,g=E[0].pos_start,v=0;v<C;v++)if((1==m.format||0==m.format)&&0<E[v].f&&(d[0]=E[v],b[a]={cut_video_data:d,is_photo:1,flag:h(E[v].f)},d=[],a++),2==m.format||0==m.format)if(v==C-1)0!=v&&2!=E[v].f&&E[v].pos_start!=E[v].pos_end&&E[v].pos_end-g<r&&(l[f]=E[v],f++);else if(0==v)l[f]=E[0],f++;else{var D=Math.abs(E[v].pos_start-E[v-1].pos_end);if(2!=E[v].f&&E[v].pos_start!=E[v].pos_end)if(7E3>=D&&E[v].pos_end-g<r)l[f]=E[v],f++;else{if(l.length){f={};for(g=0;g<l.length;g++)f=h(l[g].f,f);b[a]={cut_video_data:l,flag:f};a++}l=[];f=0;l[f]=E[v];f++;g=E[v].pos_start}}if(l.length){f={};for(g=0;g<l.length;g++)f=h(l[g].f,f);b[a]={cut_video_data:l,flag:f};l=[];f=0}if(1==m.category)for(m=b,b=[],l=0;l<m.length;l++)(m[l].flag.door_flag||m[l].flag.io_flag||m[l].flag.motion_flag||m[l].flag.snapshot_flag||m[l].flag.sos_flag)&&b.push(m[l]);for(m=0;m<b.length;m++)l=b[m].cut_video_data.length,d=parseInt(b[m].cut_video_data[0].pos_start),d=(parseInt(b[m].cut_video_data[l-1].pos_end)-d)/1E3,a=b[m].cut_video_data[0].pos_start,l=b[m].cut_video_data[l-1].pos_end,c[e]={time_duration:p(d),time_start:a,time_end:l},e++;return{local_cut_video_data:b,local_video_time_duration:c}}function n(m,h){function l(a){a=new Date(a);var c=a.getFullYear(),b=a.getMonth()+1,e=a.getDate(),g=d(a.getHours()),f=d(a.getMinutes());a=d(a.getSeconds());return c+"-"+b+"-"+e+" "+g+":"+f+":"+a}function f(a){a=a.split(":");return 60*a[0]+1*a[1]}function d(a){return 10>a?"0"+a:a}if(m&&!m.result&&(m.segs_sdc||m.segs)){for(var a=u({msg:m,base_start_time:h.start_time,base_end_time:h.end_time,dev_sn:h.dev_sn,search_type:h.search_type}),b=[],a=A({videosegs:a,time_length:h.time_length,format:h.format,category:h.category}),c=0;c<a.local_video_time_duration.length;c++)b[c]={},b[c].start_time=l(a.local_video_time_duration[c].time_start),b[c].duration=f(a.local_video_time_duration[c].time_duration),b[c].token="";for(c=0;c<a.local_cut_video_data.length;c++){var e=a.local_cut_video_data[c].cut_video_data.length;b[c].token=h.dev_sn+"-"+a.local_cut_video_data[c].cut_video_data[0].cid+"-"+a.local_cut_video_data[c].cut_video_data[0].sid+"-"+a.local_cut_video_data[c].cut_video_data[e-1].cid+"-"+a.local_cut_video_data[c].cut_video_data[e-1].sid+"-"+a.local_cut_video_data[c].cut_video_data[0].pic_token}a={};a.data={result:"",recording_list:b.reverse()};a.ref=h;onEvent(JSON.stringify(a).toLowerCase())}}function q(m,h){if(m&&!m.result&&m.date_infos){var l=[],f=[],d=[],a=m.date_infos,b;for(b=0;b<a.length;b++){var c=(new Date(1E3*a[b].date)).format("yyyy.MM.dd.00.00.00");0<b?(l[l.length]=c,f[f.length]=getDateForStringDate(l[l.length-1]).getTime()):0==b&&(l[b]=c,f[b]=getDateForStringDate(l[b]).getTime())}l=(new Date).getTime();for(b=0;b<f.length;b++)f[b]>l||-1==d.indexOf(f[b])&&d.push(f[b]);d.sort(function(a,c){return a-c});0==h.data.start_time?(a=(new Date(1E3*a[a.length-1].date)).format("yyyy.MM.dd.00.00.00"),a=getDateForStringDate(a).getTime(),-288E5==a&&(a=0),b=a+864E5):(a=h.data.start_time,b=h.data.end_time);x.history_list_get({box_sn:h.data.box_sn,dev_sn:h.data.dev_sn,start_time:a,end_time:b,date_infos_time:f,format:2,category:0,time_length:"30min",search_type:h.data.search_type,cid:void 0,sid:void 0,vedio_day:d})}}var x=this;x.boxlist_get=function(m){ms.send_msg("box_get",m,null,function(h,l){if(h&&""==h.result)for(var f=h.ipcs?h.ipcs.length:0,d=0;d<f;d++)h.ipcs[d].nick=h.ipcs[d].nick?h.ipcs[d].nick:h.ipcs[d].sn;m.func(h)})};x.boxlist_img_url=function(m){var h=msdk_agent.pic_url_get({sn:m.sn,token:m.token});m.func(h)};x.boxlist_img_get=function(m){var h;h=m.dom;for(var l=m.ipc?m.ipc.length:0,f=0;f<l;f++){var d=m.ipc[f].sn+"_"+m.resolution+"_"+Math.pow(2,31)+"_"+Math.pow(2,31);g_local?g_local_agent.pic_url_get({sn:m.sn,token:d,flag:2,is_history:1}):(d=window.location.protocol+"//"+window.location.host+"/ccm/ccm_pic_get.js?dsess\x3d1\x26dsess_nid\x3d"+msdk_agent.create_nid()+"\x26dsess_sn\x3d"+m.sn+"\x26dtoken\x3d"+d+"\x26dflag\x3d2",h[f].src=d)}};x.history_list_get=function(m){m.flag=8;m.box_sn=m.data.sn;m.dev_sn=m.data.sn;var h=(new Date(m.data.date)).getTime()-288E5;m.start_time=h;m.end_time=h+864E5;m.format=2;m.category=0;m.time_length=m.data.section;m.videoSize=m.data.duration;ms.send_msg("box_get",m,m,n)};x.boxlist_device_messages_get=function(m){ms.send_msg("box_get",m.data,m,q)};x.history_img_url_get=function(m){m.func(window.location.protocol+"//"+window.location.host+"/ccm/ccm_pic_get.jpg?dsess\x3d1\x26dsess_nid\x3d"+msdk_agent.create_nid()+"\x26dsess_sn\x3d"+m.sn+"\x26dtoken\x3d"+m.token+"\x26dflag\x3d"+m.flag)};x.history_img_get=function(m){m=m.data;for(var h=[],l=0;l<m.token.length;l++)ms.send_msg("pic_url_get",{sn:m.sn,token:m.token[l],flag:m.flag,is_history:1},"",function(d,a){h[l]=d});var f={};f.data={result:"",img_src:h};f.ref=m;onEvent(JSON.stringify(f))}}var boxlist_func_ctrl=new boxlist_func;g_func.push({type:"boxlist_device_messages_get",login:"0",action:boxlist_func_ctrl.boxlist_device_messages_get},{type:"sd_recording_list",login:"0",action:boxlist_func_ctrl.history_list_get},{type:"history_img_get",login:"1",action:boxlist_func_ctrl.history_img_get},{type:"history_img_url_get",action:boxlist_func_ctrl.history_img_url_get},{type:"boxlist_get",action:boxlist_func_ctrl.boxlist_get},{type:"boxlist_img_get",action:boxlist_func_ctrl.boxlist_img_get},{type:"boxlist_img_url",action:boxlist_func_ctrl.boxlist_img_url});function devInfo_func(t){this.get_dev_info=function(t){ms.send_msg("devs_refresh",{},t.ref,function(p,u){var A={};if(p&&""!=p.data.devs)for(i=0;i<p.data.devs.length;i++)if(p.data.devs[i].sn===t.data.sn){A.data={result:"",sn:p.data.devs[i].sn,dev_stat:p.data.devs[i].stat};A.ref=u;onEvent(JSON.stringify(A).toLowerCase());return}A.data={result:"not find dev in list"};A.ref=u;onEvent(JSON.stringify(A))})}}var devInfo_func_ctrl=new devInfo_func;g_func.push({type:"get_dev_info",login:"1",action:devInfo_func_ctrl.get_dev_info});function login_func(t){this.sign_in=function(t){if(""==t.data.user||""==t.data.pass){var p={data:{result:"param err"}};p.ref=ref.ref_param;onEvent(JSON.stringify(p))}ms.send_msg("sign_in",{srv:g_server_device,user:t.data.user,password:mmd5.hex(t.data.pass)},{userName:t.data.user,password:t.data.pass,ref_param:t.ref},function(p,A){p&&""==p.result&&(g_user_name=A.userName,g_user_pass=A.password);var n={};n.data={result:p.result};n.ref=A.ref_param;onEvent(JSON.stringify(n))})}}var login_func_ctrl=new login_func;g_func.push({type:"login",login:"0",action:login_func_ctrl.sign_in});function play_func(t){var y="",p=!1;platform=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?"phone":"pc";console.log(platform);this.play=function(u){console.log(u);if("pc"==platform){var A=function(d){var a,b=0;l.video_chls=l.chl_create({params:"{"+("publish"==d.type?"dst":"src")+':[{url:"'+d.uri+'"}]'+("play"==d.type?',trans:[{flow_ctrl:"jitter",thread:"istream"}]':"playback"==d.type?',trans:[{flow_ctrl:"delay",thread:"istream"}]':"")+("publish"==d.type?"":',thread:"istream", jitter:{max:3000}')+"}"});null!==l.video_chls&&(a&&clearInterval(a),"flash"!==y&&(a=setInterval(function(){var a=l.ctrl(l.video_chls,"query","{}");if(150<=a.length)if(a=eval("("+a+")"),m){var e=sessionStorage.getItem("duration");a.data.total_bytes>b?parseInt((a.data.total_bytes-b)/1E3):b=0;e==a.data.played_duration&&(duration_tip=!0,sessionStorage.setItem("duration_tip",duration_tip));b=a.data.total_bytes;parseInt(a.data.played_duration/u.videoSize*100);sessionStorage.setItem("duration",a.data.played_duration)}else a.data.total_bytes>b?parseInt((a.data.total_bytes-b)/1E3):b=0,b=a.data.total_bytes},1E3)));"playback"==d.type&&setTimeout(function(){l.ctrl(l.video_chls,"play","");l.playback_state="play"},1E3)},n=function(d,a){A({type:d.type,uri:d.url,me1:l});var b={};b.data={sn:u.data.sn,url:d.url,key_mme:u.data.key_mme,param:u};b.ref=a;callNative("livePlay",JSON.stringify(b),"callback_live_play")},q=function(d){console.log(d.type);switch(d.type){case "missing":!m&&"44"<(navigator.userAgent.toLowerCase().match(/chrome\/[\d.]+/gi)+"").replace(/[^0-9.]/ig,"")&&(location.href="https://www.adobe.com/go/getflashplayer");p=!p;if(0==p){d="p3";"major"===u.data.stream&&(d="p1");if(""==u.data.key_mme||""==u.data.sn){var a={data:{result:"param err"}};a.ref=u.ref;onEvent(JSON.stringify(a))}a="rtdp";"web"==g_browser&&(a="http");m?ms.send_msg("playback",{sn:u.data.sn,token:u.data.token,protocol:a,ref:""},u.ref,function(a,c){var b={};b.data={sn:u.data.sn,url:a.url,type:"hls",key_mme:u.data.key_mme,param:u};b.ref=c;callNative("livePlay",JSON.stringify(b),"callback_live_play")}):ms.send_msg("play",{sn:u.data.sn,token:d,protocol:a,ref:""},u.ref,function(a,c){var b={};b.data={sn:u.data.sn,url:a.url,type:"hls",key_mme:u.data.key_mme,param:u};b.ref=c;callNative("livePlay",JSON.stringify(b),"callback_live_play")})}break;case "ready":a=d.ref_obj.protocol;"flash"==d.plug.type.name?(y="flash",a="rtmp"):"auto"==a&&(a="rtdp");m?(x=x.data,ms.send_msg("playback",{sn:x.sn,token:x.token,protocol:a,ref:d.ref_obj},d.ref_obj,function(a,c){a.type="playback";n(a,c)})):ms.send_msg("play",{sn:x.data.sn,token:d.ref_obj.inner_window_info.profile_token,protocol:a,ref:d.ref_obj},d.ref_obj,function(a,c){a.type="play";n(a,c)});break;case "install_ui":d.panel.id="plugin_install_page"}},x=function(d){d.protocol="auto";d.videoSize=d.videoSize?d.videoSize:0;d.localPath=d.download_path?d.download_path:null;d.inner_window_info={dom_id:"play_screen",index:1,video_chls:null,audio_chls:null,mme:null,ipc_state:"",node_sn:d.sn,profile_token:"p0"};return d}(u),m=u.playback?1:0;if(m){var h=u.data.token.split("-");u.data.sn=h[0];u.data.token=h[0]+"_"+h[1]+"_"+h[2]+"_end.cid:"+h[3]+"_end.sid:"+h[4];u.data.videoSize=1E3*u.data.duration}h=document.getElementById("screen");h.style.display="block";var l=new mme({parent:h,enable_native_plug:!0,enable_flash_plug:!1,params:"{key:'data:application/octet-stream;base64,OenOl2/PvPX7EuqqZdvMsNf5PqEOlOJZ4sROOBtnvW8F6Fc+azokLNtti6Cb/oiuO9qhOxvDfL8cVpGY4UcCe81OIVHkbiNzuHKwiE+K6gmmWwIoHgSRn2RN4qsZO62QkqGePdR6L94n2ruSeixjqAgWFTW8AIlQptovRZSN1Dh/8M87RIRdYyVFqKqsZoZTYibPLyDFONKIqxzrFkJPtqR/wn8jnYMc1qUH/w3IYJZh/OqctPTDp8tYuQSWN3EE6+kVmDIMV9F92SZJORMnvxy+zYzpbO7Gz44fBQNQSGMelsf7yQpfTF/X8t1Qn73fu53xp3MTIGH0kklFH2tMPkO/Raelhw5A4JQbczWg0n4pcNxpRl6mCEIjFprTboJ/B2eI0qUX/zTPM7l1hBmxjxsewORsXp0y2+NnCRH0uVBGUq6fOWrdhJwotIIu5ZAZwdoDZZu6eaycol2TIS5smusoD0ODPtQ2xZoCy7djIC4MVhB5uKe0zDXbLr+Serdlq6en5HyvUN0EEmYle0fORmgNFn0DTqqTab6cx8WfFkysciJSveN4swoR66qMQUi9+TfkHTnZ/REp3kHJtSq8XJyzTe+KCXlJXGx07nAbK4svIPanx39A5o5XlpLK/ohxiMpEJZ6OhmWb9yAnL+8Bedw+epvbNQkhADh2QqB4ItsIq5KTOsNzA0aNn3FEXzyd7WLVBqcF1lUVxu1vpYRPKv01im1ORbVhDoJ9eiqkfchutpAGYOwhYzxFWOIhTMouY+m/oQhc1d8FF4T+zSx6WVmj2f+RDUdOKbQVxJdEeiGKyIDm14K34Kz+RdzF0fY50sbs/SUfMWwuKQsEPFU5KQ'}",on_event:function(d){d.sn=u.sn;q(d)},ref_obj:x,debug:0})}else{h="p3";"major"===u.data.stream&&(h="p1");if(""==u.data.key_mme||""==u.data.sn){var f={data:{result:"param err"}};f.ref=u.ref;onEvent(JSON.stringify(f))}f="rtdp";"web"==g_browser&&(f="http");m?ms.send_msg("playback",{sn:u.data.sn,token:h,protocol:f,ref:""},u.ref,function(d,a){console.log(d);var b={};b.data={sn:u.data.sn,url:d.url,type:"hls",key_mme:u.data.key_mme,param:u};b.ref=a;callNative("livePlay",JSON.stringify(b),"callback_live_play")}):ms.send_msg("play",{sn:u.data.sn,token:h,protocol:f,ref:""},u.ref,function(d,a){var b={};b.data={sn:u.data.sn,url:d.url,type:"hls",key_mme:u.data.key_mme,param:u};b.ref=a;callNative("livePlay",JSON.stringify(b),"callback_live_play")})}};this.play_destory=function(p){document.getElementById("screen").style.display="none";var A={};A.data={param:p};A.ref=p.ref;callNative("PlayDestory",JSON.stringify(A),"callback_play_destory")}}var play_func_ctrl=new play_func;g_func.push({type:"live_play",login:"1",action:play_func_ctrl.play},{type:"sd_recording_play",login:"1",action:function(t){t.playback=1;play_func_ctrl.play(t)}},{type:"sd_recording_play_destory",login:"0",action:play_func_ctrl.play_destory},{type:"live_play_destory",login:"0",action:play_func_ctrl.play_destory});Date.prototype.format=function(t){var y={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var p in y)(new RegExp("("+p+")")).test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?y[p]:("00"+y[p]).substr((""+y[p]).length)));return t};function getDateForStringDate(t){t=t.split(".");return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])}function sdkInfo_func(t){this.get_sdk_info=function(t){var p={};p.data={result:"",version:g_version};p.ref=t.ref;onEvent(JSON.stringify(p))}}var sdkInfo_func_ctrl=new sdkInfo_func;g_func.push({type:"get_info",login:"0",action:sdkInfo_func_ctrl.get_sdk_info});function class_mining_software(){this.send_msg=function(t,y,p,u){msdk_agent[t](y,p,function(p,n){switch(p.result){case "mcs_connection_is_interrupted":system_pop_confirm_box({alert:!0,str:mcs_connection_is_interrupted,callback_func:function(n){window.location.reload(!0)}});return;case "permission.denied":"sd_set"!=t&&"login_page"!=g_now_page&&(g_domain_oems_vimtag?msg_tips({msg:mcs_permission_denied,type:"error",timeout:3E3}):g_system_prompt_box(mcs_permission_denied));break;case "SdIsNotReady":g_system_prompt_box(mcs_sdcard_not_ready)}u&&u(p,n)})}}function msdk_create(t){console.log(JSON.stringify(t));t="string"===typeof t?eval("("+t+")"):t;g_appId=t.setting.appId;g_browser=t.setting.platform;g_language=t.setting.language;g_sdk_version=t.setting.sdk_version;g_time_zone=t.setting.timeZone;msdk_agent=new mcloud_agent;window.ms=new class_mining_software;var y={data:{result:""}};y.ref=t.ref;onEvent(JSON.stringify(y))}function msdk_ctrl(t){var y;y="string"===typeof t?eval("("+t+")"):t;console.log("msdk_ctrl : "+JSON.stringify(y));for(var p=0;p<g_func.length;p++)if(g_browser){if(y.data.func==g_func[p].type){"1"==g_func[p].login?g_user_name&&g_user_pass?ms.send_msg("sign_in",{srv:g_server_device,user:g_user_name,password:mmd5.hex(g_user_pass)},{},function(u,A){u&&""===u.result&&g_func[p].action(y)}):(t={data:{result:"is not login"}},t.ref=y.ref,onEvent(JSON.stringify(t))):g_func[p].action(y);break}}else t={data:{result:"Unsupported system"}},t.ref=y.ref,onEvent(JSON.stringify(t))}function msdk_destory(){}var CryptoJS=CryptoJS||function(t,y){var p={},u=p.lib={},A=u.Base=function(){function d(){}return{extend:function(a){d.prototype=this;var b=new d;a&&b.mixIn(a);b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.$super.extend(this)}}}(),n=u.WordArray=A.extend({init:function(d,a){d=this.words=d||[];this.sigBytes=a!=y?a:4*d.length},toString:function(d){return(d||x).stringify(this)},concat:function(d){var a=this.words,b=d.words,c=this.sigBytes;d=d.sigBytes;this.clamp();if(c%4)for(var e=0;e<d;e++)a[c+e>>>2]|=(b[e>>>2]>>>24-e%4*8&255)<<24-(c+e)%4*8;else if(65535<b.length)for(e=0;e<d;e+=4)a[c+e>>>2]=b[e>>>2];else a.push.apply(a,b);this.sigBytes+=d;return this},clamp:function(){var d=this.words,a=this.sigBytes;d[a>>>2]&=4294967295<<32-a%4*8;d.length=t.ceil(a/4)},clone:function(){var d=A.clone.call(this);d.words=this.words.slice(0);return d},random:function(d){for(var a=[],b=0;b<d;b+=4)a.push(4294967296*t.random()|0);return n.create(a,d)}}),q=p.enc={},x=q.Hex={stringify:function(d){var a=d.words;d=d.sigBytes;for(var b=[],c=0;c<d;c++){var e=a[c>>>2]>>>24-c%4*8&255;b.push((e>>>4).toString(16));b.push((e&15).toString(16))}return b.join("")},parse:function(d){for(var a=d.length,b=[],c=0;c<a;c+=2)b[c>>>3]|=parseInt(d.substr(c,2),16)<<24-c%8*4;return n.create(b,a/2)}},m=q.Latin1={stringify:function(d){var a=d.words;d=d.sigBytes;for(var b=[],c=0;c<d;c++)b.push(String.fromCharCode(a[c>>>2]>>>24-c%4*8&255));return b.join("")},parse:function(d){for(var a=d.length,b=[],c=0;c<a;c++)b[c>>>2]|=(d.charCodeAt(c)&255)<<24-c%4*8;return n.create(b,a)}},h=q.Utf8={stringify:function(d){try{return decodeURIComponent(escape(m.stringify(d)))}catch(a){throw Error("Malformed UTF-8 data");}},parse:function(d){return m.parse(unescape(encodeURIComponent(d)))}},l=u.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=n.create();this._nDataBytes=0},_append:function(d){"string"==typeof d&&(d=h.parse(d));this._data.concat(d);this._nDataBytes+=d.sigBytes},_process:function(d){var a=this._data,b=a.words,c=a.sigBytes,e=this.blockSize,g=c/(4*e),g=d?t.ceil(g):t.max((g|0)-this._minBufferSize,0);d=g*e;c=t.min(4*d,c);if(d){for(var r=0;r<d;r+=e)this._doProcessBlock(b,r);r=b.splice(0,d);a.sigBytes-=c}return n.create(r,c)},clone:function(){var d=A.clone.call(this);d._data=this._data.clone();return d},_minBufferSize:0});u.Hasher=l.extend({init:function(){this.reset()},reset:function(){l.reset.call(this);this._doReset()},update:function(d){this._append(d);this._process();return this},finalize:function(d){d&&this._append(d);this._doFinalize();return this._hash},clone:function(){var d=l.clone.call(this);d._hash=this._hash.clone();return d},blockSize:16,_createHelper:function(d){return function(a,b){return d.create(b).finalize(a)}},_createHmacHelper:function(d){return function(a,b){return f.HMAC.create(d,b).finalize(a)}}});var f=p.algo={};return p}(Math);(function(){var t=CryptoJS,y=t.lib.WordArray;t.enc.Base64={stringify:function(p){var u=p.words,A=p.sigBytes,n=this._map;p.clamp();p=[];for(var q=0;q<A;q+=3)for(var x=(u[q>>>2]>>>24-q%4*8&255)<<16|(u[q+1>>>2]>>>24-(q+1)%4*8&255)<<8|u[q+2>>>2]>>>24-(q+2)%4*8&255,m=0;4>m&&q+.75*m<A;m++)p.push(n.charAt(x>>>6*(3-m)&63));if(u=n.charAt(64))for(;p.length%4;)p.push(u);return p.join("")},parse:function(p){p=p.replace(/\s/g,"");var u=p.length,A=this._map,n=A.charAt(64);n&&(n=p.indexOf(n),-1!=n&&(u=n));for(var n=[],q=0,x=0;x<u;x++)if(x%4){var m=A.indexOf(p.charAt(x-1))<<x%4*2,h=A.indexOf(p.charAt(x))>>>6-x%4*2;n[q>>>2]|=(m|h)<<24-q%4*8;q++}return y.create(n,q)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(t){function y(l,f,d,a,b,c,e){l=l+(f&d|~f&a)+b+e;return(l<<c|l>>>32-c)+f}function p(l,f,d,a,b,c,e){l=l+(f&a|d&~a)+b+e;return(l<<c|l>>>32-c)+f}function u(l,f,d,a,b,c,e){l=l+(f^d^a)+b+e;return(l<<c|l>>>32-c)+f}function A(l,f,d,a,b,c,e){l=l+(d^(f|~a))+b+e;return(l<<c|l>>>32-c)+f}var n=CryptoJS,q=n.lib,x=q.WordArray,q=q.Hasher,m=n.algo,h=[];(function(){for(var l=0;64>l;l++)h[l]=4294967296*t.abs(t.sin(l+1))|0})();m=m.MD5=q.extend({_doReset:function(){this._hash=x.create([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(l,f){for(var d=0;16>d;d++){var a=f+d,b=l[a];l[a]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}for(var a=this._hash.words,b=a[0],c=a[1],e=a[2],g=a[3],d=0;64>d;d+=4)16>d?(b=y(b,c,e,g,l[f+d],7,h[d]),g=y(g,b,c,e,l[f+d+1],12,h[d+1]),e=y(e,g,b,c,l[f+d+2],17,h[d+2]),c=y(c,e,g,b,l[f+d+3],22,h[d+3])):32>d?(b=p(b,c,e,g,l[f+(d+1)%16],5,h[d]),g=p(g,b,c,e,l[f+(d+6)%16],9,h[d+1]),e=p(e,g,b,c,l[f+(d+11)%16],14,h[d+2]),c=p(c,e,g,b,l[f+d%16],20,h[d+3])):48>d?(b=u(b,c,e,g,l[f+(3*d+5)%16],4,h[d]),g=u(g,b,c,e,l[f+(3*d+8)%16],11,h[d+1]),e=u(e,g,b,c,l[f+(3*d+11)%16],16,h[d+2]),c=u(c,e,g,b,l[f+(3*d+14)%16],23,h[d+3])):(b=A(b,c,e,g,l[f+3*d%16],6,h[d]),g=A(g,b,c,e,l[f+(3*d+7)%16],10,h[d+1]),e=A(e,g,b,c,l[f+(3*d+14)%16],15,h[d+2]),c=A(c,e,g,b,l[f+(3*d+5)%16],21,h[d+3]));a[0]=a[0]+b|0;a[1]=a[1]+c|0;a[2]=a[2]+e|0;a[3]=a[3]+g|0},_doFinalize:function(){var l=this._data,f=l.words,d=8*this._nDataBytes,a=8*l.sigBytes;f[a>>>5]|=128<<24-a%32;f[(a+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360;l.sigBytes=4*(f.length+1);this._process();l=this._hash.words;for(f=0;4>f;f++)d=l[f],l[f]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}});n.MD5=q._createHelper(m);n.HmacMD5=q._createHmacHelper(m)})(Math);(function(){var t=CryptoJS,y=t.lib,p=y.Base,u=y.WordArray,y=t.algo,A=y.EvpKDF=p.extend({cfg:p.extend({keySize:4,hasher:y.MD5,iterations:1}),init:function(n){this.cfg=this.cfg.extend(n)},compute:function(n,q){for(var x=this.cfg,m=x.hasher.create(),h=u.create(),l=h.words,f=x.keySize,x=x.iterations;l.length<f;){d&&m.update(d);var d=m.update(n).finalize(q);m.reset();for(var a=1;a<x;a++)d=m.finalize(d),m.reset();h.concat(d)}h.sigBytes=4*f;return h}});t.EvpKDF=function(n,q,x){return A.create(x).compute(n,q)}})();CryptoJS.lib.Cipher||function(t){var y=CryptoJS,p=y.lib,u=p.Base,A=p.WordArray,n=p.BufferedBlockAlgorithm,q=y.enc.Base64,x=y.algo.EvpKDF,m=p.Cipher=n.extend({cfg:u.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,g){this.cfg=this.cfg.extend(g);this._xformMode=a;this._key=b;this.reset()},reset:function(){n.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(c){return{encrypt:function(e,g,d){return("string"==typeof g?b:a).encrypt(c,e,g,d)},decrypt:function(e,g,d){return("string"==typeof g?b:a).decrypt(c,e,g,d)}}}}()});p.StreamCipher=m.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=y.mode={},l=p.BlockCipherMode=u.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}}),h=h.CBC=function(){function a(a,c,b){var e=this._iv;e?this._iv=t:e=this._prevBlock;for(var g=0;g<b;g++)a[c+g]^=e[g]}var b=l.extend();b.Encryptor=b.extend({processBlock:function(c,b){var e=this._cipher,g=e.blockSize;a.call(this,c,b,g);e.encryptBlock(c,b);this._prevBlock=c.slice(b,b+g)}});b.Decryptor=b.extend({processBlock:function(c,b){var e=this._cipher,g=e.blockSize,d=c.slice(b,b+g);e.decryptBlock(c,b);a.call(this,c,b,g);this._prevBlock=d}});return b}(),f=(y.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,e=c<<24|c<<16|c<<8|c,d=[],f=0;f<c;f+=4)d.push(e);c=A.create(d,c);a.concat(c)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};p.BlockCipher=m.extend({cfg:m.cfg.extend({mode:h,padding:f}),reset:function(){m.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var g=a.createEncryptor;else g=a.createDecryptor,this._minBufferSize=1;this._mode=g.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var d=p.CipherParams=u.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),h=(y.format={}).OpenSSL={stringify:function(a){var c=a.ciphertext;a=a.salt;c=(a?A.create([1398893684,1701076831]).concat(a).concat(c):c).toString(q);return c.replace(/(.{64})/g,"$1\n")},parse:function(a){a=q.parse(a);var c=a.words;if(1398893684==c[0]&&1701076831==c[1]){var b=A.create(c.slice(2,4));c.splice(0,4);a.sigBytes-=16}return d.create({ciphertext:a,salt:b})}},a=p.SerializableCipher=u.extend({cfg:u.extend({format:h}),encrypt:function(a,b,g,r){r=this.cfg.extend(r);var c=a.createEncryptor(g,r);b=c.finalize(b);c=c.cfg;return d.create({ciphertext:b,key:g,iv:c.iv,algorithm:a,mode:c.mode,padding:c.padding,blockSize:a.blockSize,formatter:r.format})},decrypt:function(a,b,g,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(g,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a):a}}),y=(y.kdf={}).OpenSSL={compute:function(a,b,g,r){r||(r=A.random(8));a=x.create({keySize:b+g}).compute(a,r);g=A.create(a.words.slice(b),4*g);a.sigBytes=4*b;return d.create({key:a,iv:g,salt:r})}},b=p.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:y}),encrypt:function(c,b,g,d){d=this.cfg.extend(d);g=d.kdf.compute(g,c.keySize,c.ivSize);d.iv=g.iv;c=a.encrypt.call(this,c,b,g.key,d);c.mixIn(g);return c},decrypt:function(c,b,g,d){d=this.cfg.extend(d);b=this._parse(b,d.format);g=d.kdf.compute(g,c.keySize,c.ivSize,b.salt);d.iv=g.iv;return a.decrypt.call(this,c,b,g.key,d)}})}();(function(){function t(d,a){var b=(this._lBlock>>>d^this._rBlock)&a;this._rBlock^=b;this._lBlock^=b<<d}function y(d,a){var b=(this._rBlock>>>d^this._lBlock)&a;this._lBlock^=b;this._rBlock^=b<<d}var p=CryptoJS,u=p.lib,A=u.WordArray,u=u.BlockCipher,n=p.algo,q=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],x=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],m=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=n.DES=u.extend({_doReset:function(){for(var d=this._key.words,a=[],b=0;56>b;b++){var c=q[b]-1;a[b]=d[c>>>5]>>>31-c%32&1}d=this._subKeys=[];for(c=0;16>c;c++){for(var e=d[c]=[],g=m[c],b=0;24>b;b++)e[b/6|0]|=a[(x[b]-1+g)%28]<<31-b%6,e[4+(b/6|0)]|=a[28+(x[b+24]-1+g)%28]<<31-b%6;e[0]=e[0]<<1|e[0]>>>31;for(b=1;7>b;b++)e[b]>>>=4*(b-1)+3;e[7]=e[7]<<5|e[7]>>>27}a=this._invSubKeys=[];for(b=0;16>b;b++)a[b]=d[15-b]},encryptBlock:function(d,a){this._doCryptBlock(d,a,this._subKeys)},decryptBlock:function(d,a){this._doCryptBlock(d,a,this._invSubKeys)},_doCryptBlock:function(d,a,b){this._lBlock=d[a];this._rBlock=d[a+1];t.call(this,4,252645135);t.call(this,16,65535);y.call(this,2,858993459);y.call(this,8,16711935);t.call(this,1,1431655765);for(var c=0;16>c;c++){for(var e=b[c],g=this._lBlock,r=this._rBlock,f=0,C=0;8>C;C++)f|=h[C][((r^e[C])&l[C])>>>0];this._lBlock=r;this._rBlock=g^f}b=this._lBlock;this._lBlock=this._rBlock;this._rBlock=b;t.call(this,1,1431655765);y.call(this,8,16711935);y.call(this,2,858993459);t.call(this,16,65535);t.call(this,4,252645135);d[a]=this._lBlock;d[a+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});p.DES=u._createHelper(f);n=n.TripleDES=u.extend({_doReset:function(){var d=this._key.words;this._des1=f.createEncryptor(A.create(d.slice(0,2)));this._des2=f.createEncryptor(A.create(d.slice(2,4)));this._des3=f.createEncryptor(A.create(d.slice(4,6)))},encryptBlock:function(d,a){this._des1.encryptBlock(d,a);this._des2.decryptBlock(d,a);this._des3.encryptBlock(d,a)},decryptBlock:function(d,a){this._des3.decryptBlock(d,a);this._des2.encryptBlock(d,a);this._des1.decryptBlock(d,a)},keySize:6,ivSize:2,blockSize:2});p.TripleDES=u._createHelper(n)})();CryptoJS.pad.NoPadding={pad:function(){},unpad:function(){}};function mcloud_account(){function t(a){v.enc.Hex.parse(a);return v.DES.encrypt(v.enc.Hex.parse(a),v.enc.Hex.parse(D.hex(E)),{iv:v.enc.Hex.parse("0000000000000000"),padding:v.pad.NoPadding}).ciphertext.toString()}function y(a){return B.nid(++r,a?e:g,E,a,null,null,D,"hex")}function p(){return y(0)}function u(a,c,g,e){a.to?F.call({srv:("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+(a.srv?a.srv:f)+"/",to:a.to,type:a.type,data:c,ref:g,"static":!1,way:a.way?a.way:"json",qid:b,on_ack:e}):b?"cpns_get_req"==a?F.call({srv:g.remote_ip,to:"cpns",type:a,data:c,ref:g,"static":!1,way:"json",qid:b,on_ack:e}):"file:"==window.location.protocol?F.call({srv:"http://"+f+"/",to:"ccm",type:a,data:c,ref:g,"static":!1,way:"json",qid:b,on_ack:e}):F.call({srv:window.location.protocol+"//"+f+"/",to:"ccm",type:a,data:c,ref:g,"static":!1,way:"json",qid:b,on_ack:e}):"cpns_get_req"==a?F.call({srv:g.remote_ip,to:"cpns",type:a,data:c,ref:g,"static":!1,way:"json",on_ack:e}):"file:"==window.location.protocol?F.call({srv:"http://"+f+"/",to:"ccm",type:a,data:c,ref:g,"static":!1,way:"json",on_ack:e}):F.call({srv:window.location.protocol+"//"+f+"/",to:"ccm",type:a,data:c,ref:g,"static":!1,way:"json",on_ack:e})}function A(a){var c=JSON.stringify(a);a=v.MD5(E);var b=h(c),c=8*(parseInt(c.length/8)+1);a=v.DES.encrypt({sigBytes:c,words:b,length:c/4},a,{iv:v.enc.Hex.parse("0000000000000000"),padding:v.pad.NoPadding}).ciphertext.toString();a=l(a);return"data:application/octet-stream;base64,"+B.binary_2_b64(a)}function n(b,v,C,l,h,D,m){function B(){if(name){var c=A({app:{id:appid}});u(b,{lid:e,nid:y(2),user:d,pass:t(a),session_req:1,p:[{n:"uctx",v:c}],param:[{name:"spv",value:"v1"}]},D,function(a,c){var e=a?a.data:null;"cacs_login_req"==b&&e&&""==e.result&&(g=e.sid,r=e.seq);m(a,c)})}else u(b,{lid:e,nid:y(2),user:d,pass:t(a),session_req:1,param:[{name:"spv",value:"v1"}]},D,function(a,c){var e=a?a.data:null;"cacs_login_req"==b&&e&&""==e.result&&(g=e.sid,r=e.seq);m(a,c)})}v&&f!=v&&(f=v,E="",g=0);C&&C!=d&&(d=C,g=0);l&&a!=l&&(a=l,g=0);appid=name=E="";"cacs_reg_req"==b&&D&&(appid=D.appid,name=D.name);if(E)B();else{var H=mdh.gen_private();v=mdh.gen_public(H);u("cacs_dh_req",{bnum_prime:mdh.prime,root_num:mdh.g,key_a2b:v,tid:c},D,function(a,b){var g=a?a.data:null;!g||g.result?m(a,b):(c=g.tid,e=g.lid,E=mdh.gen_shared_secret(H,g.key_b2a),B())})}}function q(a){var c,b;if(a&&a.data){b=(c=a.data.ret||a.data.result||a.data.Result)?c.reason||c.sub||c.code||c.Reason||c.SubCode||c.Code:null;for(c=0;b&&c<C.length;c++)if(b==C[c]&&"ccm_subscribe"!=a.type)return 1;return 0}return"timeout"==a?0:1}function x(c,b,g,e){u(c,b,g,function(g,r){E&&q(g)?(b&&b.sess?b.sess.nid=y(0):b&&b.Session&&(b.Session.Nid=y(0)),n("cacs_login_req",f,d,null,a,r,function(a,g){(a&&a.data?a.data.result:a)?e(a,g):u(c,b,g,e)})):"timeout"!=g&&e(g,r)})}function m(a,c){function g(a,c){x("ccm_subscribe",{sess:{nid:p()}},a,function(a,b){if(""==(a.data&&a.data.ret?a.data.ret.reason:null))e(b,c);else return-1})}function e(a,c){S&&(clearInterval(S),S=null);x("mmq_pick",{qid:b,timeout:3E5},a,function(a,b){"ccm_msg"==a.type?(c({result:"",items:a.data.items},b),e(b,c)):"mmq_pick_ack"==a.type&&(Q=0,aa=setTimeout(function(){m(b,c)},3E3))});S=setInterval(function(){e(a,c)},33E4)}Q?e(a,c):x("mmq_create",{timeout:3E4},a,function(a,e){if(a.data.result)return-1;Q=1;b=a.data.qid;g(e,c)})}function h(a){for(var c=[],b=0;b<a.length;b++)c.push(a.charCodeAt(b).toString(16));var g=8*(parseInt(a.length/8)+1)-a.length;a=[];for(var b="",e=0;e<g;e++)b=0==e?"0"+g:b+"ff",8==b.length&&(a.push("0x"+b),b="");for(g=0;g<c.length;g++)b+=c[g],8==b.length&&(a.push("0x"+b),b="");return a}function l(a){if(a){for(var c=a.length/2,b=[],g=0;g<c;g++){var e=a.charAt(2*g),d=a.charAt(2*g+1);b.push("0x"+e+d&255)}return b}}var f=window.location.host,d="",a="",b="",c=0,e=0,g=0,r=0,E="",C=["accounts.nid.invalid","accounts.sid.invalid","accounts.lid.invalid","InvalidSession"],v=window.CryptoJS,D=window.mmd5,B=window.mcodec,F=window.mrpc,S,aa,Q;this.qid=function(){return b};this.dev_msg_listener_add=m;this.dev_msg_listener_del=function(a,c){x("mmq_destroy",{qid:b},a,function(a,b){""==a.data.result&&(clearInterval(S),clearTimeout(void 0),clearTimeout(aa));c({result:a.data.result},b)})};this.set_srv=function(a){a&&a!=f&&(f=a,E="")};this.get_srv=function(){return f};this.get_sharekey=function(a){E=a};this.get_sid=function(a){g=a};this.pwd_encrypt=t;this.create_nid_ex=y;this.create_nid=p;this.sign_up=function(a,c,b,g,e,d){n("cacs_reg_req",a,c,b,g,e,d)};this.sign_in=function(a,c,b,g,e,d){n("cacs_login_req",a,c,b,g,e,d)};this.sign_out=function(a,c){x("cacs_logout_req",{nid:p()},a,function(a,b){c(a,b)})};this.pwd_set=function(a,c,b,g,e){a=a&&D.hex(a);c=c&&D.hex(c);x("cacs_passwd_req",{nid:p(),old_pass:t(a),new_pass:t(c),guest:b?1:0},g,function(a,c){e(a,c)})};this.binding_email=function(a,c,b,g,e,d,r,f,v){e=A({app:{id:d,name:r,ver:e}});x("cacs_bind_req",{nid:p(),email:a,user:c,pass:t(b),lang:g,p:[{n:"uctx",v:e}]},f,function(a,c){v(a,c)})};this.recovery_binding_email=function(a,b,g,d,r,f,v){var C=mdh.gen_private(),l=mdh.gen_public(C),h={app:{id:d,name:r}};u("cacs_dh_req",{bnum_prime:mdh.prime,root_num:mdh.g,key_a2b:l,tid:c},f,function(d,r){var f=d?d.data:null;!f||f.result?v(d,r):(c=f.tid,e=f.lid,E=mdh.gen_shared_secret(C,f.key_b2a),f=A(h),x("cacs_recovery_req",{lid:e,nid:y(2),email:a,user:b,lang:g,p:[{n:"uctx",v:f}]},r,function(a,c){v(a,c)}))})};this.send_msg=x;this.cpns_get=function(a,c,b,g,e,d,r){var f=mdh.gen_private();d=mdh.gen_public(f);f=mdh.gen_shared_secret(f,"310105909413485164588026905566175959");g={app:{id:e},user:g};g=JSON.stringify(g);e=v.MD5(f);f=h(g);g=8*(parseInt(g.length/8)+1);g=v.DES.encrypt({sigBytes:g,words:f,length:g/4},e,{iv:v.enc.Hex.parse("0000000000000000"),padding:v.pad.NoPadding}).ciphertext.toString();e=l(g);g=a.substring(0,a.indexOf(":"));e="data:application/octet-stream;base64,"+B.binary_2_b64(e);"https"==g?x("cpns_get_req",{start:c,counts:b,p:[{n:"uctx",v:e},{n:"root",v:"5"},{n:"prime",v:"791658605174853458830696113306796803"},{n:"pubk",v:d},{n:"porto",v:"https"}]},{remote_ip:a},function(a,c){r(a,c)}):x("cpns_get_req",{start:c,counts:b,p:[{n:"uctx",v:e},{n:"root",v:"5"},{n:"prime",v:"791658605174853458830696113306796803"},{n:"pubk",v:d}]},{remote_ip:a},function(a,c){r(a,c)})};this.binding_email_get=function(a,b,g,d){if(1==g.data){var r=mdh.gen_private(),f=mdh.gen_public(r),v={app:{id:b}};u("cacs_dh_req",{bnum_prime:mdh.prime,root_num:mdh.g,key_a2b:f,tid:c},g,function(b,g){var f=b?b.data:null;!f||f.result?d(b,g):(c=f.tid,e=f.lid,E=mdh.gen_shared_secret(r,f.key_b2a),f=A(v),x("cacs_query_req",{lid:e,nid:y(2),user:a,p:[{n:"uctx",v:f}]},g,function(a,c){d(a,c)}))})}else v={app:{id:b}},b=A(v),x("cacs_query_req",{nid:p(),user:a,p:[{n:"uctx",v:b}]},g,function(a,c){d(a,c)})}}function mcloud_agent(){function t(a){for(var b,c=0;c<l.length;++c)if((b=l[c])&&b.sn==a)return b;return null}function y(a){t(a.sn)||(l[l.length]=a)}function p(a,b,c,e){h||f.set_srv(window.location.host);return f.send_msg(d?d.type(a):a,d?d.req(a,b):b,c,d?function(c,b){e(d.ack(a,c),b)}:e)}function u(){return f.create_nid()}function A(a){return f.pwd_encrypt(a)}function n(a){a=a&&a.data?a.data.ret||a.data.result:null;return"[object String]"===Object.prototype.toString.call(a)?a:s_ret=a?a.reason||a.sub||a.code:null}function q(a,b,c){a=a.is_history?"file:"==window.location.protocol?"http://"+f.get_srv()+"/ccm/ccm_pic_get.jpg?hfrom_handle\x3d887330\x26dsess\x3d1\x26dsess_nid\x3d"+u()+"\x26dsess_sn\x3d"+a.sn+"\x26dtoken\x3d"+a.token+"\x26dflag\x3d"+a.flag:window.location.protocol+"//"+f.get_srv()+"/ccm/ccm_pic_get.jpg?hfrom_handle\x3d887330\x26dsess\x3d1\x26dsess_nid\x3d"+u()+"\x26dsess_sn\x3d"+a.sn+"\x26dtoken\x3d"+a.token+"\x26dflag\x3d"+a.flag:"file:"==window.location.protocol?"http://"+f.get_srv()+"/ccm/ccm_pic_get.jpg?hfrom_handle\x3d887330\x26dsess\x3d1\x26dsess_nid\x3d"+u()+"\x26dsess_sn\x3d"+a.sn+"\x26dtoken\x3d"+a.token+"_xxxxxxxxxx":window.location.protocol+"//"+f.get_srv()+"/ccm/ccm_pic_get.jpg?hfrom_handle\x3d887330\x26dsess\x3d1\x26dsess_nid\x3d"+u()+"\x26dsess_sn\x3d"+a.sn+"\x26dtoken\x3d"+a.token+"_xxxxxxxxxx";c(a,b)}function x(a,b,c){p("ccm_exdev_del",{sess:{nid:f.create_nid(),sn:a.sn},id:a.id},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})}function x(a,b,c){p("ccm_exdev_del",{sess:{nid:f.create_nid(),sn:a.sn},id:a.id},b,function(a,b){var g=n(a);""==g&&a.data&&c({result:g,data:a.data},b)})}function m(a,b,c){p({type:"ccvs_get_version_req",to:"ccms",srv:a.srv},{sess:{},ver_type:a.ver_type,ver_from:a.ver_from,lang:a.lang,p:a.p},b,function(a,b){c(a.data,b)})}var h="",l=[],f=new mcloud_account,d=null;this.test_lang_set=function(a,b,c){p(a.type,{sess:{},lang:a.lang},b,function(a,b){var g=n(a);c({result:g},b)})};this.get_download=m;this.set_srv=function(a){log("set_srv : "+a);g_server_device=h=a;f.set_srv(a)};this.pwd_encrypt=A;this.create_nid=u;this.sign_up=function(a,b,c){return f.sign_up(a.srv,a.user,a.password,null,b,function(a,b){c({result:a.data.result},b)})};this.sign_in=function(a,b,c){console.log(JSON.stringify(a));if(""==g_server_device)mcloud_entry({userName:a.user},function(e){return f.sign_in(a.srv,a.user,a.password,null,b,function(a,b){c({result:n(a)},b)})});else return f.sign_in(a.srv,a.user,a.password,null,b,function(a,b){c({result:n(a)},b)})};this.sign_out=function(a,b){return f.sign_out(a,function(a,e){b({result:n(a)},e)})};this.send_msg=p;this.account_passwd_set=function(a,b,c){f.pwd_set(a.old_pass,a.new_pass,a.is_guest,b,function(a,b){c({result:n(a)},b)})};this.devs={list:l,get:t,get_index:function(a){for(var b=0,c=l.length;b<c;b++)if(mcloud_agent.devs.list[b].sn==a)return b},add:y,del:function(a){for(var b=0;b<l.length;++b)l[b].sn==a&&l.splice(b,1)}};this.devs_refresh=function(a,b,c){p("ccm_devs_get",{sess:{nid:u()},start:0,counts:1024},b,function(a,b){if(""==n(a)){l.length=0;var g=a.data.devs;if(g)for(i=0;i<g.length;++i)l[i]=g[i]}c(a,b)})};this.play=function(a,b,c){p("ccm_play",{sess:{nid:u(),sn:a.sn},setup:{stream:"RTP_Unicast",trans:{proto:a.protocol}},token:a.token},b,function(a,b){c({result:n(a),url:a.data.uri?a.data.uri.url:""},b)})};this.record=function(a,b,c){p("ccm_record_task_get",{sess:{nid:u(),sn:a.sn}},b,function(b,g){var e=n(b);""==e&&1==b.data.sd_ready?(b.data.task.keep=a.keep_time,p("ccm_record_task_set",{sess:{nid:u(),sn:a.sn},task:b.data.task},g,function(a,b){c({result:n(a)},b)})):c({result:e,sd_ready:b.data.sd_ready},g)})};this.pic_get=function(a,b,c){f.get_srv();p("ccm_snapshot",{sess:{nid:u(),sn:a.sn},token:a.token},b,function(b,g){c({result:n(b),url:q(a)},g)})};this.pic_url_get=q;this.pushtalk=function(a,b,c){p("ccm_talk",{sess:{nid:u(),sn:a.sn},setup:{stream:"RTP_Unicast",trans:{proto:a.protocol}},token:a.token},b,function(a,b){c({result:n(a),url:a.data.uri?a.data.uri.url:""},b)})};this.ptz_ctrl=function(a,b,c){p("ccm_ptz_ctl",{sess:{nid:u(),sn:a.sn},trans:{pan_tilt:{x:a.x,y:a.y}},speed:{pan_tilt:{x:30,y:30}}},b,function(a,b){c({result:n(a)},b)})};this.playback=function(a,b,c){p("ccm_replay",{sess:{nid:u(),sn:a.sn},setup:{stream:"RTP_Unicast",trans:{proto:a.protocol}},token:a.token},b,function(a,b){c({result:n(a),url:a.data.url?a.data.url:""},b)})};this.msgs_get=function(a,b,c){p("ccm_msg_get",{sess:{nid:u(),sn:a.sn},flag:0,start:a.start,filter:a.filter,counts:a.counts},b,function(a,b){c({result:n(a),max_id:a.data.max_id,min_id:a.data.min_id,total:a.data.total,bound:a.data.bound,messages:a.data.messages},b)})};this.dev_del=function(a,b,c){p("ccm_dev_del",{sess:{nid:u()},sn:a.sn},b,function(a,b){c({result:n(a)},b)})};this.dev_add=function(a,b,c){var e=mmd5.hex(a.pass||"");p("ccm_dev_add",{sess:{nid:u()},sn:a.sn,pwd:A(e)},b,function(a,b){var g=n(a);if(""==g){var e=a.data.info;e&&y(e)}c({result:g,info:a.data.info},b)})};this.cam_get=function(a,b,c){var e,g,d,f,C,v,l,h;p("ccm_video_srcs_get",{sess:{nid:u(),sn:a.sn}},b,function(b,r){var E=n(b),D=b.data.vss;""==E&&D[0].extension.conf?(e=D[0].extension.conf.brightness,g=D[0].extension.conf.contrast,d=D[0].extension.conf.color_saturation,f=D[0].extension.conf.sharpness,C=D[0].extension.conf.mode,p("ccm_misc_get",{sess:{nid:u(),sn:a.sn}},r,function(a,b){var r=n(a);if(""==r){var E=a.data?a.data.info:"";v=E.flip;l=E.power_freq;h=a.data.resolute}c({result:r,brightness:e,contrast:g,color_saturation:d,sharpness:f,day_night:C,flip:v,flicker_freq:l,resolute:h},b)})):c({result:E},r)})};this.cam_set=function(a,b,c){p("ccm_img_set",{sess:{nid:u(),sn:a.sn},token:"vs0",conf:{brightness:a.brightness,contrast:a.contrast,color_saturation:a.color_saturation,sharpness:a.sharpness,mode:a.day_night}},b,function(b,g){var e=n(b);""==e?p("ccm_misc_set",{sess:{nid:u(),sn:a.sn},info:{flip:a.flip,power_freq:a.flicker_freq},resolute:a.resolute},g,function(a,b){c({result:n(a)},b)}):c({result:e},g)})};this.dev_info_get=function(a,b,c){var e=mfc=model=ver=name=logo=os=wifi=sensor=type=uptime=def=s_sensor=exdev=rffreq=exver="";p("ccm_dev_info_get",{sess:{nid:u(),sn:a.sn},select:a.select},b,function(a,b){var g=n(a);if(""==g&&(a=a.data?a.data:"",e=a.sn,ver=a.img_ver,name=a.nick,type=a.type,os=a.os,wifi=a.wifi,sensor=a.sensor,a.p))for(var d=0;d<a.p.length;d++)"s.logo"==a.p[d].n&&(logo=a.p[d].v),"s.mfc"==a.p[d].n&&(mfc=a.p[d].v),"model"==a.p[d].n&&(model=a.p[d].v),"uptime"==a.p[d].n&&(uptime=a.p[d].v),"p0"==a.p[d].n&&(def=a.p[d].v),"s.sensor"==a.p[d].n&&(s_sensor=a.p[d].v),"s.exdev"==a.p[d].n&&(exdev=a.p[d].v),"s.rffreq"==a.p[d].n&&(rffreq=a.p[d].v),"s.exver"==a.p[d].n&&(exver=a.p[d].v);c({result:g,sn:e,mfc:mfc,model:model,ver:ver,name:name,logo:logo,type:type,os:os,wifi:wifi,sensor:sensor,uptime:uptime,def:def,s_sensor:s_sensor,exdev:exdev,rffreq:rffreq,exver:exver},b)})};this.nick_set=function(a,b,c){p("ccm_nick_set",{sess:{nid:u(),sn:a.sn},nick:a.name},b,function(a,b){c({result:n(a)},b)})};this.dev_passwd_set=function(a,b,c){var e=a.old_pass&&window.mmd5.hex(a.old_pass),g=a.new_pass&&window.mmd5.hex(a.new_pass);p("ccm_pwd_set",{sess:{nid:u(),sn:a.sn},user:{username:a.sn,old_pwd:A(e),pwd:A(g),level:"",guest:a.is_guest?1:0}},b,function(a,b){c({result:n(a)},b)})};this.net_get=function(a,b,c){var e,g;p("ccm_net_get",{sess:{nid:u(),sn:a.sn},select:a.select,tokens:["eth0","ra0"],items:["all","all"],force_scan:1},b,function(a,b){var d=n(a);""==d&&(a=a.data?a.data.info:"",e=a.ifs,g=a.dns);c({result:d,networks:e,dns:g},b)})};this.net_set=function(a,b,c){var e={ifs:a.networks,dns:a.dns};p("ccm_net_set",{sess:{nid:u(),sn:a.sn},info:e},b,function(a,b){c({result:n(a)},b)})};this.osd_get=function(a,b,c){var e,g,d,f,C,v,l;p("ccm_osd_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var r=n(a);""==r&&(a=a.data?a.data.osd:"",e=a.text,g=a.text_enable,d=a.week,f=a.date.format,C=a.date.date_enable,v=a.date.enable_12h,l=a.date.time_enable);c({result:r,text:e,text_enable:g,week_enable:d,date_format:f,date_enable:C,time_12h:v,time_enable:l},b)})};this.osd_set=function(a,b,c){p("ccm_osd_set",{sess:{nid:u(),sn:a.sn},osd:{text:a.text,text_enable:a.text_enable,week:a.week_enable,date:{format:a.date_format,date_enable:a.date_enable,enable_12h:a.time_12h,time_enable:a.time_enable}}},b,function(a,b){c({result:n(a)},b)})};this.sd_get=function(a,b,c){var e,g,d,f,C;p("ccm_disk_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var r=n(a);""==r&&(a=a.data&&a.data.disks?a.data.disks[0]:a.data,e=a.conf.enable,g=a.stat,d=a.size,f=a.used_size,C=a.available_size);c({result:r,enable:e,status:g,capacity:d,usage:f,availableSize:C},b)})};this.sd_set=function(a,b,c){a.no_conf?p("ccm_disk_ctl",{sess:{nid:u(),sn:a.sn},token:"sd",type:a.ctrl_type?a.ctrl_type:""},b,function(a,b){c({result:n(a)},b)}):p("ccm_disk_ctl",{sess:{nid:u(),sn:a.sn},token:"sd",type:a.ctrl_type?a.ctrl_type:"",conf:{enable:a.enable?1:0}},b,function(a,b){c({result:n(a)},b)})};this.alarm_trigger_get=function(a,b,c){var e,g,d,f;p("ccm_alert_dev_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var r=n(a);""==r&&(a=a.data?a.data.conf:"",e=a.io_in_mode,g=a.io_out_mode,d=a.motion_level,f=a.motion_level_night);c({result:r,io_input:e,io_output:g,sensitivity:d,night_sensitivity:f},b)})};this.alarm_trigger_set=function(a,b,c){p("ccm_alert_dev_set",{sess:{nid:u(),sn:a.sn},conf:{io_in_mode:a.io_input,io_out_mode:a.io_output,motion_level:a.sensitivity,motion_level_night:a.night_sensitivity}},b,function(a,b){c({result:n(a)},b)})};this.alarm_action_get=function(a,b,c){var e,g;p("ccm_alert_action_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var d=n(a);""==d&&(a=a.data?a.data:"",e=a.enable,g=a.actions);c({result:d,enable:e,actions:g},b)})};this.alarm_action_set=function(a,b,c){p("ccm_alert_action_set",{sess:{nid:u(),sn:a.sn},enable:a.enable,actions:a.actions},b,function(a,b){c({result:n(a)},b)})};this.alert_task_set=function(a,b,c){p("ccm_alert_action_set",{sess:{nid:u(),sn:a.sn},enable:a.enable,sch:{enable:a.sch_enable,full_time:a.full_time,times:a.times}},b,function(a,b){c({result:n(a)},b)})};this.alert_task_get=function(a,b,c){var e,g;p("ccm_alert_action_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var d=n(a);""==d&&(a=a.data?a.data:"",e=a.sch.enable,g=a.sch.times);c({result:d,enable:e,times:g},b)})};this.motion_mask_get=function(a,b,c){p("ccm_motion_mask_get",{sess:{nid:f.create_nid(),sn:a.sn}},b,function(a,b){c({result:n(a),conf:a.data.conf},b)})};this.motion_mask_set=function(a,b,c){p("ccm_motion_mask_set",{sess:{nid:u(),sn:a.sn},conf:a.conf},b,function(a,b){c({result:n(a)},b)})};this.record_get=function(a,b,c){var e,g,d,f;p("ccm_record_task_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var r=n(a);""==r&&(f=a.data.sd_ready,a=a.data?a.data.task.sch:"",e=a.enable,g=a.full_time,d=a.times);c({result:r,enable:e,full_time:g,times:d,sd_ready:f},b)})};this.record_set=function(a,b,c){p("ccm_record_task_set",{sess:{nid:u(),sn:a.sn},task:{sch:{enable:a.enable,full_time:a.full_time,times:a.times}}},b,function(a,b){c({result:n(a)},b)})};this.time_get=function(a,b,c){var e,g,d,f,l,v,h,m,F;p("ccm_ntp_get",{sess:{nid:u(),sn:a.sn}},b,function(b,r){var C=n(b);""==C?(b=b.data?b.data.info:"",e=b.timezone,g=b.auto_sync_enable,d=b.manual[0].ip,p("ccm_date_get",{sess:{nid:u(),sn:a.sn}},r,function(a,b){var r=n(a);""==r&&(a=a.data?a.data.utc_date:"",f=a.time.hour,l=a.time.min,v=a.time.sec,h=a.date.year,m=a.date.mon,F=a.date.day);c({result:r,timezone:e,auto_sync:g,ntp_addr:d,hour:f,min:l,sec:v,year:h,mon:m,day:F},b)})):c({result:C},r)})};this.time_set=function(a,b,c){p("ccm_date_set",{sess:{nid:u(),sn:a.sn},type:a.type,timezone:a.timezone,utc_date:{time:{hour:a.hour,min:a.min,sec:a.sec},date:{year:a.year,mon:a.mon,day:a.day}}},b,function(b,g){var e=n(b);""==e?p("ccm_ntp_set",{sess:{nid:u(),sn:a.sn},auto_sync:a.auto_sync,manual:{ip:a.ntp_addr}},g,function(a,b){c({result:n(a)},b)}):c({result:e},g)})};this.upgrade_get=function(a,b,c){var e,g,d,f,l,v;p("ccm_upgrade_get",{sess:{nid:u(),sn:a.sn},check:a.check?a.check:0},b,function(a,b){var r=n(a);""==r&&(a=a.data?a.data:"",e=a.task?a.task.stat:a.stat,g=a.progress,os_ver=a.os_ver?a.os_ver:"",d=a._cur_ver,f=a._valid_ver,l=a.remark,v=a.changes,ext_prj=a.prj_ext,ext_hw=a.hw_ext);c({result:r,status:e,progress:g,os_ver:os_ver,ver_current:d,ver_valid:f,ver_extends:l,chang_history:v,ext_prj:ext_prj,ext_hw:ext_hw},b)})};this.upgrade_set=function(a,b,c){p("ccm_upgrade",{sess:{nid:u(),sn:a.sn},img_src:"download"},b,function(a,b){c({result:n(a)},b)})};this.restore=function(a,b,c){p("ccm_restore",{sess:{nid:u(),sn:a.sn},backup:a.keep_extends_cofig},b,function(a,b){c({result:n(a)},b)})};this.reboot=function(a,b,c){p("ccm_reboot",{sess:{nid:u(),sn:a.sn}},b,function(a,b){c({result:n(a)},b)})};this.audio_get=function(a,b,c){var e;p("ccm_speaker_get",{sess:{nid:u(),sn:a.sn},token:"ao0"},b,function(b,d){var g=n(b);""==g?(e=b.data.conf.level,p("ccm_mic_get",{sess:{nid:u(),sn:a.sn}},d,function(a,b){c({result:n(a),speaker_level:e,mic_level:a.data.conf[0].level},b)})):c({result:g},d)})};this.audio_set=function(a,b,c){p("ccm_speaker_set",{sess:{nid:u(),sn:a.sn},conf:{token:"ao0",level:a.speaker_level},force_persistence:1},b,function(b,g){var e=n(b);""==e?p("ccm_mic_get",{sess:{nid:u(),sn:a.sn}},g,function(b,g){var e=n(b);if(""==e){var d,f;b=b.data?b.data.conf[0]:"";e=b.entity;d=b.silent;f=b.token;p("ccm_mic_set",{sess:{nid:u(),sn:a.sn},conf:{entity:e,token:f,silent:d,level:a.mic_level},force_persistence:1},g,function(a,b){c({result:n(a)},b)})}else c({result:e},g)}):c({result:e},g)})};this.dev_msg_listener_add=function(a,b){f.dev_msg_listener_add(a,function(a,e){b(a,e)})};this.dev_msg_listener_del=function(a,b){f.dev_msg_listener_del(a,function(a,e){b(a,e)})};this.dev_activate=function(a,b,c){p("ccm_active",{sess:{nid:u(),sn:a.sn},ActivationCode:a.activationCode},b,function(a,b){c({result:n(a)},b)})};this.svr_dev_get=function(a,b){p("ccm_info_get",{},a,function(a,e){a.data?b({result:n(a),type:a.data.type,sn:a.data.sn,nick:a.data.nick,ver:a.data.ver},e):b({result:n(a)})})};this.set_fix=function(a){d=a};this.curise_get=function(a,b,c){p("ccm_curise_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var g=n(a);""==g?c({result:g,points:a.data.curise_info.points,enable:a.data.curise_info.enable},b):c({result:g},b)})};this.curise_set=function(a,b,c){p("ccm_curise_set",{sess:{nid:u(),sn:a.sn},type:a.type,index:a.index},b,function(a,b){c({result:n(a)},b)})};this.msg_filter_get=function(a,b,c){p("ccm_msg_filter_get",{sess:{nid:f.create_nid(),sn:a.sn}},b,function(a,b){var g=n(a),e=0,d=0;""==g&&(0>a.data.pub_filter.indexOf("alert")&&(e=1),0>a.data.pub_filter.indexOf("record")&&(d=1));c({result:g,alert_enable:e,record_enable:d},b)})};this.msg_filter_set=function(a,b,c){b=[];b[0]=a.alert_enable?"":"'alert'";b[1]=0==a.alert_enable+a.record_enable?",":"";b[2]=a.record_enable?"":"'record'";p("ccm_msg_filter_set",{sess:{nid:f.create_nid(),sn:a.sn},gen_filter:"{type:[]}",pub_filter:"{type:["+b.join("")+"]}"},null,function(a,b){c({result:n(a)},b)})};this.box_get=function(a,b,c){var e=a.cid?a.cid:-1,g=a.sid?a.sid:-1,d=a.direction?1:0;p("ccm_box_get",{sess:{nid:f.create_nid(),sn:a.box_sn},sn:a.dev_sn,flag:a.flag,start_time:a.start_time,end_time:a.end_time,cid:e,sid:g,search_type:a.search_type,direction:d},b,function(b,g){var e=n(b);if(""==e&&b.data)switch(a.flag){case 1:c({result:e,ipcs:b.data.ipcs},g);break;case 2:c({result:e,date_infos:b.data.date_infos},g);break;case 4:c({result:e,segs:b.data.segs},g);break;case 8:c({result:e,segs_sdc:b.data.segs_sdc},g)}else c({result:e},g)})};this.box_conf_get=function(a,b,c){p("ccm_box_conf_get",{sess:{nid:f.create_nid(),sn:a.box_sn}},null,function(a,b){var g=n(a);""==g&&a.data?c({result:n(a),conf:a.data},b):c({result:g},b)})};this.box_login=function(a,b,c){p("ccm_box_login",{sess:{nid:f.create_nid(),sn:a.box_sn},enable:a.enable,username:a.username,password:a.password},null,function(a,b){c({result:n(a)},b)})};this.ipcs_get=function(a,b,c){p("ccm_ipcs_get",{sess:{nid:f.create_nid(),sn:a.sn}},b,function(a,b){var g=n(a);""==g&&a.data?c({result:g,ipcs:a.data.ipcs},b):c({result:g},b)})};this.pic_base64_get=function(a,b,c){p("ccm_pic_get",{sess:{nid:f.create_nid(),sn:a.sn},token:a.token,flag:a.flag},b,function(a,b){var g=n(a);""==g&&a.data?c({result:g,frame:a.data.frame},b):c({result:g},b)})};this.box_set=function(a,b,c){p("ccm_box_set",{sess:{nid:u(),sn:a.box_sn},sn:a.dev_sn,cmd:a.cmd,start_time:a.start_time,end_time:a.end_time},b,function(a,b){c({result:n(a)},b)})};this.time_zone_get=function(a,b,c){p("ccm_zone_get",{sess:{nid:f.create_nid(),sn:a.sn},dev_sn:a.dev_sn},b,function(a,b){var g=n(a);""==g&&a.data&&c({result:g,data:a.data},b)})};this.binding_email=function(a,b,c){f.binding_email(a.email,a.user,a.pass,a.lang,a.version,a.appid,a.name,b,function(a,b){c({result:n(a)},b)})};this.recovery_binding_email=function(a,b,c){f.recovery_binding_email(a.email,a.user,a.lang,a.appid,a.name,b,function(a,b){c({result:n(a)},b)})};this.cpns_get=function(a,b,c){f.cpns_get(a.srv,a.start,a.counts,a.user,a.appid,b,function(a,b){c({result:n(a),conf:a.data},b)})};this.binding_email_get=function(a,b,c){f.binding_email_get(a.user,a.appid,b,function(a,b){c({result:n(a),conf:a.data},b)})};this.desc_get=function(a,b,c){p("ccvs_get_desc_req",{sess:{nid:f.create_nid()},ver_type:a.ver_type,ver_from:a.ver_from,ver_to:a.ver_to,lang:a.lang},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.scene_get=function(a,b,c){p("ccm_scene_get",{sess:{nid:f.create_nid(),sn:a.sn}},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.exdev_discover=function(a,b,c){p("ccm_exdev_discover",{sess:{nid:f.create_nid(),sn:a.sn},flag:a.flag,timeout:a.timeout,interval:a.interval},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.exdev_add=function(a,b,c){p("ccm_exdev_add",{sess:{nid:f.create_nid(),sn:a.sn},id:a.id,model:a.model},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.exdev_del=x;this.exdev_get=function(a,b,c){p("ccm_exdev_get",{sess:{nid:f.create_nid(),sn:a.sn},id:a.id,flag:a.flag,start:a.start,counts:a.counts},b,function(a,b){n(a);c({result:n(a),data:a.data},b)})};this.exdev_set=function(a,b,c){p("ccm_exdev_set",{sess:{nid:f.create_nid(),sn:a.sn},dev:a.dev},b,function(a,b){n(a);c({result:n(a),data:a.data},b)})};this.scene_set=function(a,b,c){p("ccm_scene_set",{sess:{nid:f.create_nid(),sn:a.sn},all:a.all,info:a.info},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.schedule_get=function(a,b,c){p("ccm_schedule_get",{sess:{nid:f.create_nid(),sn:a.sn}},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.schedule_set=function(a,b,c){p("ccm_schedule_set",{sess:{nid:f.create_nid(),sn:a.sn},sch:a.sch},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.hardware_test=function(a,b,c){p("ccm_hardware_test",{sess:{nid:u(),sn:a.sn},exdev:a.exdev},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.hardware_test_get=function(a,b,c){p("ccm_hardware_test_get",{sess:{nid:u(),sn:a.sn}},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.rf_test=function(a,b,c){p("ccm_test",{sess:{nid:u(),sn:a.sn},action:a.action,param:a.param},b,function(a,b){var g=n(a);c({result:g,data:a.data},b)})};this.get_download=m;this.feedback_submit=function(a,b,c){p({type:"ctck_create_ticket_req",to:"ctck",way:"from"},{title:a.title,series:a.series,content_item:a.content_item,upload_pic:a.upload_pic},b,function(a,b){""==a.data.result&&a.data&&c({result:a.data.result,data:a.data},b)})};this.test_ptz_ctrl=function(a,b,c){p("ccm_test",{sess:{nid:u(),sn:a.sn},action:a.action,param:a.param},b,function(a,b){c({result:n(a)},b)})}}function mcloud_entry(t,y){function p(n){var q;if("https:"==window.location.protocol){if(n>=A.length)return;q=A[n]}else{if(n>=u.length)return;q=u[n]}msdk_agent.send_msg({type:"cmipcgw_get_req",to:"cmipcgw",srv:q},{client:{mode:"user",id:t.userName,param:[{name:"appid",value:g_appId}]}},{},function(q,m){q&&""===q.data.result?("https:"==window.location.protocol?(g_server_https=q.data.server.signal[2],g_server_device=g_server_https.replace("https://","").replace("/ccm","")):(g_server_http=q.data.server.signal[0],g_server_device=g_server_http.replace("http://","").replace("/ccm","")),msdk_agent&&msdk_agent.set_srv(g_server_device),y()):p(n+1)})}var u=["52.8.41.82:7080","209.133.212.170:7080","149.202.201.87:7080","119.23.57.95:7080"],A=["www.mipcm.com:7443","www.vimtag.com:7446","www.ebitcam.com:7445","www.vsmahome.com:7444"];p(0)}function meval(t){try{return eval("("+t+")")}catch(y){return null}}function mobj_merge(t,y){var p,u,A,n;if(!y)return t;for(n in y)if(void 0!=(u=y[n])&&null!=u)if(u.constructor===Array)for(t[n]=A=[],p=0,len=u.length;p<len;p++)A[p]=u[p];else if("object"!=typeof u)t[n]=u;else{if(void 0==(A=t[n])||null==A)t[n]=A={};obj_merge(A,u)}return t}(function(t,y,p,u,A){u=u.prototype;y=y.prototype;p=p.prototype;A=A.prototype;y.cmp=function(n){var q,x,m=Math.min(this.length,n.length);for(q=0;q<m;q++)if(x=this.charCodeAt(q)-n.charCodeAt(q))return x;return this.length-n.length};y.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};p.toString1=function(){var n=this.getMonth()+1,q=this.getDate(),x=this.getHours(),m=this.getMinutes(),h=this.getSeconds();return this.getFullYear()+"\u5e74"+(10>n?"0":"")+n+"\u6708"+(10>q?"0":"")+q+"\u65e5"+(10>x?"0":"")+x+":"+(10>m?"0":"")+m+":"+(10>h?"0":"")+h};u.filter=u.filter||function(n,q){var x,m,h=this.length,l=[];if("function"!=typeof n)throw new TypeError;for(x=0;x<h;x++)x in this&&(m=this[x],n.call(q,m,x,this)&&l.push(m));return l};u.some=u.some||function(n,q){var x,m=this.length;if("function"!=typeof n)throw new TypeError;for(x=0;x<m;x++)if(x in this&&n.call(q,this[x],x,this))return!0;return!1};u.forEach=u.forEach||function(n,q){var x,m=this.length;if("function"!=typeof n)throw new TypeError;for(x=0;x<m;x++)x in this&&n.call(q,this[x],x,this)};(t.publisher=function(){this.subscribers=[]}).prototype.deliver=function(){for(var n=0,q,x=this.subscribers,m=x.length;n<m;)q=x[n],this.filter&&!this.filter(q,arguments)?n++:(q.fn.apply(q.fn,arguments),q=x[s_length],m>q?m=q:n++);return this};A.subscribe=function(n){var q,x=1,m={},h=this;if(!n.subscribers.some(function(l){return l.fn===h})){for(q=arguments.length;x<q;x++)m["arg"+(x-1)]=arguments[x];m.fn=h;n.subscribers.push(m)}return h};A.unsubscribe=function(n){var q=this;n.subscribers=n.subscribers.filter(function(n){return n.fn!==q});return q}})(window,String,Date,Array,Function);function is_ancestor(t,y){var p,u=document.body;if(t==u)return!0;for(p=y.parentNode;p&&p!=u;p=p.parentNode)if(t===p)return!0;return!1}function getElementsByClass(t,y,p){var u=[];null==y&&(y=document);null==p&&(p="*");y=y.getElementsByTagName(p);p=y.length;t=new RegExp("(^|\\s)"+t+"(\\s|$)");for(j=i=0;i<p;i++)t.test(y[i].className)&&(u[j]=y[i],j++);return u}(function(t,y){function p(u,A){var n=A||document;switch(typeof u){case "string":var q=u.substring(1);switch(u.charAt(0)){case "#":return n.getElementById(q);case ".":return n.getElementsByClassName?n.getElementsByClassName(q):getElementsByClass(q,n);case "/":return n.getElementsByTagName(q);default:return n.getElementsByName(u)}case "object":return u;case "function":p.funcs.push(u)}}p.funcs=[];p.loaded=!1;p.run=function(){if(!p.loaded){for(var u=0;u<p.funcs.length;u++)p.funcs[u]();p.loaded=!0;delete p.funcs;delete p.run}};t.addEventListener?t.addEventListener("load",p.run,!1):t.attachEvent?t.attachEvent("onload",p.run):t.onload=p.run;p.service_gid=1052078;p.ie6=0<=navigator.userAgent.indexOf("MSIE 6.");p.ie=0<=navigator.userAgent.indexOf("MSIE");t.hehe=t.mx=p})(window);function sound_play(t,y){var p=window.snd_player;p&&(hack.ie||(p.innerHTML=""),p.parentNode.removeChild(p));window.snd_player=p=document.createElement(hack.ie?"embed":"bgsound");p.style.cssText="width:1px;height:1px;left:0px;top:0px;";p.src=hack.ie?t:y;hack.ie?p.src=t:p.innerHTML="\x3cembed width\x3d'0' height\x3d'0' src\x3d'"+y+"'\x3e\x3c/embed\x3e";document.body.appendChild(p)}function dom_get_item_by_name(t,y,p){if(nodes=t.getElementsByTagName(y))for(node_index=0;node_index<nodes.length;++node_index)if(node=nodes[node_index],p==node.getAttribute("name"))return node;return null}(function(){var t,y,p,u,A=document;window.title_twinkle=function(n){p&&(clearInterval(p),p=null,t&&(A.title=t));n&&(t=A.title,A.title=y=n,p=setInterval(function(){A.title=(u=!u)?t:y},1E3))}})();function insert_after(t,y){y.nextSibling?y.parentNode.insertBefore(t,y.nextSibling):y.parentNode.appendChild(t)}function remove_self(t){t&&t.parentNode&&t.parentNode.removeChild(t);return t}function get_x(t){for(var y=0;t;)y+=t.offsetLeft,t=t.offsetParent;return y}function get_y(t){for(var y=0,p=t;p;p=p.offsetParent)y+=p.offsetTop;for(p=t.parentNode;p&&p!=document.body;p=p.parentNode)p.scrollTop&&(y-=p.scrollTop);return y}function viewport_width(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}function viewport_height(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}var mcodec=null;(function(t){function y(a,b){return(a?a:"%")+"0123456789abcdef".charAt(b>>4)+"0123456789abcdef".charAt(b&15)}function p(a){return 48<=a&&57>=a?a-48:65<=a&&71>=a?a-55:97<=a&&102>=a?a-87:0}function u(a,b){var c,g,d,e="",f=""+a;if(0==f.indexOf("0x"))for(c=f.length-1;1<c;){for(g=d=0;8>g&&1<c;--c,g+=4)d+=p(f.charCodeAt(c))<<g;e=l(d)+e}else for(c=24;0<=c;c-=8)a>=1<<c&&(e+=l(a>>c&255));for(;e.length<b;)e="\x00"+e;return e}function A(a,b){for(var c,g,d,e,f=0,r="",l=a.length,h=b?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_.-":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d";f<l;){for(g=0;24>g&&f<l;g+=8,++f)c=(c<<8)+a.charCodeAt(f);for(e=0;24>e;e+=6,c&=(1<<g-e)-1)d=g-e-6,r+=e<g?h.charAt(0>d?c<<-d:c>>d):""}return r}function n(b,c){var g,e,f,r,l,h,m,n="";f=0;for(h=b.length;f<h;++f)if(127>=(e=b.charCodeAt(f)))n+=a[g=b.charAt(f)]?y(c,e):g;else{m="";for(r=l=128>e?0:2048>e?1:65536>e?2:4194304>e?3:134217728>e?4:5;0<r;--r,e>>=6)m=y(c,128|e&63)+m;e|=d[l];n+=y(c,e)+m}return n}function q(a,b){var c,g,e,f=a.length,r,h,m,n="";b=b||"%";for(e=0;e<f;)if(b!=a.charAt(e)||e+3>f)n+=a.charAt(e),++e;else{c=(p(a.charCodeAt(e+1)&255)<<4)+p(a.charCodeAt(e+2)&255);r=d.length;for(g=0;1<r;--r)if(c>=d[r-1]){if((m=e+3*r)<=f){g=c-d[r-1];for(h=e+3;h<m&&b==a.charAt(h);h+=3)g=(g<<6)+((p(a.charCodeAt(h+1)&255)<<4)+p(a.charCodeAt(h+2)&255)&95);h==m&&(n+=l(g),e+=3*r)}break}0==g&&(n+=l(c),e+=3)}return n}function x(a,b){function c(a,b){var f,r,v,l,h=a.constructor==t?b+"__x_countz_"+g+a.length:"";for(f in a)if(void 0!=(r=a[f])&&null!=r){if(v="%"==(""+f).charAt(0))f=f.substr(1);l=b+(0!=f?(""==b?"d":"_")+f:"");"function"!=typeof r&&(h="object"==typeof r?h+((""==h?"":d)+(r.constructor==t?"":l+g+"1"+d)+c(r,l)):h+((""==h?"":d)+l+g+(v?r:n(""+r,e))))}return h}var g="-"==b?"-":"\x3d",d="\x3d"==g?"\x26":"-",e="-"==b?"_":"%";return c(a,"",b)}function m(a,b){function c(a,b,g){var d,e,f,r,v=a.constructor==t,l=v?'\x3cinput type\x3d"hidden" name\x3d"'+b+'__x_countz_" value\x3d"'+a.length+'"/\x3e\r\n':"";for(d in a)void 0!=(e=a[d])&&null!=e&&(f=b+(0!=d?(""==b?"d":"_")+d:""),r=""+g+(v?"["+d+"]":(""==g?"":".")+d),l="object"==typeof e?l+('\x3cdiv style\x3d"border:1px solid #00ffff;padding:2px;"\x3e\x3cbr/\x3e\r\n'+(0==d?"":'\x3cinput type\x3d"hidden" name\x3d"'+f+'" value\x3d"1"/\x3e\r\n')+c(e,f,r)+"\x3c/div\x3e\r\n"):l+("\x3clabel\x3e"+r+':\x3c/label\x3e\x3cinput type\x3d"text" name\x3d"'+f+'" value\x3d"'+e+'"/\x3e\x3cbr/\x3e'));return l}return'\x3cform action\x3d"'+b+'" method\x3d"get" style\x3d"border:2px solid blue;padding:1px;"\x3e\x3cbutton id\x3d"submit" type\x3d"submit"\x3e\u63d0\u4ea4\x3c/button\x3e\x3cbr/\x3e'+c(a,"","")+"\x3c/form\x3e"}function h(a){if(a){var b,c,d,g,e=0,f,l=a.constructor==t,m=l?"[":"{";for(b in a)switch(c=a[b],m+=(0==e++?"":",")+(l?"":b+":"),typeof c){case "number":m+=c;break;case "object":m+=h(c);break;case "string":m+='"';d=0;for(f=c.length;d<f;++d)g=c.charAt(d),m+='"'!=g&&"\\"!=g?"\n"==g?"\\n":"\r"==g?"\\r":g:"\\"+g;m+='"'}return m+(l?"]":"}")}return""}var l=String.fromCharCode,f=function(a){try{return eval("("+a+")")}catch(r){return null}},d=[0,192,224,240,248,252],a={},b=[["\x26","\x26amp;"],["\\n","\x26#10;"],["\\r","\x26#13;"],["\\t","\x26#9;"],["`","\x26#96;"],["'","\x26#39;"],['"',"\x26quot;"],[" ","\x26nbsp;"],["\x3c","\x26lt;"],["\x3e","\x26gt;"]],c=[{s:/\[img\]([^\]]*)\[\/img\]/gi,d:'\x3cimg src\x3d"$1" border\x3d"0"/\x3e'},{s:/\[flash\]([^\]]*)\[\/flash\]/gi,d:'\x3cembed type\x3d"application/x-shockwave-flash" pluginspage\x3d"http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version\x3dShockwaveFlash" quality\x3d"heigh" src\x3d"$1"/\x3e\x3c/embed\x3e'},{s:/\[url=([^\]]*)\]([^\]]*)\[\/url\]/gi,d:'\x3ca href\x3d"$1" target\x3d"_blank"\x3e$2\x3c/a\x3e'},{s:/\[url\]([^\]]*)\[\/url\]/gi,d:'\x3ca href\x3d"$1" target\x3d"_blank"\x3e$1\x3c/a\x3e'},{s:/\[email=([^\]]*)\]([^\]]*)\[\/email\]/gi,d:'\x3ca href\x3d"mailto:$1"\x3e$2\x3c/a\x3e'},{s:/\[email\]([^\]]*)\[\/email\]/gi,d:'\x3ca href\x3d"mailto:$1"\x3e$1\x3c/a\x3e'},{s:/\[color=([^\]]*)\]([^\]]*)\[\/color\]/gi,d:'\x3cfont color\x3d"$1"\x3e$2\x3c/font\x3e'},{s:/\[face=([^\]]*)\]([^\]]*)\[\/face\]/gi,d:'\x3cfont face\x3d"$1"\x3e$2\x3c/font\x3e'},{s:/\[size=1\]([^\]]*)\[\/size\]/gi,d:'\x3cfont size\x3d"1"\x3e$1\x3c/font\x3e'},{s:/\[size=2\]([^\]]*)\[\/size\]/gi,d:'\x3cfont size\x3d"2"\x3e$1\x3c/font\x3e'},{s:/\[size=3\]([^\]]*)\[\/size\]/gi,d:'\x3cfont size\x3d"3"\x3e$1\x3c/font\x3e'},{s:/\[size=4\]([^\]]*)\[\/size\]/gi,d:'\x3cfont size\x3d"4"\x3e$1\x3c/font\x3e'},{s:/\[align=([^\]]*)\]([^]]*)\[\/face\]/gi,d:'\x3calign\x3d"$1"\x3e$2\x3c/align\x3e'},{s:/\[fly\]([^\]]*)\[\/fly\]/gi,d:"\x3cmarquee\x3e$1\x3c/marquee\x3e"},{s:/\[b\]([^\]]*)\[\/b\]/gi,d:"\x3cb\x3e$1\x3c/b\x3e"},{s:/\[i\]([^\]]*)\[\/i\]/gi,d:"\x3ci\x3e$1\x3c/i\x3e"},{s:/\[u\]([^\]]*)\[\/u\]/gi,d:"\x3cu\x3e$1\x3c/u\x3e"},{s:/\[code\]([^\]]*)\[\/code\]/gi,d:'\x3cpre\x3e\x3cfont size\x3d"2" face\x3d"Verdana,Arial"\x3e$1\x3c/font\x3e\x3c/pre\x3e'},{s:/\[list\]([^\]]*)\[\/list\]/gi,d:"\x3cul\x3e$1\x3c/ul\x3e"},{s:/\[list=1\]([^\]]*)\[\/list\]/gi,d:'\x3col type\x3d"1"\x3e$1\x3c/ol\x3e'},{s:/\[list=a\]([^\]]*)\[\/list\]/gi,d:'\x3col type\x3d"a"\x3e$1\x3c/ol\x3e'},{s:/\[\*\]([^\]]*)\[\/\*\]/gi,d:"\x3cli\x3e$1\x3c/li\x3e"},{s:/\[quote\]([^\]]*)\[\/quote\]/gi,d:"\x3cblockquote\x3e$1\x3c/blockquote\x3e"}],e;for(e=0;21>e;++e)a["\x00\t\n\r\"\\' #%\x26+-_./:;\x3d?@".charAt(e)]=1;mcodec={magic:"mcodec",str_2_b64:A,b64_2_binary:function(a){if(a){for(var b=[],c=0;65>c;c++)b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_.-".charAt(c)]=c;var d,g,e,f,l=a.length,h=l;"-"==a.charAt(l-1)&&(h-=4);for(var m=[],c=0;c<h;c+=4)d=b[a.charAt(c)],g=b[a.charAt(c+1)],e=b[a.charAt(c+2)],f=b[a.charAt(c+3)],d=d<<2|g>>4,g=g<<4|e>>2,e=e<<6|f,m.push(d&255),m.push(g&255),m.push(e&255);h!=l&&(d=b[a.charAt(c)],g=b[a.charAt(c+1)],e=a.charAt(c+2),m.push((d<<2|g>>4)&255),"-"!=e&&(e=b[e],m.push((g<<4|e>>2)&255)));return m}},binary_2_b64:function(a,b){for(var c,d,g,e,f=0,r="",l=a.length,h=b?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_.-":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d";f<l;){for(d=0;24>d&&f<l;d+=8,f++)c=(c<<8)+a[f];for(e=0;24>e;e+=6,c&=(1<<d-e)-1)g=d-e-6,r+=e<d?h.charAt(0>g?c<<-g:c>>g):""}return r},str_2_uri_param:n,uri_param_2_str:q,uri_2_obj:function(a){var b={},c,d,g,e,f,l,h=a.length,m=0<h&&"-"==a.charAt(0)?"-":"\x3d",n="-"==m?"-":"\x26",H="-"==n?"_":"%";for(l=1;l<h;++l){for(d=l;l<h&&m!=(c=a.charAt(l))&&c!=n;++l);e=l-d;for(g=l+=l<h&&m==c?1:0;l<h&&n!=a.charAt(l);++l);f=l-g;0<e&&0<f&&(b[a.substr(d,e)]=q(a.substr(g,f),H))}return b},obj_2_url:x,json_txt_2_url:function(a,b){var c=a.indexOf("("),d=a.lastIndexOf(")");0<c&&d>c&&(a=a.substring(c+1,d));return x(f(a),b)},obj_2_form:m,json_txt_2_form:function(a,b){var c=a.indexOf("("),d=a.lastIndexOf(")");0<c&&d>c&&(a=a.substring(c+1,d));return m(f(a),b)},obj_2_str:h,str_2_html:function(a){for(var c=0;c<b.length;++c)a=a.replace(new RegExp(b[c][0],"g"),b[c][1]);return a},html_2_str:function(a){for(var c=b.length-1;0<=c;--c)a=a.replace(new RegExp(b[c][1],"g"),b[c][0]);return a},ubb_2_html:function(a){for(var b,d=c.length;0<=d;--d)b=c[d],a=a.replace(b.s,b.d);return a},hex_2_uri_param:function(a){var b,c="";for(b=0;b<a.length;++b)c+=(0==(1&b)?"%":"")+a.charAt(b);return c},nid:function(a,b,c,d,e,f,h,m){a=u(a);var g=b?u(b):"";b=b?u(d):"";f=f?u("0x"+h[m](f)):"";e=(a?l(64+a.length)+a:"")+(g?l(96+g.length)+g:"")+(b?l(128+b.length)+b:"")+(e?l(160+e.length)+e:"");c=e+(c?l(0+c.length)+c:"")+(f?l(0+f.length)+f:"");s_md5=u("0x"+h[m](c));return A(l(32+s_md5.length)+s_md5+e,1)}}})(Array);var mevt=null;(function(t){var y="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");mevt={bind:function(p,u,A){p.attachEvent?p.attachEvent("on"+u,A):p.addEventListener?p.addEventListener(u,A,0):p["on"+u]=A},unbind:function(p,u,A){p.detachEvent?p.detachEvent("on"+u,A):p.removeEventListener?p.removeEventListener(u,A,0):p["on"+u]=null},mude:function(p){p.preventDefault?p.preventDefault():p.returnValue=0},stop:function(p){p.stopPropagation?p.stopPropagation():p.cancelBubble=!0},fix:function(p){for(var u,A={},n=p.target,q=y.length,x=t.documentElement||t.body;q--;)u=y[q],A[u]=p[u];A.target=n=n?3===n.nodeType?n.parentNode:n:A.srcElement||t;u=A.fromElement;A.relatedTarget=A.relatedTarget||(u===n?A.toElement:u);null==A.pageX&&null!=A.clientX&&(A.pageX=A.clientX+x.scrollLeft-x.clientLeft,A.pageY=A.clientY+x.scrollTop-x.clientTop);A.metaKey=A.metaKey||A.ctrlKey;null==A.which&&(q=(u=A.charCode)||(0==u?u:A.keyCode),u=A.button,A.which=u?u&1?1:u&2?3:u&4?2:0:q);return A}}})(document);(function(t,y){function p(){h||(h=y.body,x=y.createElement("div"),h.appendChild(x),x.style.cssText="width:3px;margin:0px;padding:0px;border:1px solid white;",u=(x.offsetWidth-3)/2,x.style.cssText="width:3px;border:none;margin:0px;padding:1px;",A=(x.offsetWidth-3)/2,x.innerHTML='\x3ctable style\x3d"border-collapse:separate;border-spacing:0;"\x3e\x3ctr\x3e\x3ctd style\x3d"height:3px; border:0px"\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e',q=(x.getElementsByTagName("td")[0][s_offsetHeight]-3)/2,h.removeChild(x),x=y.createElement("textarea"),h.appendChild(x),x.style.cssText="width:10px;border:1px solid white;margin:0px;padding:0px",n=(x.offsetWidth-10)/2,x.style.cssText="width:10px;border:0px solid white;margin:0px;padding:1px",text_padding_space=(x.offsetWidth-10)/2,h.removeChild(x))}var u,A,n,q,x,m=navigator.userAgent,h,l=0<=m.indexOf("Opera"),f,d,a=!l&&0<=m.indexOf("compatible")&&0<=m.indexOf("MSIE");m.indexOf("Firefox");0<=m.indexOf("Safari")&&m.indexOf("Chrome");var b=0<=m.indexOf("Chrome");m.indexOf("Webkit");m.indexOf("Gecko");a&&((d=y.documentMode)||(d="CSS1Compat"==y.compatMode?7:5),x=/MSIE (\d+\.\d+);/,x.test(m),f=parseFloat(RegExp.$1));t.mhack={magic:"mhack",ie_mode:d,ie:a,ie_ver:f,chrome:b,opera:l,get_border_space:function(){p();return u},get_padding_space:function(){p();return A},get_text_border_space:function(){p();return n},get_text_padding_space:function(){p();return text_padding_space},get_td_border_space_v:function(){p();return q},css_alpha:function(b){return a&&9>d?"filter:alpha(opacity\x3d"+100*b+");":"opacity:"+b+";"},get_body_height:function(){p();return Math.max(h.clientHeight,("CSS1Compat"==y.compatMode&&y.documentElement||h).clientHeight)},css_box_shadow:function(b,e){x="2px 2px "+b+"px "+e+";";return a&&9>d?"filter:progid:DXImageTransform.Microsoft.Shadow(color\x3d"+e+", Direction\x3d135, Strength\x3d"+Math.round(b/2)+");":"-moz-box-shadow:"+x+"-webkit-box-shadow:"+x+"box-shadow:"+x}}})(window,document);function meval(t){try{return eval("("+t+")")}catch(y){return null}}function mmerge(t,y){var p,u,A,n;if(!y)return t;for(n in y)if(void 0!=(u=y[n])&&null!=u)if(u.constructor===Array)for(t[n]=A=[],p=0,len=u.length;p<len;p++)A[p]=u[p];else if("object"!=typeof u)t[n]=u;else{if(void 0==(A=t[n])||null==A)t[n]=A={};mmerge(A,u)}return t}function mme(t){this.create(t)}mme.prototype={magic:"mme",langs:{en:{plz_select:"please select ",mic:"microphone",cam:"camera",and:"and ",set_done:"OK",installing:"Installing...",rebot_hint:"After Install, Restart Browser",install_mme:"Install Video Pluggin",try_flash:"Try Video with Flash",download:"Download and Install",l1:"More clear / high resolution video screen, a better full-screen display",l2:"Network intelligence to adapt, video connected to faster, more fluid video and audio effects",l3:"Safe and viruses, ease of use, reliable and professional organizations certified signatures",l4:"Permanent free",l5:"System Requirements: Windows XP or later; browser: IE, Chrome, Firefox, Safari, Opera ..."},cn:{plz_select:"\u9009\u62e9",mic:"\u9ea6\u514b\u98ce",cam:"\u6444\u50cf\u5934",and:"\u548c",set_done:"\u786e\u5b9a",installing:"\u6b63\u5728\u5b89\u88c5...",rebot_hint:"\u5b89\u88c5\u5b8c\u6bd5\u540e\u91cd\u542f\u6d4f\u89c8\u5668",install_mme:"\u5b89\u88c5\u89c6\u9891\u52a0\u901f\u5668",try_flash:"\u6211\u5148\u8bd5\u8bd5\u666e\u901a\u89c6\u9891",download:"\u7acb\u5373\u5b89\u88c5\u89c6\u9891\u52a0\u901f\u5668",l1:"\u66f4\u6e05\u6670/\u9ad8\u5206\u8fa8\u7387\u7684\u89c6\u9891\u753b\u9762\uff0c\u66f4\u597d\u7684\u5168\u5c4f\u663e\u793a\u6548\u679c",l2:"\u7f51\u7edc\u667a\u80fd\u9002\u5e94\uff0c\u89c6\u9891\u63a5\u901a\u66f4\u5feb\uff0c\u5f71\u97f3\u6548\u679c\u66f4\u6d41\u7545",l3:"\u5b89\u5168\u65e0\u75c5\u6bd2\uff0c\u653e\u5fc3\u4f7f\u7528\uff0c\u4e13\u4e1a\u673a\u6784\u8ba4\u8bc1\u7684\u53ef\u9760\u7b7e\u540d",l4:"\u6c38\u4e45\u514d\u8d39",l5:"\u7cfb\u7edf\u8981\u6c42\uff1aWindows XP \u6216\u66f4\u9ad8\u7248\u672c\uff1b\u6d4f\u89c8\u5668\uff1aIE,Chrome,Firefox,Safari,Opera..."}},types:{install:{codebase:"MacIntel"==navigator.platform?"mme/npmme.pkg?0.160622.pkg":"mme/mme.exe?0.160622.exe"},activex:{name:"activex",xname:"MME.MMECtrl.1",clsid:"F3711E49-C6C3-4598-8888-8FD986250C98",codebase:"mme/mme_ie.cab",install_url:"",install_img:"",install_hint:""},xpcom:{name:"xpcom",mime:"fujikam"==window.fujikam?"application/mining-media-enginex":"application/mining-media-engine",codebase:"mme/npmme.xpi",install_url:"",install_img:"",install_hint:""},flash:{name:"flash",xname:"ShockwaveFlash.ShockwaveFlash",mime:"application/x-shockwave-flash",clsid:"D27CDB6E-AE6D-11cf-96B8-444553540000",codebase:"",install_img:"",install_url:"https://www.adobe.com/go/getflashplayer",src:"http://45.113.201.4:7080/dcm/sdk_plug/mme/mme.swf?0.130715.swf",install_hint:""}},debug:!0,windowless:0>(""+navigator.platform).indexOf("Linux"),id_allocer:{value:0},ver_min:.160814,chl_status:{closed:0,initting:1,initting_device:2,running:3},plug_status:{closed:0,initting:1,installing:2,running:3},enable_native_plug:!0,enable_flash_plug:!0,get_default_skin:function(){return{dev_panel:{width:360,height:180}}},create_plug:function(t,y,p,u){var A,n=this.id?this.id:++this.id_allocer.value,q=null,x=!!window.ActiveXObject||"ActiveXObject"in window;if(p&&(null==this.ver_cur||this.ver_cur>=this.ver_min))if(x&&"Win32"==navigator.platform)try{new ActiveXObject(this.types.activex.xname),q=this.types.activex}catch(m){}else null!=navigator.mimeTypes&&0<navigator.mimeTypes.length&&null!=navigator.mimeTypes[this.types.xpcom.mime]&&navigator.mimeTypes[this.types.xpcom.mime].enabledPlugin&&(q=this.types.xpcom);if(!q&&y)if(x)try{new ActiveXObject(this.types.flash.xname),q=this.types.flash}catch(m){}else null!=navigator.mimeTypes&&0<navigator.mimeTypes.length&&null!=navigator.mimeTypes[this.types.flash.mime]&&navigator.mimeTypes[this.types.flash.mime].enabledPlugin&&(q=this.types.flash);if(q){this.type!=mme.prototype&&(this.type=q);u=u.replace(/'/g,'"');"Win32"==navigator.platform&&navigator.userAgent.toLowerCase().match(/chrome\/([\d.]+)/)&&(t.style.background="black");t.innerHTML="\x3cobject id\x3d'plug_"+n+"' width\x3d'100%' height\x3d'100%'"+(x?" classid\x3d'clsid:"+q.clsid+"'":" type\x3d'"+q.mime+"'")+" codebase\x3d'"+q.codebase+"'"+(q==this.types.flash?" data\x3d'"+q.src+"'"+(this.windowless?" wmode\x3d'transparent'":""):"")+"\x3e"+(q==this.types.flash?" \x3cparam name\x3d'movie' value\x3d'"+q.src+"'/\x3e \x3cparam name\x3d'allowScriptAccess' value\x3d'always'/\x3e \x3cparam name\x3d'flashVars' value\x3d'mme_debug\x3d"+this.debug+"\x26mme_on_event\x3dplug_"+this.id+"_on_event\x26mme_params\x3d"+encodeURIComponent(u)+"'/\x3e \x3cparam name\x3d'allowFullScreen' value\x3d'true'/\x3e"+(this.windowless?" \x3cparam name\x3d'wmode' value\x3d'transparent'/\x3e":"")+"   \x3ca href\x3d'"+q.install_url+"'\x3e        \x3cimg border\x3d'none' src\x3d'"+q.install_img+"' alt\x3d'"+q.install_hint+"'/\x3e   \x3c/a\x3e":" \x3cparam name\x3d'mme_on_event' value\x3d'plug_"+this.id+"_on_event'/\x3e"+(this.windowless?" \x3cparam name\x3d'windowless' value\x3d'"+this.windowless+"'/\x3e":"")+"\x3cparam name\x3d'mme_params' value\x3d'"+u+"'/\x3e")+"\x3c/object\x3e";if(y=x?window["plug_"+n]:document.getElementById("plug_"+n))try{if("flash"!=q.name&&(A=meval(y.ctrl(0,"query","{flag:65535}")))&&(mme.prototype.ver_cur=A.version,A.version<this.ver_min))return t.innerHTML="",null}catch(m){}else t.innerHTML="";return y}return null},check_plug_install:function(t,y){var p,u,A,n=20,q=document.createElement("div"),x=!1;q.style.cssText="position:absolute;width:1px;height:1px;left:-1px;top:-1px;";document.body.appendChild(q);(p=this.create_plug(q,!1,!0,"{}"))?A=setInterval(function(){if(p&&"undefined"!=typeof p.ctrl||0>=--n){if(p&&"undefined"!=typeof p.ctrl)try{if(u=meval(p.ctrl(0,"query","{flag:65535}")))x=u.version>=mme.prototype.ver_min,mme.prototype.plug_valid=x}catch(m){}clearInterval(A);q.innerHTML="";q.parentNode.removeChild(q);y(t,u?u.version:null)}},50):(q.innerHTML="",q.parentNode.removeChild(q),y(t,null==this.ver_cur?null:this.ver_cur))},clipboard_get_img:function(t){null==this.clipboard_plug&&(document.body.appendChild(mme.prototype.clipboard_cont=document.createElement("div")),mme.prototype.clipboard_cont.style.cssText="position:absolute;top:-1px;left:-1px;width:1px;height:1px;",mme.prototype.clipboard_plug=mme.prototype.create_plug(mme.prototype.clipboard_cont,!1,!0,"{}"),null==mme.prototype.clipboard_plug||"undefined"==typeof mme.prototype.clipboard_plug.clipboard_get_img)&&(mme.prototype.clipboard_plug=null,mme.prototype.clipboard_cont.innerHTML="",mme.prototype.clipboard_cont.parentNode.removeChild(mme.prototype.clipboard_cont),mme.prototype.clipboard_cont=void 0);return this.clipboard_plug?this.clipboard_plug.clipboard_get_img(t):null},clear_install:function(){this.install_timer&&(clearInterval(this.install_timer),delete this.install_timer);this.install_panel&&(this.install_panel&&(this.install_panel.innerHTML="",this.install_panel.parentNode.removeChild(this.install_panel)),delete this.install_panel);this.install_test_panel&&(this.install_test_panel.parentNode&&(this.install_test_panel.innerHTML="",this.install_test_panel.parentNode.removeChild(this.install_test_panel)),delete this.install_test_panel)},install:function(){function t(a,b){var c=a.style;"cssFloat"in c?a.style.cssFloat=b:"styleFloat"in c&&(a.style.styleFloat=b)}var y,p=this,u=mme.prototype.types.install.codebase,A="block",n=210,q=18,x="left",m="right",h=0,l,f="block",d,a,b,c;this.clear_install();this.parent.appendChild(this.install_panel=document.createElement("div"));d=this.install_panel;if(460>d.clientWidth||320>d.clientHeight)A="none";460>d.clientWidth&&(n=.8*d.clientWidth,q=12,m=x="none",h=5);if(290>d.clientWidth||160>d.clientHeight)f="none";this.install_panel.innerHTML="\x3cdiv style\x3d'position:absolute;left:4%;width:92%;overflow:none;'\x3e\x3ccenter id\x3d'title_center' style\x3d'display:"+f+"'\x3e\x3cspan style\x3d'font-size:18px;'\x3e\x3cb\x3e"+this.lang.install_mme+"\x3c/b\x3e\x3c/span\x3e\x3c/center\x3e\x3cbr/\x3e\x3cdiv id\x3d'install_description_div' style\x3d'display:"+A+"'\x3e\x3cli\x3e"+this.lang.l1+"\x3c/li\x3e\x3cli\x3e"+this.lang.l2+"\x3c/li\x3e\x3cli\x3e"+this.lang.l3+"\x3c/li\x3e\x3cli\x3e"+this.lang.l4+"\x3c/li\x3e\x3cli\x3e"+this.lang.l5+"\x3c/li\x3e\x3cbr/\x3e\x3c/div\x3e\x3ca name\x3d'flash' href\x3d'#' style\x3d'float:"+x+";background:#333;font-size:"+q+"px;color:#fff;text-decoration:none;text-align:center;display:inline-block;width:"+n+"px;height:auto;line-height:32px;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5Px;"+mhack.css_box_shadow(1,"#666666")+"' onmouseover\x3d'this.style.background\x3d\"#666\";' onmouseout\x3d'this.style.background\x3d\"#333\";' \x3e"+this.lang.try_flash+"\x3c/a\x3e\x3ca name\x3d'plug' href\x3d'"+u+"' target\x3d'_blank' style\x3d'float:"+m+";background:#333;font-size:"+q+"px;color:#fff;text-decoration:none;text-align:center;display:inline-block;width:"+n+"px;height:auto;margin-top:"+h+"px;line-height:32px;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5Px;"+mhack.css_box_shadow(1,"#666666")+"' onmouseover\x3d'this.style.background\x3d\"#666\";' onmouseout\x3d'this.style.background\x3d\"#333\";'\x3e"+this.lang.download+"\x3c/a\x3e\x3cspan name\x3d'plug_installing' style\x3d'display:none'\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv style\x3d'float:clear;'\x3e\x3c/div\x3e";document.body.appendChild(this.install_test_panel=document.createElement("div"));window.onresize=function(){l=document.getElementById("install_description_div");c=document.getElementById("title_center");a=dom_get_item_by_name(d,"*","flash");b=dom_get_item_by_name(d,"*","plug");l&&(l.style.display=460>d.clientWidth||320>d.clientHeight?"none":"block");460>d.clientWidth&&(a&&(a.style.width=.8*d.clientWidth+"px",t(a,"none"),a.style.fontSize="12px"),b&&(b.style.width=.8*d.clientWidth+"px",t(b,"none"),b.style.marginTop="5px",b.style.fontSize="12px"));c&&(c.style.display=290>d.clientWidth&&160>d.clientHeight?"none":"block")};if(this.on_event)this.on_event({type:"install_ui",panel:this.install_panel,download:u,ver_cur:this.ver_cur});this.install_panel.style.visibility="";this.install_test_panel.style.cssText="position:absolute;left:-1px;top:-1px;width:1px;height:1px;";(y=dom_get_item_by_name(this.install_panel,"*","flash"))&&mevt.bind(y,"click",function(a){p.clear_install();p.status=p.plug_status.initting;if(null==(p.plug_obj=p.create_plug(p.parent,!0,!0,p.create_params))){if(p.status=p.plug_status.closed,p.on_event)p.on_event({type:"missing"})}else if(p.on_event)p.on_event({type:"create"});return!1});(y=dom_get_item_by_name(this.install_panel,"*","plug"))&&mevt.bind(y,"click",function(a){if(y=dom_get_item_by_name(p.install_panel,"*","plug_installing")){if(y.style.display="",y.innerHTML=p.lang.installing,y=dom_get_item_by_name(p.install_panel,"*","plug"))y.style.display="none"}else if(y=dom_get_item_by_name(p.install_panel,"*","plug"))y.innerHTML="\x3cb\x3e"+(mhack.ie||mhack.chrome?p.lang.installing:p.lang.rebot_hint)+"\x3c/b\x3e";if(mhack.ie||mhack.chrome)p.install_timer=setInterval(function(){if(mme.prototype.create_plug(p.install_test_panel,!1,!0,p.create_params))if(p.clear_install(),p.status=p.plug_status.initting,null==(p.plug_obj=p.create_plug(p.parent,!0,!0,p.create_params))){if(p.status=p.plug_status.closed,p.on_event)p.on_event({type:"missing"})}else if(p.on_event)p.on_event({type:"create"})},1E3)})},on_plug_event:function(t){t=meval(t);if(null==t)return 0;t.target&&t.target.type&&t.target.url&&(t.chl=this.chl_get(t.target.type,t.target.url));switch(t.type){case "is_ready":return null!=this.plug_obj;case "ready":this.status=this.plug_status.running;break;case "close":t.chl&&(t.chl.status=this.chl_status.closed,t.chl.id=0)}if(this.is_created&&this.on_event)this.on_event(t);return 0},create:function(t){var y=t.parent,p=this;if(void 0!=t.hls_id&&null!=t.hls_id)return/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?this.platform="ios":/(Android)/i.test(navigator.userAgent)?this.platform="android":this.platform="pc",this.hls_id=t.hls_id,this.ref_obj=t.ref_obj,this.parent=y,this.ref_obj.mme=this,this.on_event=t.on_event,t=null,"pc"==this.platform?(this.parent.innerHTML='\x3cvideo  class\x3d"video-js vjs-default-skin vjs-big-play-centered" controls\x3e\x3csource id\x3d"hls-vs" type\x3d"application/x-mpegURL"\x3e\x3c/video\x3e',t=y.getElementsByClassName("video-js vjs-default-skin vjs-big-play-centered")[0],t.width=this.parent.offsetWidth,t.height=this.parent.offsetHeight):(this.parent.innerHTML='\x3cvideo class\x3d"video-js" style\x3d"width:100%; height:100%; object-fit: fill" controls\x3e\x3c/video\x3e',t=y.getElementsByClassName("video-js")[0]),t.id=this.hls_id,this.player=null,this.on_event(this.ref_obj),0;this.skin=this.get_default_skin();"object"==typeof t.skin&&obj_merge(this.skin,t.skin);this.parent=y;void 0!=t.debug&&(this.debug=t.debug);void 0!=t.windowless&&(this.windowless=t.windowless);void 0!=t.enable_native_plug&&(this.enable_native_plug=t.enable_native_plug);void 0!=t.enable_flash_plug&&(this.enable_flash_plug=t.enable_flash_plug);this.on_event=t.on_event;this.mic_index=this.cam_index=-1;this.chls=[];this.create_params=t.params||"";this.ref_obj=t.ref_obj;this.is_created=!1;t.on_event&&(this.on_event_callback=t.on_event,this.on_event=function(u){u.plug=p;u.ref_obj=p.ref_obj;p.on_event_callback(u);u.plug=u.ref_obj=null});this.id=++this.id_allocer.value;window["plug_"+this.id+"_on_event"]=function(u){return p.on_plug_event(u)};this.status=this.plug_status.initting;if(null==(this.plug_obj=this.create_plug(y,this.enable_flash_plug&&(!t.plug_install_mute||"Win32"!=navigator.platform&&"MacIntel"!=navigator.platform),this.enable_native_plug,this.create_params)))if(!this.enable_native_plug||t.plug_install_mute||"Win32"!=navigator.platform&&"MacIntel"!=navigator.platform){if(p.status=p.plug_status.closed,p.on_event)p.on_event({type:"missing"})}else if(p.status=p.plug_status.initting,null==(p.plug_obj=p.create_plug(y,!0,!0,p.create_params))){if(p.status=p.plug_status.closed,p.on_event)p.on_event({type:"missing"})}else{if(p.on_event)p.on_event({type:"create"})}else this.status==this.plug_status.running&&p.on_event&&setTimeout(function(){if(p.on_event)p.on_event({type:"ready"})},0);this.is_created=!0},destroy:function(){this.clear_install();window["plug_"+this.id+"_on_event"]=null;for(var t,y=this.chls.length-1;0<=y;--y)(t=this.chls[y])&&this.chl_destroy(t);this.dev_form&&(this.dev_form.onsubmit=null,this.dev_form.innerHTML="",this.dev_form.parentNode.removeChild(this.dev_form),delete this.dev_form);this.plug_obj&&delete this.plug_obj;this.parent&&(this.parent.innerTHML="",delete this.parent);this.id&&delete this.id;this.status&&delete this.status;this.on_event&&delete this.on_event},update:function(){},is_ready:function(t){return this.plug_obj&&this.status==this.plug_status.running&&(null==t||"undefined"!=typeof this.plug_obj[t])},select_device:function(t,y,p){var u,A,n,q,x=this,m=this.dev_form,h="";null==m&&(this.parent.appendChild(this.dev_from=m=document.createElement("form")),m.style.cssText="position:absolute;left:0px;top:0px;width:100%;height:100%;overflow-y:auto;overflow-x:none;padding:0px;margin:0px;background:transparent;background:#000;color:#fff;line-height:1.5em;font-size:12px;");m.style.visibility="hidden";m.innerHTML="";h+="\x3cdiv style\x3d'position:absolute;left:5%;width:90%'\x3e\x3cbr/\x3e\x3ccenter\x3e\x3cspan style\x3d'font-size:18x;'\x3e\x3cb\x3e"+this.lang.plz_select+this.lang.cam+this.lang.and+this.lang.mic+"\x3c/span\x3e\x3c/center\x3e";if(t&&0<t.length)for(h+="\x3cbr/\x3e\x3cspan\x3e"+this.lang.cam+"\x3c/span\x3e\x3cbr/\x3e",A=0;A<t.length;A++)u=t[A],h+="\x3cinput type\x3d'radio' name\x3d'cam' id\x3d'cam_"+u.index+"' value\x3d'"+u.index+"' "+(0==A?"checked":"")+"/\x3e\x3clabel for\x3d'cam_"+u.index+"'\x3e"+u.name+"\x3c/label\x3e\x3cbr/\x3e";if(y&&0<y.length)for(h+="\x3cbr/\x3e\x3cspan\x3e"+this.lang.mic+"\x3c/span\x3e\x3cbr/\x3e",A=0;A<y.length;A++)u=y[A],h+="\x3cinput type\x3d'radio' name\x3d'mic' id\x3d'mic_"+u.index+"' value\x3d'"+u.index+"' "+(0==A?"checked":"")+"/\x3e\x3clabel for\x3d'mic_"+u.index+"'\x3e"+u.name+"\x3c/label\x3e\x3cbr/\x3e";h+="\x3cbr/\x3e\x3ccenter\x3e\x3cinput type\x3d'submit' value\x3d'"+this.lang.set_done+"' onmouseover\x3d'this.style.background\x3d\"#666\";' onmouseout\x3d'this.style.background\x3d\"#333\";' style\x3d'cursor:pointer;border:none;padding:0px;margin:0px;font-size:14px;color:#fff;width:120px;height:24px;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3Px;"+mhack.css_box_shadow(1,"#666666")+"line-height:32px;background:#333;'/\x3e\x3c/center\x3e\x3c/div\x3e";m.innerHTML=h;if(this.on_event)this.on_event({type:"select_device_ui",form:m,mics:y,cams:t});m.style.visibility="";m.onsubmit=function(){A=0;for(q=m.getElementsByTagName("input");A<q.length;++A)"radio"==(n=q[A]).type&&n.checked&&("cam"==n.name?x.cam_index=n.value:"mic"==n.name&&(x.mic_index=n.value));m.style.display="none";p();return!1}},init_device:function(t){function y(){if(t.on_done)t.on_done()}if(null==this.plug_info&&(this.plug_info=meval(this.plug_obj.ctrl(0,"query","{flag:65535}")))&&this.plug_info.camera){var p=[],u,A,n=this.plug_info.camera;for(u=0;u<n.length;++u)(A=n[u])&&0>A.name.indexOf("Google Camera Adapter")&&p.push(A);this.plug_info.camera=p}0>this.cam_index&&1==this.plug_info.camera.length&&(this.cam_index=this.plug_info.camera[0].index);0>this.mic_index&&1<=this.plug_info.microphone.length&&(this.mic_index=this.plug_info.microphone[0].index);0>this.cam_index&&1<this.plug_info.camera.length?this.select_device(this.plug_info.camera,this.plug_info.microphone,y):y()},chl_get:function(t,y){for(var p=this.chls,u=p.length-1;0<=u;--u)if((chl=p[u])&&chl.type==t&&y==chl.url)return chl;return null},chl_destroy:function(t){if(void 0!=this.hls_id&&null!=this.hls_id&&null!=this.player)return this.player.dispose(),this.player=null,0;for(var y=this.chls,p=y.length-1;0<=p;--p)if(t==y[p]){t.timer&&(clearTimeout(t.timer),t.timer=null);this.chl_status.initting_device==t.status&&(this.dev_from.style.display="none");t.status=this.chl_status.stopped;0<t.id&&(this.is_ready("chl_destroy")&&this.plug_obj.chl_destroy(t.id),t.id=0);t.refer=null;y.splice(p,1);break}},chl_dev_index_param:function(t,y){return"\ncam.index\x3d"+t+"\nmic.index\x3d"+y},chl_ctrl:function(t,y){if(void 0!=this.hls_id&&null!=this.hls_id)if("create"==t)this.chl_create(y);else if("destroy"==t)this.chl_destroy(0);else if("play"==t)this.player.play();else if("pause"==t)this.player.pause();else if("change"==t)"pc"==this.platform?this.player.src({src:y+".m3u8",type:"application/x-mpegURL"}):(this.player.src=y+".m3u8",this.player.load());else if("catch_err"==t&&"pc"==this.platform)this.player.on("error",function(){var p=this.error(),u=null;1==p.code?u="\u89c6\u9891\u64ad\u653e\u88ab\u7ec8\u6b62":2==p.code?u="\u7f51\u7edc\u9519\u8bef\u5bfc\u81f4\u89c6\u9891\u4e0b\u8f7d\u4e2d\u9014\u5931\u8d25":3==p.code?u="\u7531\u4e8e\u89c6\u9891\u6587\u4ef6\u635f\u574f\u6216\u662f\u8be5\u89c6\u9891\u4f7f\u7528\u4e86\u4f60\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u7684\u529f\u80fd\uff0c\u64ad\u653e\u7ec8\u6b62":4==p.code?u="\u89c6\u9891\u56e0\u683c\u5f0f\u4e0d\u652f\u6301\u6216\u8005\u670d\u52a1\u5668\u6216\u7f51\u7edc\u7684\u95ee\u9898\u65e0\u6cd5\u52a0\u8f7d":5==p.code&&(u="\u89c6\u9891\u5df2\u52a0\u5bc6\uff0c\u65e0\u6cd5\u89e3\u5bc6");y.call(u)})},chl_create:function(t){if(void 0!=this.hls_id&&null!=this.hls_id){var y={html5:{hlsjsConfig:{manifestLoadingTimeOut:2E4,levelLoadingTimeOut:2E4,levelLoadingMaxRetry:20,fragLoadingMaxRetry:20,manifestLoadingMaxRetry:20,manifestLoadingRetryDelay:2E3,fragLoadingRetryDelay:1E3}}};t=meval(t.params).src[0].url;var p=document.getElementById(this.hls_id);"pc"==this.platform?(p.getElementsByTagName("source")[0].src=t+".m3u8",this.player=videojs(this.hls_id,y),this.player.src({src:t+".m3u8",type:"application/x-mpegURL"})):(p.src=t+".m3u8",this.player=p);return this.player}return this.is_ready("chl_create")?(y={params:t.params||""},0>=(y.id=this.plug_obj.chl_create(y.params))?null:this.chls[this.chls.length]=y):null},ctrl:function(t,y,p){try{return this.is_ready("ctrl")?this.plug_obj.ctrl(t?t.id:0,y,p):'{type:"error",status:-1}'}catch(u){return'{type:"error",status:-1}'}}};mme.prototype.lang=window.lang_get?lang_get(mme.prototype.langs):mme.prototype.langs.cn;(function(t,y,p,u){function A(){for(var a in m)m[a]&&q(m[a],"cancel")}function n(){var a,b,d=(new Date).getTime();for(a in m)(b=m[a])&&b.time<d&&q(b,"timeout")}function q(a,b){var c=a.js,e=a.seq,l=a.x;delete m[e];c&&(delete a.js,c.parentNode&&d.removeChild(c));l&&(delete a.x,l.abort());a.on_ack(b,a.ref);l&&(l.onreadystatechange=f,h[e]=l)}function x(a){var c,d;for(c in h)if(d=h[c]){delete h[c];d.abort();break}d=d||(t.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"));d.open(a.param?"post":"get",a.url,!0);d.onreadystatechange=function(){var c=d;if(a.x==c&&4==c.readyState){var e,g=a.seq;if(0==c.status)m[g]&&q(a,"abort");else{if(200==c.status||304==c.status){var l=c.responseText,D=l.indexOf("("),B=l.lastIndexOf(")");B>D+2&&"{"==l.charAt(D+1)&&"}"==l.charAt(B-1)&&(e=b(l.substring(D+1,B)))}a.x=null;q(a,e||"error");c.onreadystatechange=f;h[g]=c}}};a.param&&d.setRequestHeader("content-type","application/x-www-form-urlencoded;charset\x3dutf-8");(a.x=d).send(a.param)}var m={},h={},l=Math.floor(1E6*Math.random()),f=function(){},d,a,b=function(a){try{return eval("("+a+")")}catch(e){return null}};(function(){a=setInterval(n,5E3);p.bind(t,"unload",function(){clearInterval(a);t.message=null;A();for(var b in h)h[b]&&delete h[b]});t.message=function(a){var b=m[a.to_handle];b&&q(b,a)}})();t.mrpc={magic:"rpc",call:function(a){if(a&&a.on_ack&&a.type){var b=!a["static"],c="json"!=a.way&&"get"!=a.method,f=a.from_handle,h=a.qid,C=b||c?"\x26":"-",v="-"==C?"-":"\x3d",D=(a.srv?a.srv:"/")+(a.to?a.to:"")+"/"+a.type,f="hfrom_handle"+v+(null==f?++l:f)+(null==h?"":C+"hqid"+v+h)+C+u.obj_2_url(a.data,C),b={seq:l,on_ack:a.on_ack,time:(new Date).getTime()+(a.timeout?a.timeout:3E5),url:c?D+".js":b?D+".js?"+f:D+"/-"+f+".js",param:c?f:"",ref:a.ref};if("test"!=a.way){m[l]=b;try{if("json"==a.way){var B=b.js=y.createElement("script");B.type="text/javascript";B.language="javascript";B.async=!0;B.src=b.url;(d||(d=y.getElementsByTagName("head")[0]||y.documentElement)).insertBefore(B,d.firstChild)}else x(b)}catch(F){q(b,"error")}}return b.url}},cancel:A}})(window,document,mevt,mcodec);var mdh=null;(function(t,y){function p(a,b){for(var c=1,d=0;;){if(1==a)return c;if(0==a)return 0;d-=c*t.floor(b/a);b%=a;if(1==b)return d;if(0==b)return 0;c-=d*t.floor(a/b);a%=b}}function u(a,b,c){var d,e=a.length,g=b.length;k=e+c<g?e+c:g;for(d=g-1-c;d<e&&0<=d;d++)if(0<a[d])return 1;for(d=e-1+c;d<g;d++)if(0<b[d])return 0;for(d=k-1;d>=c;d--){if(a[d-c]>b[d])return 1;if(a[d-c]<b[d])break}return 0}function A(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=a.length;c<b.length;c++)if(b[c])return 0;for(c=b.length;c<a.length;c++)if(a[c])return 1;for(c=d-1;0<=c;c--){if(a[c]>b[c])return 1;if(a[c]<b[c])break}return 0}function n(a,b,c){b=t.ceil(b/v)+1;buff=new y(c>b?c:b);d(buff,a);return buff}function q(a,b,c){var d,e,g,r=a.length;if(-1==b){for(g=new y(0);;){b=new y(g.length+1);for(e=0;e<g.length;e++)b[e+1]=g[e];b[0]=parseInt(a,10);g=b;d=a.indexOf(",",0);if(1>d)break;a=a.substring(d+1);if(0==a.length)break}return g.length<c?(b=new y(c),f(b,g),b):g}g=n(0,b*r,0);for(e=0;e<r;e++){d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_\x3d!@#$%^\x26*()[]{}|;:,.\x3c\x3e/?`~ \\'\"+-".indexOf(a.substring(e,e+1),0);36>=b&&36<=d&&(d-=26);if(d>=b||0>d)break;var l=g,h=b,m,C,E,H;if(h)for(C=l.length,m=E=0;m<C;m++)E+=l[m]*h,H=0,0>E&&(H=-(E>>v),E+=H*B),l[m]=E&D,E=(E>>v)-H;l=g;l[0]+=d;h=l.length;for(d=m=0;d<h&&(m+=l[d],C=0,0>m&&(C=-(m>>v),m+=C*B),l[d]=m&D,m=(m>>v)-C,m);d++);}for(r=g.length;0<r&&!g[r-1];r--);r=c>r+1?c:r+1;b=new y(r);a=r<g.length?r:g.length;for(e=0;e<a;e++)b[e]=g[e];for(;e<r;e++)b[e]=0;return b}function x(a,b){var c;if(a[0]!=b)return 0;for(c=1;c<a.length;c++)if(a[c])return 0;return 1}function m(a){var b;for(b=0;b<a.length;b++)if(a[b])return 0;return 1}function h(a,b){var d,e="";T.length!=a.length?T=l(a):f(T,a);if(-1==b){for(d=a.length-1;0<d;d--)e+=a[d]+",";e+=a[0]}else for(;!m(T);)d=c(T,b),e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_\x3d!@#$%^\x26*()[]{}|;:,.\x3c\x3e/?`~ \\'\"+-".substring(d,d+1)+e;0==e.length&&(e="0");return e}function l(a){buff=new y(a.length);f(buff,a);return buff}function f(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=0;c<d;c++)a[c]=b[c];for(c=d;c<a.length;c++)a[c]=0}function d(a,b){var c,d;d=b;for(c=0;c<a.length;c++)a[c]=d&D,d>>=v}function a(a,b){var c,d=t.floor(b/v);if(d){for(c=0;c<a.length-d;c++)a[c]=a[c+d];for(;c<a.length;c++)a[c]=0;b%=v}for(c=0;c<a.length-1;c++)a[c]=D&(a[c+1]<<v-b|a[c]>>b);a[c]>>=b}function b(a,b){var c,d=t.floor(b/v);if(d){for(c=a.length;c>=d;c--)a[c]=a[c-d];for(;0<=c;c--)a[c]=0;b%=v}if(b){for(c=a.length-1;0<c;c--)a[c]=D&(a[c]<<b|a[c-1]>>v-b);a[c]=D&a[c]<<b}}function c(a,b){var c,d=0;for(c=a.length-1;0<=c;c--)d=d*B+a[c],a[c]=t.floor(d/b),d%=b;return d}function e(a,b,c,d){var e,g,f,r;f=a.length<d+b.length?a.length:d+b.length;r=a.length;g=0;for(e=d;e<f;e++)g+=a[e]+c*b[e-d],a[e]=g&D,g>>=v;for(e=f;g&&e<r;e++)g+=a[e],a[e]=g&D,g>>=v}function g(c,g){H.length!=c.length?H=l(c):f(H,c);ba.length!=c.length&&(ba=l(c));var r=ba,h,m,C,E,F,n;f(c,H);for(m=g.length;0==g[m-1];m--);h=g[m-1];for(n=0;h;n++)h>>=1;n=v-n;b(g,n);b(c,n);for(h=c.length;0==c[h-1]&&h>m;h--);for(d(r,0);!u(g,c,h-m);){C=c;E=g;F=h-m;var q,Q,x,p;x=C.length<F+E.length?C.length:F+E.length;p=C.length;Q=0;for(q=F;q<x;q++)Q+=C[q]-E[q-F],C[q]=Q&D,Q>>=v;for(q=x;Q&&q<p;q++)Q+=C[q],C[q]=Q&D,Q>>=v;r[h-m]++}for(--h;h>=m;h--){for(r[h-m]=c[h]==g[m-1]?D:t.floor((c[h]*B+c[h-1])/g[m-1]);;)if(E=(1<m?g[m-2]:0)*r[h-m],F=E>>v,E&=D,C=F+r[h-m]*g[m-1],F=C>>v,C&=D,F==c[h]?C==c[h-1]?E>(1<h?c[h-2]:0):C>c[h-1]:F>c[h])r[h-m]--;else break;e(c,g,-r[h-m],h-m);if(c[c.length-1]>>v-1&1){C=c;E=g;F=h-m;x=C.length<F+E.length?C.length:F+E.length;p=C.length;Q=0;for(q=F;q<x;q++)Q+=C[q]+E[q-F],C[q]=Q&D,Q>>=v;for(q=x;Q&&q<p;q++)Q+=C[q],C[q]=Q&D,Q>>=v;r[h-m]--}}a(g,n);a(c,n)}function r(a,b,c){var r;aa.length!=2*a.length&&(aa=new y(2*a.length));d(aa,0);for(r=0;r<b.length;r++)b[r]&&e(aa,a,b[r],r);g(aa,c);f(a,aa)}function E(a,b){var c;for(c=a.length;0<c&&!a[c-1];c--);c=new y(c+b);f(c,a);return c}function C(a,b,c,e){var g,r,l,h,m,C,E=c.length,B=b.length;J.length!=E&&(J=new y(E));for(d(J,0);0<E&&0==c[E-1];E--);for(;0<B&&0==b[B-1];B--);C=J.length-1;for(g=0;g<E;g++){m=J[0]+a[g]*b[0];h=(m&D)*e&D;l=m+h*c[0]>>v;m=a[g];for(r=1;r<B-4;)l+=J[r]+h*c[r]+m*b[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r]+m*b[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r]+m*b[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r]+m*b[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r]+m*b[r],J[r-1]=l&D,l>>=v,r++;for(;r<B;)l+=J[r]+h*c[r]+m*b[r],J[r-1]=l&D,l>>=v,r++;for(;r<E-4;)l+=J[r]+h*c[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r],J[r-1]=l&D,l>>=v,r++,l+=J[r]+h*c[r],J[r-1]=l&D,l>>=v,r++;for(;r<E;)l+=J[r]+h*c[r],J[r-1]=l&D,l>>=v,r++;for(;r<C;)l+=J[r],J[r-1]=l&D,l>>=v,r++;J[r-1]=l&D}if(!A(c,J)){b=J;r=b.length<c.length?b.length:c.length;for(e=g=0;e<r;e++)g+=b[e]-c[e],b[e]=g&D,g>>=v;for(e=r;g&&e<b.length;e++)g+=b[e],b[e]=g&D,g>>=v}f(a,J)}for(var v=0,D=0,B=D+1,v=0;1<<v+1>1<<v;v++);var v=v>>1,D=(1<<v)-1,B=D+1,F=n(1,1,1),S=[],aa=S,Q=S,H=S,ba=S,T=S,W=S,J=S,V={Base:10,PowMod:function(a,b,e){a=q(a,this.Base);b=q(b,this.Base);e=q(e,this.Base);var m=a;a=e.length;a=n(0,(m.length>a?m.length:a)*v,0);f(a,m);b=E(b,2);e=E(e,2);var H,S;W.length!=e.length&&(W=l(e));if(0==(e[0]&1))for(f(W,a),d(a,1);!x(b,0);){b[0]&1&&r(a,W,e);c(b,2);m=W;S=e;var A,u,t;for(H=m.length;0<H&&!m[H-1];H--);A=H>S.length?2*H:2*S.length;aa.length!=A&&(aa=new y(A));d(aa,0);for(A=0;A<H;A++){t=aa[2*A]+m[A]*m[A];aa[2*A]=t&D;t>>=v;for(u=A+1;u<H;u++)t=aa[A+u]+2*m[A]*m[u]+t,aa[A+u]=t&D,t>>=v;aa[A+H]=t}g(aa,S);f(m,aa)}else{d(W,0);for(m=e.length;0<m&&!e[m-1];m--);S=B;A=0;for(H=e.length-1;0<=H;H--)A=(A*B+e[H])%B;S-=p(A,B);W[m]=1;r(a,W,e);Q.length!=a.length?Q=l(a):f(Q,a);for(m=b.length-1;0<m&!b[m];m--);if(0==b[m])d(a,1);else{for(H=1<<v-1;H&&!(b[m]&H);H>>=1);for(;;){if(!(H>>=1)){m--;if(0>m){C(a,F,e,S);break}H=1<<v-1}C(a,a,e,S);H&b[m]&&C(a,Q,e,S)}}}a=E(a,1);return a=h(a,this.Base)},RandomInt:function(a){var b;b=t.floor((a-1)/v)+2;b=n(0,0,b);var c,d;for(c=0;c<b.length;c++)b[c]=0;d=t.floor((a-1)/v)+1;for(c=0;c<d;c++)b[c]=t.floor(t.random()*(1<<v-1));b[d-1]&=(2<<(a-1)%v)-1;return h(b,this.Base)}};mdh={prime:"791658605174853458830696113306796803",g:"5",gen_private:function(){return V.RandomInt(64)},gen_public:function(a){return V.PowMod("5",a,"791658605174853458830696113306796803")},gen_shared_secret:function(a,b){return V.PowMod(b,a,"791658605174853458830696113306796803")}}})(Math,Array);var mmd5=mmd5||function(){function t(f,d){var a=(f&65535)+(d&65535);return(f>>16)+(d>>16)+(a>>16)<<16|a&65535}function y(f,d,a,b,c,e){f=t(t(d,f),t(b,e));return t(f<<c|f>>>32-c,a)}function p(f,d,a,b,c,e,g){return y(d&a|~d&b,f,d,c,e,g)}function u(f,d,a,b,c,e,g){return y(d&b|a&~b,f,d,c,e,g)}function A(f,d,a,b,c,e,g){return y(a^(d|~b),f,d,c,e,g)}function n(f,d){f[d>>5]|=128<<d%32;f[(d+64>>>9<<4)+14]=d;var a=1732584193,b=-271733879,c=-1732584194,e=271733878,g=0;for(d=f.length;g<d;g+=16)var r=a,l=b,h=c,m=e,a=p(a,b,c,e,f[g+0],7,-680876936),e=p(e,a,b,c,f[g+1],12,-389564586),c=p(c,e,a,b,f[g+2],17,606105819),b=p(b,c,e,a,f[g+3],22,-1044525330),a=p(a,b,c,e,f[g+4],7,-176418897),e=p(e,a,b,c,f[g+5],12,1200080426),c=p(c,e,a,b,f[g+6],17,-1473231341),b=p(b,c,e,a,f[g+7],22,-45705983),a=p(a,b,c,e,f[g+8],7,1770035416),e=p(e,a,b,c,f[g+9],12,-1958414417),c=p(c,e,a,b,f[g+10],17,-42063),b=p(b,c,e,a,f[g+11],22,-1990404162),a=p(a,b,c,e,f[g+12],7,1804603682),e=p(e,a,b,c,f[g+13],12,-40341101),c=p(c,e,a,b,f[g+14],17,-1502002290),b=p(b,c,e,a,f[g+15],22,1236535329),a=u(a,b,c,e,f[g+1],5,-165796510),e=u(e,a,b,c,f[g+6],9,-1069501632),c=u(c,e,a,b,f[g+11],14,643717713),b=u(b,c,e,a,f[g+0],20,-373897302),a=u(a,b,c,e,f[g+5],5,-701558691),e=u(e,a,b,c,f[g+10],9,38016083),c=u(c,e,a,b,f[g+15],14,-660478335),b=u(b,c,e,a,f[g+4],20,-405537848),a=u(a,b,c,e,f[g+9],5,568446438),e=u(e,a,b,c,f[g+14],9,-1019803690),c=u(c,e,a,b,f[g+3],14,-187363961),b=u(b,c,e,a,f[g+8],20,1163531501),a=u(a,b,c,e,f[g+13],5,-1444681467),e=u(e,a,b,c,f[g+2],9,-51403784),c=u(c,e,a,b,f[g+7],14,1735328473),b=u(b,c,e,a,f[g+12],20,-1926607734),a=y(b^c^e,a,b,f[g+5],4,-378558),e=y(a^b^c,e,a,f[g+8],11,-2022574463),c=y(e^a^b,c,e,f[g+11],16,1839030562),b=y(c^e^a,b,c,f[g+14],23,-35309556),a=y(b^c^e,a,b,f[g+1],4,-1530992060),e=y(a^b^c,e,a,f[g+4],11,1272893353),c=y(e^a^b,c,e,f[g+7],16,-155497632),b=y(c^e^a,b,c,f[g+10],23,-1094730640),a=y(b^c^e,a,b,f[g+13],4,681279174),e=y(a^b^c,e,a,f[g+0],11,-358537222),c=y(e^a^b,c,e,f[g+3],16,-722521979),b=y(c^e^a,b,c,f[g+6],23,76029189),a=y(b^c^e,a,b,f[g+9],4,-640364487),e=y(a^b^c,e,a,f[g+12],11,-421815835),c=y(e^a^b,c,e,f[g+15],16,530742520),b=y(c^e^a,b,c,f[g+2],23,-995338651),a=A(a,b,c,e,f[g+0],6,-198630844),e=A(e,a,b,c,f[g+7],10,1126891415),c=A(c,e,a,b,f[g+14],15,-1416354905),b=A(b,c,e,a,f[g+5],21,-57434055),a=A(a,b,c,e,f[g+12],6,1700485571),e=A(e,a,b,c,f[g+3],10,-1894986606),c=A(c,e,a,b,f[g+10],15,-1051523),b=A(b,c,e,a,f[g+1],21,-2054922799),a=A(a,b,c,e,f[g+8],6,1873313359),e=A(e,a,b,c,f[g+15],10,-30611744),c=A(c,e,a,b,f[g+6],15,-1560198380),b=A(b,c,e,a,f[g+13],21,1309151649),a=A(a,b,c,e,f[g+4],6,-145523070),e=A(e,a,b,c,f[g+11],10,-1120210379),c=A(c,e,a,b,f[g+2],15,718787259),b=A(b,c,e,a,f[g+9],21,-343485551),a=t(a,r),b=t(b,l),c=t(c,h),e=t(e,m);return[a,b,c,e]}function q(f){for(var d=0,a=[];d<8*f.length;d+=8)a[d>>5]|=(f.charCodeAt(d/8)&255)<<d%32;return a}function x(f,d){var a;a=0;var b=Array(16),c=Array(16),e=q(f);for(16<e.length&&(e=n(e,8*f.length));16>a;a++)b[a]=e[a]^909522486,c[a]=e[a]^1549556828;a=n(b.concat(q(d)),512+8*d.length);return n(c.concat(a),640)}function m(f){var d,a="";d=0;for(len=4*f.length;d<len;d++)a+="0123456789abcdef".charAt(f[d>>2]>>d%4*8+4&15)+"0123456789abcdef".charAt(f[d>>2]>>d%4*8&15);return a}function h(f){for(var d=0,a="";d<32*f.length;d+=8)a+=String.fromCharCode(f[d>>5]>>>d%32&255);return a}function l(f){for(var d,a,b=0,c="";b<4*f.length;b+=3)for(d=(f[b>>2]>>b%4*8&255)<<16|(f[b+1>>2]>>(b+1)%4*8&255)<<8|f[b+2>>2]>>(b+2)%4*8&255,a=0;4>a;a++)c=8*b+6*a>32*f.length?c+"\x3d":c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6*(3-a)&63);return c}return{hex:function(f){return m(n(q(f),8*f.length))},b64:function(f){return l(n(q(f),8*f.length))},str:function(f){return h(n(q(f),8*f.length))},hex_hmac:function(f,d){return m(x(f,d))},b64_hmac:function(f,d){return l(x(f,d))},str_hmac:function(f,d){return h(x(f,d))}}}();(function(t,y){"object"===typeof exports&&"undefined"!==typeof module?module.exports=y():"function"===typeof define&&define.amd?define(y):t.videojs=y()})(this,function(){function t(a,b){return b={exports:{}},a(b,b.exports),b.exports}function y(a,b){tc(a).forEach(function(c){return b(a[c],c)})}function p(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return tc(a).reduce(function(c,R){return b(c,a[R],R)},c)}function u(a){for(var b=arguments.length,c=Array(1<b?b-1:0),z=1;z<b;z++)c[z-1]=arguments[z];if(Object.assign)return Object.assign.apply(Object,[a].concat(c));c.forEach(function(b){b&&y(b,function(b,c){a[c]=b})});return a}function A(a){return!!a&&"object"===("undefined"===typeof a?"undefined":Sa(a))}function n(a){return A(a)&&"[object Object]"===Qd.call(a)&&a.constructor===Object}function q(a,b){if(!a||!b)return"";if("function"===typeof G.getComputedStyle){var c=G.getComputedStyle(a);return c?c[b]:""}return a.currentStyle[b]||""}function x(a){if(/\s/.test(a))throw Error("class has illegal whitespace characters");}function m(){return L===G.document&&"undefined"!==typeof L.createElement}function h(a){return A(a)&&1===a.nodeType}function l(){try{return G.parent!==G.self}catch(sc){return!0}}function f(a){return function(b,c){if("string"!==typeof b||!/\S/.test(b))return L[a](null);"string"===typeof c&&/\S/.test(c)&&(c=L.querySelector(c));var z=h(c)?c:L;return z[a]&&z[a](b)}}function d(){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},R=arguments[3],z=L.createElement(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"div");Object.getOwnPropertyNames(b).forEach(function(c){var R=b[c];-1!==c.indexOf("aria-")||"role"===c||"type"===c?(Z.warn(Hb(Rd,c,R)),z.setAttribute(c,R)):"textContent"===c?a(z,R):z[c]=R});Object.getOwnPropertyNames(c).forEach(function(a){z.setAttribute(a,c[a])});R&&ba(z,R);return z}function a(a,b){"undefined"===typeof a.textContent?a.innerText=b:a.textContent=b;return a}function b(a,b){b.firstChild?b.insertBefore(a,b.firstChild):b.appendChild(a)}function c(a,b){x(b);return a.classList?a.classList.contains(b):(new RegExp("(^|\\s)"+b+"($|\\s)")).test(a.className)}function e(a,b){a.classList?a.classList.add(b):c(a,b)||(a.className=(a.className+" "+b).trim());return a}function g(a,b){a.classList?a.classList.remove(b):(x(b),a.className=a.className.split(/\s+/).filter(function(a){return a!==b}).join(" "));return a}function r(a,b,R){var z=c(a,b);"function"===typeof R&&(R=R(a,b));"boolean"!==typeof R&&(R=!z);if(R!==z)return R?e(a,b):g(a,b),a}function E(a,b){Object.getOwnPropertyNames(b).forEach(function(c){var z=b[c];null===z||"undefined"===typeof z||!1===z?a.removeAttribute(c):a.setAttribute(c,!0===z?"":z)})}function C(a){var b={};if(a&&a.attributes&&0<a.attributes.length)for(var c=a.attributes,z=c.length-1;0<=z;z--){var d=c[z].name,e=c[z].value;if("boolean"===typeof a[d]||-1!==",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+d+","))e=null!==e?!0:!1;b[d]=e}return b}function v(){L.body.focus();L.onselectstart=function(){return!1}}function D(){L.onselectstart=function(){return!0}}function B(a){if(a&&a.getBoundingClientRect&&a.parentNode){var b=a.getBoundingClientRect(),c={};"bottom height left right top width".split(" ").forEach(function(a){void 0!==b[a]&&(c[a]=b[a])});c.height||(c.height=parseFloat(q(a,"height")));c.width||(c.width=parseFloat(q(a,"width")));return c}}function F(a){var b=void 0;a.getBoundingClientRect&&a.parentNode&&(b=a.getBoundingClientRect());if(!b)return{left:0,top:0};a=L.documentElement;var c=L.body;return{left:Math.round(b.left+(G.pageXOffset||c.scrollLeft)-(a.clientLeft||c.clientLeft||0)),top:Math.round(b.top+(G.pageYOffset||c.scrollTop)-(a.clientTop||c.clientTop||0))}}function S(a,b){var c={},z=F(a),d=a.offsetWidth,e=a.offsetHeight,g=z.top,z=z.left,fa=b.pageY,f=b.pageX;b.changedTouches&&(f=b.changedTouches[0].pageX,fa=b.changedTouches[0].pageY);c.y=Math.max(0,Math.min(1,(g-fa+e)/e));c.x=Math.max(0,Math.min(1,(f-z)/d));return c}function aa(a){return A(a)&&3===a.nodeType}function Q(a){for(;a.firstChild;)a.removeChild(a.firstChild);return a}function H(a){"function"===typeof a&&(a=a());return(Array.isArray(a)?a:[a]).map(function(a){"function"===typeof a&&(a=a());if(h(a)||aa(a))return a;if("string"===typeof a&&/\S/.test(a))return L.createTextNode(a)}).filter(function(a){return a})}function ba(a,b){H(b).forEach(function(b){return a.appendChild(b)});return a}function T(a,b){return ba(Q(a),b)}function W(a){return void 0===a.button&&void 0===a.buttons||0===a.button&&void 0===a.buttons||9===Ga?!0:0!==a.button||1!==a.buttons?!1:!0}function J(a){var b=a[Ia];b||(b=a[Ia]=Ja++);cb[b]||(cb[b]={});return cb[b]}function V(a){return(a=a[Ia])?!!Object.getOwnPropertyNames(cb[a]).length:!1}function ca(a){var b=a[Ia];if(b){delete cb[b];try{delete a[Ia]}catch(R){a.removeAttribute?a.removeAttribute(Ia):a[Ia]=null}}}function X(a,b){var c=J(a);0===c.handlers[b].length&&(delete c.handlers[b],a.removeEventListener?a.removeEventListener(b,c.dispatcher,!1):a.detachEvent&&a.detachEvent("on"+b,c.dispatcher));0>=Object.getOwnPropertyNames(c.handlers).length&&(delete c.handlers,delete c.dispatcher,delete c.disabled);0===Object.getOwnPropertyNames(c).length&&ca(a)}function da(a,b,c,z){c.forEach(function(c){a(b,c,z)})}function U(a){function b(){return!0}function c(){return!1}if(!a||!a.isPropagationStopped){var z=a||G.event;a={};for(var d in z)"layerX"!==d&&"layerY"!==d&&"keyLocation"!==d&&"webkitMovementX"!==d&&"webkitMovementY"!==d&&("returnValue"===d&&z.preventDefault||(a[d]=z[d]));a.target||(a.target=a.srcElement||L);a.relatedTarget||(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);a.preventDefault=function(){z.preventDefault&&z.preventDefault();a.returnValue=!1;z.returnValue=!1;a.defaultPrevented=!0};a.defaultPrevented=!1;a.stopPropagation=function(){z.stopPropagation&&z.stopPropagation();a.cancelBubble=!0;z.cancelBubble=!0;a.isPropagationStopped=b};a.isPropagationStopped=c;a.stopImmediatePropagation=function(){z.stopImmediatePropagation&&z.stopImmediatePropagation();a.isImmediatePropagationStopped=b;a.stopPropagation()};a.isImmediatePropagationStopped=c;if(null!==a.clientX&&void 0!==a.clientX){d=L.documentElement;var e=L.body;a.pageX=a.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0);a.pageY=a.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)}a.which=a.charCode||a.keyCode;null!==a.button&&void 0!==a.button&&(a.button=a.button&1?0:a.button&4?1:a.button&2?2:0)}return a}function ia(a,b,c){if(Array.isArray(b))return da(ia,a,b,c);var z=J(a);z.handlers||(z.handlers={});z.handlers[b]||(z.handlers[b]=[]);c.guid||(c.guid=Ja++);z.handlers[b].push(c);z.dispatcher||(z.disabled=!1,z.dispatcher=function(b,c){if(!z.disabled){b=U(b);var d=z.handlers[b.type];if(d)for(var d=d.slice(0),R=0,e=d.length;R<e&&!b.isImmediatePropagationStopped();R++)try{d[R].call(a,b,c)}catch(Ka){Z.error(Ka)}}});1===z.handlers[b].length&&(a.addEventListener?(c=!1,uc&&-1<Sd.indexOf(b)&&(c={passive:!0}),a.addEventListener(b,z.dispatcher,c)):a.attachEvent&&a.attachEvent("on"+b,z.dispatcher))}function na(a,b,c){if(V(a)){var z=J(a);if(z.handlers){if(Array.isArray(b))return da(na,a,b,c);if(void 0===b)for(var d in z.handlers)Object.prototype.hasOwnProperty.call(z.handlers||{},d)&&(b=a,c=d,z.handlers[c]=[],X(b,c));else if(d=z.handlers[b]){if(!c)z.handlers[b]=[];else if(c.guid)for(z=0;z<d.length;z++)d[z].guid===c.guid&&d.splice(z--,1);X(a,b)}}}}function sa(a,b,c){var z=V(a)?J(a):{},d=a.parentNode||a.ownerDocument;"string"===typeof b&&(b={type:b,target:a});b=U(b);z.dispatcher&&z.dispatcher.call(a,b,c);if(d&&!b.isPropagationStopped()&&!0===b.bubbles)sa.call(null,d,b,c);else if(!d&&!b.defaultPrevented&&(a=J(b.target),b.target[b.type])){a.disabled=!0;if("function"===typeof b.target[b.type])b.target[b.type]();a.disabled=!1}return!b.defaultPrevented}function Ea(a,b,c){if(Array.isArray(b))return da(Ea,a,b,c);var z=function ea(){na(a,b,ea);c.apply(this,arguments)};z.guid=c.guid=c.guid||Ja++;ia(a,b,z)}function Qa(a,b){b&&(vc=b);G.setTimeout(Td,a)}function Ra(a){var b=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).eventBusKey;if(b){if(!a[b].nodeName)throw Error('The eventBusKey "'+b+'" does not refer to an element.');a.eventBusEl_=a[b]}else a.eventBusEl_=d("span",{className:"vjs-event-bus"});u(a,Ud);a.on("dispose",function(){a.off();G.setTimeout(function(){a.eventBusEl_=null},0)});return a}function bb(a,b){u(a,Vd);a.state=u({},a.state,b);if("function"===typeof a.handleStateChanged&&ob(a))a.on("statechanged",a.handleStateChanged);return a}function ga(a){return"string"!==typeof a?a:a.charAt(0).toUpperCase()+a.slice(1)}function Pd(a,b){return ga(a)===ga(b)}function ja(){for(var a={},b=arguments.length,c=Array(b),z=0;z<b;z++)c[z]=arguments[z];c.forEach(function(b){b&&y(b,function(b,c){n(b)?(n(a[c])||(a[c]={}),a[c]=ja(a[c],b)):a[c]=b})});return a}function wc(a,b,c,z){var d=c.length-1;if("number"!==typeof z||0>z||z>d)throw Error("Failed to execute '"+a+"' on 'TimeRanges': The index provided ("+z+") is non-numeric or out of bounds (0-"+d+").");return c[z][b]}function Ib(a){return void 0===a||0===a.length?{length:0,start:function(){throw Error("This TimeRanges object is empty");},end:function(){throw Error("This TimeRanges object is empty");}}:{length:a.length,start:wc.bind(null,"start",0,a),end:wc.bind(null,"end",1,a)}}function La(a,b){return Array.isArray(a)?Ib(a):void 0===a||void 0===b?Ib():Ib([[a,b]])}function xc(a,b){var c=0,z,d;if(!b)return 0;a&&a.length||(a=La(0,0));for(var e=0;e<a.length;e++)z=a.start(e),d=a.end(e),d>b&&(d=b),c+=d-z;return c/b}function oa(a){if(a instanceof oa)return a;"number"===typeof a?this.code=a:"string"===typeof a?this.message=a:A(a)&&("number"===typeof a.code&&(this.code=a.code),u(this,a));this.message||(this.message=oa.defaultMessages[this.code]||"")}function Jb(a){void 0!==a&&"function"===typeof a.then&&a.then(null,function(a){})}function Wd(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function yc(a,b,c){var z=a;zc(b)?(c=b,"string"===typeof a&&(z={uri:a})):z=Xd(b,{uri:a});z.callback=c;return z}function za(a,b,c){b=yc(a,b,c);return Ac(b)}function Ac(a){function b(b){clearTimeout(C);b instanceof Error||(b=Error(""+(b||"Unknown XMLHttpRequest Error")));b.statusCode=0;var c=D;z||(z=!0,a.callback(b,c,void 0))}function c(){if(!g){var b;clearTimeout(C);b=a.useXDR&&void 0===d.status?200:1223===d.status?204:d.status;var c=D,e=null;if(0!==b){d.response?c=d.response:(c=d.responseText)||("document"===d.responseType?c=d.responseXML:(c=d.responseXML&&"parsererror"===d.responseXML.documentElement.nodeName,c=""!==d.responseType||c?null:d.responseXML));if(v)try{c=JSON.parse(c)}catch(bf){}c={body:c,statusCode:b,method:r,headers:{},url:f,rawRequest:d};d.getAllResponseHeaders&&(c.headers=Yd(d.getAllResponseHeaders()))}else e=Error("Internal XMLHttpRequest Error");b=c.body;z||(z=!0,a.callback(e,c,b))}}if("undefined"===typeof a.callback)throw Error("callback argument missing");var z=!1,d=a.xhr||null;d||(d=a.cors||a.useXDR?new za.XDomainRequest:new za.XMLHttpRequest);var e,g,f=d.url=a.uri||a.url,r=d.method=a.method||"GET",l=a.body||a.data,h=d.headers=a.headers||{},m=!!a.sync,v=!1,C,D={body:void 0,headers:{},statusCode:0,method:r,url:f,rawRequest:d};"json"in a&&!1!==a.json&&(v=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==r&&"HEAD"!==r&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),l=JSON.stringify(!0===a.json?l:a.json)));d.onreadystatechange=function(){4===d.readyState&&setTimeout(c,0)};d.onload=c;d.onerror=b;d.onprogress=function(){};d.onabort=function(){g=!0};d.ontimeout=b;d.open(r,f,!m,a.username,a.password);m||(d.withCredentials=!!a.withCredentials);!m&&0<a.timeout&&(C=setTimeout(function(){if(!g){g=!0;d.abort("timeout");var a=Error("XMLHttpRequest timeout");a.code="ETIMEDOUT";b(a)}},a.timeout));if(d.setRequestHeader)for(e in h)h.hasOwnProperty(e)&&d.setRequestHeader(e,h[e]);else if(a.headers&&!Wd(a.headers))throw Error("Headers cannot be set on an XDomainRequest object");"responseType"in a&&(d.responseType=a.responseType);"beforeSend"in a&&"function"===typeof a.beforeSend&&a.beforeSend(d);d.send(l||null);return d}function Zd(){}function ta(a,b){this.name="ParsingError";this.code=a.code;this.message=b||a.message}function Kb(a){a=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!a)return null;if(a[3]){var b=a[3].replace(":","");return 3600*(a[1]|0)+60*(a[2]|0)+(b|0)+(a[4]|0)/1E3}return 59<a[1]?3600*(a[1]|0)+60*(a[2]|0)+0+(a[4]|0)/1E3:0+60*(a[1]|0)+(a[2]|0)+(a[4]|0)/1E3}function db(){this.values=Lb(null)}function eb(a,b,c,z){a=z?a.split(z):[a];for(var d in a)"string"===typeof a[d]&&(z=a[d].split(c),2===z.length&&b(z[0],z[1]))}function $d(a,b,c){function z(){var b=Kb(a);if(null===b)throw new ta(ta.Errors.BadTimeStamp,"Malformed timestamp: "+e);a=a.replace(/^[^\sa-zA-Z-]+/,"");return b}function d(){a=a.replace(/^\s+/,"")}var e=a;d();b.startTime=z();d();if("--\x3e"!==a.substr(0,3))throw new ta(ta.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+e);a=a.substr(3);d();b.endTime=z();d();(function(a,b){var z=new db;eb(a,function(a,b){switch(a){case "region":for(var d=c.length-1;0<=d;d--)if(c[d].id===b){z.set(a,c[d].region);break}break;case "vertical":z.alt(a,b,["rl","lr"]);break;case "line":var d=b.split(","),e=d[0];z.integer(a,e);z.percent(a,e)?z.set("snapToLines",!1):null;z.alt(a,e,["auto"]);2===d.length&&z.alt("lineAlign",d[1],["start","middle","end"]);break;case "position":d=b.split(",");z.percent(a,d[0]);2===d.length&&z.alt("positionAlign",d[1],["start","middle","end"]);break;case "size":z.percent(a,b);break;case "align":z.alt(a,b,["start","middle","end","left","right"])}},/:/,/\s/);b.region=z.get("region",null);b.vertical=z.get("vertical","");b.line=z.get("line","auto");b.lineAlign=z.get("lineAlign","start");b.snapToLines=z.get("snapToLines",!0);b.size=z.get("size",100);b.align=z.get("align","middle");b.position=z.get("position",{start:0,left:0,middle:50,end:100,right:100},b.align);b.positionAlign=z.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},b.align)})(a,b)}function Bc(a,b){function c(){if(!b)return null;var a=b.match(/^([^<]*)(<[^>]+>?)?/),a=a[1]?a[1]:a[2];b=b.substr(a.length);return a}function z(a){return ae[a]}function d(a){for(;h=a.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)a=a.replace(h[0],z);return a}function e(b,c){var z=be[b];if(!z)return null;var d=a.document.createElement(z);d.localName=z;(z=ce[b])&&c&&(d[z]=c.trim());return d}for(var g=a.document.createElement("div"),f=g,fa,r=[];null!==(fa=c());)if("\x3c"===fa[0])if("/"===fa[1])r.length&&r[r.length-1]===fa.substr(2).replace("\x3e","")&&(r.pop(),f=f.parentNode);else{var l=Kb(fa.substr(1,fa.length-2));if(l)fa=a.document.createProcessingInstruction("timestamp",l),f.appendChild(fa);else{var h=fa.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);h&&(!(fa=e(h[1],h[3]))||Cc[fa.localName]&&Cc[fa.localName]!==f.localName||(h[2]&&(fa.className=h[2].substr(1).replace("."," ")),r.push(h[1]),f.appendChild(fa),f=fa))}}else f.appendChild(a.document.createTextNode(d(fa)));return g}function de(a){for(var b=0;b<Dc.length;b++){var c=Dc[b];if(a>=c[0]&&a<=c[1])return!0}return!1}function ee(a){function b(a,b){for(var c=b.childNodes.length-1;0<=c;c--)a.push(b.childNodes[c])}function c(a){if(!a||!a.length)return null;var z=a.pop(),d=z.textContent||z.innerText;if(d)return(z=d.match(/^.*(\n|\r)/))?(a.length=0,z[0]):d;if("ruby"===z.tagName)return c(a);if(z.childNodes)return b(a,z),c(a)}var z=[],d="";if(!a||!a.childNodes)return"ltr";for(b(z,a);d=c(z);)for(var e=0;e<d.length;e++)if(a=d.charCodeAt(e),de(a))return"rtl";return"ltr"}function Mb(){}function pb(a,b,c){var z=/MSIE\s8\.0/.test(navigator.userAgent),d="rgba(255, 255, 255, 1)",e="rgba(0, 0, 0, 0.8)";z&&(d="rgb(255, 255, 255)",e="rgb(0, 0, 0)");this.cue=b;this.cueDiv=Bc(a,b.text);d={color:d,backgroundColor:e,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};z||(d.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl",d.unicodeBidi="plaintext");this.applyStyles(d,this.cueDiv);this.div=a.document.createElement("div");d={textAlign:"middle"===b.align?"center":b.align,font:c.font,whiteSpace:"pre-line",position:"absolute"};z||(d.direction=ee(this.cueDiv),d.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext");this.applyStyles(d);this.div.appendChild(this.cueDiv);a=0;switch(b.positionAlign){case "start":a=b.position;break;case "middle":a=b.position-b.size/2;break;case "end":a=b.position-b.size}""===b.vertical?this.applyStyles({left:this.formatStyle(a,"%"),width:this.formatStyle(b.size,"%")}):this.applyStyles({top:this.formatStyle(a,"%"),height:this.formatStyle(b.size,"%")});this.move=function(a){this.applyStyles({top:this.formatStyle(a.top,"px"),bottom:this.formatStyle(a.bottom,"px"),left:this.formatStyle(a.left,"px"),right:this.formatStyle(a.right,"px"),height:this.formatStyle(a.height,"px"),width:this.formatStyle(a.width,"px")})}}function pa(a){var b=/MSIE\s8\.0/.test(navigator.userAgent),c,z,d,e;if(a.div){z=a.div.offsetHeight;d=a.div.offsetWidth;e=a.div.offsetTop;var g=(g=a.div.childNodes)&&(g=g[0])&&g.getClientRects&&g.getClientRects();a=a.div.getBoundingClientRect();c=g?Math.max(g[0]&&g[0].height||0,a.height/g.length):0}this.left=a.left;this.right=a.right;this.top=a.top||e;this.height=a.height||z;this.bottom=a.bottom||e+(a.height||z);this.width=a.width||d;this.lineHeight=void 0!==c?c:a.lineHeight;b&&!this.lineHeight&&(this.lineHeight=13)}function Ua(){}function Nb(a){return"string"!==typeof a?!1:fe[a.toLowerCase()]?a.toLowerCase():!1}function ra(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],z;for(z in c)a[z]=c[z]}return a}function Ec(a,b,c){var z=this,d=/MSIE\s8\.0/.test(navigator.userAgent),e={};d?z=document.createElement("custom"):e.enumerable=!0;z.hasBeenReset=!1;var R="",g=!1,f=a,fa=b,r=c,l=null,h="",m=!0,v="auto",C="start",D=50,E="middle",B=50,H="middle";Object.defineProperty(z,"id",ra({},e,{get:function(){return R},set:function(a){R=""+a}}));Object.defineProperty(z,"pauseOnExit",ra({},e,{get:function(){return g},set:function(a){g=!!a}}));Object.defineProperty(z,"startTime",ra({},e,{get:function(){return f},set:function(a){if("number"!==typeof a)throw new TypeError("Start time must be set to a number.");f=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"endTime",ra({},e,{get:function(){return fa},set:function(a){if("number"!==typeof a)throw new TypeError("End time must be set to a number.");fa=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"text",ra({},e,{get:function(){return r},set:function(a){r=""+a;this.hasBeenReset=!0}}));Object.defineProperty(z,"region",ra({},e,{get:function(){return l},set:function(a){l=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"vertical",ra({},e,{get:function(){return h},set:function(a){a="string"!==typeof a?!1:ge[a.toLowerCase()]?a.toLowerCase():!1;if(!1===a)throw new SyntaxError("An invalid or illegal string was specified.");h=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"snapToLines",ra({},e,{get:function(){return m},set:function(a){m=!!a;this.hasBeenReset=!0}}));Object.defineProperty(z,"line",ra({},e,{get:function(){return v},set:function(a){if("number"!==typeof a&&"auto"!==a)throw new SyntaxError("An invalid number or illegal string was specified.");v=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"lineAlign",ra({},e,{get:function(){return C},set:function(a){a=Nb(a);if(!a)throw new SyntaxError("An invalid or illegal string was specified.");C=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"position",ra({},e,{get:function(){return D},set:function(a){if(0>a||100<a)throw Error("Position must be between 0 and 100.");D=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"positionAlign",ra({},e,{get:function(){return E},set:function(a){a=Nb(a);if(!a)throw new SyntaxError("An invalid or illegal string was specified.");E=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"size",ra({},e,{get:function(){return B},set:function(a){if(0>a||100<a)throw Error("Size must be between 0 and 100.");B=a;this.hasBeenReset=!0}}));Object.defineProperty(z,"align",ra({},e,{get:function(){return H},set:function(a){a=Nb(a);if(!a)throw new SyntaxError("An invalid or illegal string was specified.");H=a;this.hasBeenReset=!0}}));z.displayState=void 0;if(d)return z}function fb(a){return"number"===typeof a&&0<=a&&100>=a}function he(a,b,c,z){var d=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},e=a.textTracks();d.kind=b;c&&(d.label=c);z&&(d.language=z);d.tech=a;d=new ua.text.TrackClass(d);e.addTrack(d);return d}function ie(a,b,c){a.setTimeout(function(){return Va(b,Ma[b.type],c,a)},1)}function je(a,b){a.forEach(function(a){return a.setTech&&a.setTech(b)})}function Fc(a){return function(b,c){return c[a]?c[a](b):b}}function Va(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],c=arguments[2],z=arguments[3],d=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[],e=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!1,g=b[0],f=b.slice(1);if("string"===typeof g)Va(a,Ma[g],c,z,d,e);else if(g){var r=g(z);r.setSource(u({},a),function(b,g){if(b)return Va(a,f,c,z,d,e);d.push(r);Va(g,a.type===g.type?f:Ma[g.type],c,z,d,e)})}else f.length?Va(a,f,c,z,d,e):e?c(a,d):Va(a,Ma["*"],c,z,d,!0)}function Ob(a,b){return"rgba("+parseInt(a[1]+a[1],16)+","+parseInt(a[2]+a[2],16)+","+parseInt(a[3]+a[3],16)+","+b+")"}function Wa(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a;a=0>a?0:a;var c=Math.floor(a%60),z=Math.floor(a/60%60),d=Math.floor(a/3600),e=Math.floor(b/60%60),b=Math.floor(b/3600);if(isNaN(a)||Infinity===a)d=z=c="-";d=0<d||0<b?d+":":"";return d+(((d||10<=e)&&10>z?"0"+z:z)+":")+(10>c?"0"+c:c)}function Gc(a,b){b&&(a=b(a));if(a&&"none"!==a)return a}function P(a,b,c){var z=void 0;if("string"===typeof a){var d=P.getPlayers();0===a.indexOf("#")&&(a=a.slice(1));if(d[a])return b&&Z.warn('Player "'+a+'" is already initialised. Options will not be applied.'),c&&d[a].ready(c),d[a];z=Na("#"+a)}else z=a;if(!z||!z.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");if(z.player||ka.players[z.playerId])return z.player||ka.players[z.playerId];h(z)&&!L.body.contains(z)&&Z.warn("The element supplied is not included in the DOM");b=b||{};P.hooks("beforesetup").forEach(function(a){a=a(z,ja(b));!A(a)||Array.isArray(a)?Z.error("please return an object in beforesetup hooks"):b=ja(b,a)});var e=new (I.getComponent("Player"))(z,b,c);P.hooks("setup").forEach(function(a){return a(e)});return e}var qb="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},G="undefined"!==typeof window?window:"undefined"!==typeof qb?qb:"undefined"!==typeof self?self:{},Hc={},Ic=(Object.freeze||Object)({"default":Hc}),ke=Ic&&Hc||Ic,Jc="undefined"!==typeof qb?qb:"undefined"!==typeof window?window:{},rb;"undefined"!==typeof document?rb=document:(rb=Jc["__GLOBAL_DOCUMENT_CACHE@4"])||(rb=Jc["__GLOBAL_DOCUMENT_CACHE@4"]=ke);var L=rb,la=G.navigator&&G.navigator.userAgent||"",Kc=/AppleWebKit\/([\d.]+)/i.exec(la),le=Kc?parseFloat(Kc.pop()):null,Pb=/iPad/i.test(la),Qb=/iPhone/i.test(la)&&!Pb,Lc=/iPod/i.test(la),Oa=Qb||Pb||Lc,me=function(){var a=la.match(/OS (\d+)_/i);return a&&a[1]?a[1]:null}(),Aa=/Android/i.test(la),sb=function(){var a=la.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!a)return null;var b=a[1]&&parseFloat(a[1]),c=a[2]&&parseFloat(a[2]);return b&&c?parseFloat(a[1]+"."+a[2]):b?b:null}(),Mc=Aa&&/webkit/i.test(la)&&2.3>sb,Nc=Aa&&5>sb&&537>le,Oc=/Firefox/i.test(la),Rb=/Edge/i.test(la),gb=!Rb&&/Chrome/i.test(la),Pc=function(){var a=la.match(/Chrome\/(\d+)/);return a&&a[1]?parseFloat(a[1]):null}(),qa=/MSIE\s8\.0/.test(la),Ga=function(){var a=/MSIE\s(\d+)\.\d/.exec(la),a=a&&parseFloat(a[1]);!a&&/Trident\/7.0/i.test(la)&&/rv:11.0/.test(la)&&(a=11);return a}(),Qc=/Safari/i.test(la)&&!gb&&!Aa&&!Rb,Rc=Qc||Oa,tb=m()&&("ontouchstart"in G||G.DocumentTouch&&G.document instanceof G.DocumentTouch),Sc=m()&&"backgroundSize"in G.document.createElement("video").style,ne=(Object.freeze||Object)({IS_IPAD:Pb,IS_IPHONE:Qb,IS_IPOD:Lc,IS_IOS:Oa,IOS_VERSION:me,IS_ANDROID:Aa,ANDROID_VERSION:sb,IS_OLD_ANDROID:Mc,IS_NATIVE_ANDROID:Nc,IS_FIREFOX:Oc,IS_EDGE:Rb,IS_CHROME:gb,CHROME_VERSION:Pc,IS_IE8:qa,IE_VERSION:Ga,IS_SAFARI:Qc,IS_ANY_SAFARI:Rc,TOUCH_ENABLED:tb,BACKGROUND_SIZE_SUPPORTED:Sc}),Sa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},M=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");},O=function(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},K=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b},Sb=function(a,b){a.raw=b;return a},Qd=Object.prototype.toString,tc=function(a){return A(a)?Object.keys(a):[]},va=void 0,ub="info",ya=[],vb=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!!Ga&&11>Ga,z=va.levels[ub],d=new RegExp("^("+z+")$");"log"!==a&&b.unshift(a.toUpperCase()+":");ya&&ya.push([].concat(b));b.unshift("VIDEOJS:");if(G.console){var e=G.console[a];e||"debug"!==a||(e=G.console.info||G.console.log);if(e&&z&&d.test(a))if(c&&(b=b.map(function(a){if(A(a)||Array.isArray(a))try{return JSON.stringify(a)}catch(af){}return String(a)}).join(" ")),e.apply)e[Array.isArray(b)?"apply":"call"](G.console,b);else e(b)}},va=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];vb("log",b)};va.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:ub};va.level=function(a){if("string"===typeof a){if(!va.levels.hasOwnProperty(a))throw Error('"'+a+'" in not a valid log level');ub=a}return ub};va.history=function(){return ya?[].concat(ya):[]};va.history.clear=function(){ya&&(ya.length=0)};va.history.disable=function(){null!==ya&&(ya.length=0,ya=null)};va.history.enable=function(){null===ya&&(ya=[])};va.error=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return vb("error",b)};va.warn=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return vb("warn",b)};va.debug=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return vb("debug",b)};var Z=va,Hb=function(a){for(var b="",c=0;c<arguments.length;c++)b+=a[c].replace(/\n\r?\s*/g,"")+(arguments[c+1]||"");return b},Rd=Sb(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]),Na=f("querySelector"),Tc=f("querySelectorAll"),Uc=(Object.freeze||Object)({isReal:m,isEl:h,isInFrame:l,createEl:d,textContent:a,prependTo:b,hasClass:c,addClass:e,removeClass:g,toggleClass:r,setAttributes:E,getAttributes:C,getAttribute:function(a,b){return a.getAttribute(b)},setAttribute:function(a,b,c){a.setAttribute(b,c)},removeAttribute:function(a,b){a.removeAttribute(b)},blockTextSelection:v,unblockTextSelection:D,getBoundingClientRect:B,findPosition:F,getPointerPosition:S,isTextNode:aa,emptyEl:Q,normalizeContent:H,appendContent:ba,insertContent:T,isSingleLeftClick:W,$:Na,$$:Tc}),Ja=1,cb={},Ia="vdata"+(new Date).getTime(),uc=!1;(function(){try{var a=Object.defineProperty({},"passive",{get:function(){uc=!0}});G.addEventListener("test",null,a);G.removeEventListener("test",null,a)}catch(fa){}})();var Sd=["touchstart","touchmove"],oe=(Object.freeze||Object)({fixEvent:U,on:ia,off:na,trigger:sa,one:Ea}),Tb=!1,vc=void 0,Td=function(){if(m()){var a=L.getElementsByTagName("video"),b=L.getElementsByTagName("audio"),c=L.getElementsByTagName("video-js"),z=[];if(a&&0<a.length)for(var d=0,e=a.length;d<e;d++)z.push(a[d]);if(b&&0<b.length)for(a=0,d=b.length;a<d;a++)z.push(b[a]);if(c&&0<c.length)for(b=0,a=c.length;b<a;b++)z.push(c[b]);if(z&&0<z.length)for(c=0,b=z.length;c<b;c++)if((a=z[c])&&a.getAttribute)void 0===a.player&&null!==a.getAttribute("data-setup")&&vc(a);else{Qa(1);break}else Tb||Qa(1)}};m()&&"complete"===L.readyState?Tb=!0:Ea(G,"load",function(){Tb=!0});var Vc=function(a){var b=L.createElement("style");b.className=a;return b},Wc=function(a,b){a.styleSheet?a.styleSheet.cssText=b:a.textContent=b},Y=function(a,b,c){b.guid||(b.guid=Ja++);var z=function(){return b.apply(a,arguments)};z.guid=c?c+"_"+b.guid:b.guid;return z},Xa=function(a,b){var c=Date.now();return function(){var z=Date.now();z-c>=b&&(a.apply(void 0,arguments),c=z)}},ma=function(){};ma.prototype.allowedEvents_={};ma.prototype.on=function(a,b){var c=this.addEventListener;this.addEventListener=function(){};ia(this,a,b);this.addEventListener=c};ma.prototype.addEventListener=ma.prototype.on;ma.prototype.off=function(a,b){na(this,a,b)};ma.prototype.removeEventListener=ma.prototype.off;ma.prototype.one=function(a,b){var c=this.addEventListener;this.addEventListener=function(){};Ea(this,a,b);this.addEventListener=c};ma.prototype.trigger=function(a){var b=a.type||a;"string"===typeof a&&(a={type:b});a=U(a);if(this.allowedEvents_[b]&&this["on"+b])this["on"+b](a);sa(this,a)};ma.prototype.dispatchEvent=ma.prototype.trigger;var ob=function(a){return a instanceof ma||!!a.eventBusEl_&&["on","one","off","trigger"].every(function(b){return"function"===typeof a[b]})},Xc=function(a){return"string"===typeof a&&/\S/.test(a)||Array.isArray(a)&&!!a.length},Ub=function(a){if(!a.nodeName&&!ob(a))throw Error("Invalid target; must be a DOM node or evented object.");},Yc=function(a){if(!Xc(a))throw Error("Invalid event type; must be a non-empty string or array.");},Zc=function(a){if("function"!==typeof a)throw Error("Invalid listener; must be a function.");},$c=function(a,b){var c=3>b.length||b[0]===a||b[0]===a.eventBusEl_,z,d,e;c?(z=a.eventBusEl_,3<=b.length&&b.shift(),d=b[0],e=b[1]):(z=b[0],d=b[1],e=b[2]);Ub(z);Yc(d);Zc(e);e=Y(a,e);return{isTargetingSelf:c,target:z,type:d,listener:e}},hb=function(a,b,c,z){Ub(a);if(a.nodeName)oe[b](a,c,z);else a[b](c,z)},Ud={on:function(){for(var a=this,b=arguments.length,c=Array(b),z=0;z<b;z++)c[z]=arguments[z];var b=$c(this,c),c=b.isTargetingSelf,d=b.target,e=b.type,g=b.listener;hb(d,"on",e,g);if(!c){var f=function(){return a.off(d,e,g)};f.guid=g.guid;b=function(){return a.off("dispose",f)};b.guid=g.guid;hb(this,"on","dispose",f);hb(d,"on","dispose",b)}},one:function(){for(var a=this,b=arguments.length,c=Array(b),z=0;z<b;z++)c[z]=arguments[z];var b=$c(this,c),d=b.target,e=b.type,g=b.listener;b.isTargetingSelf?hb(d,"one",e,g):(b=function Ta(){for(var b=arguments.length,c=Array(b),z=0;z<b;z++)c[z]=arguments[z];a.off(d,e,Ta);g.apply(null,c)},b.guid=g.guid,hb(d,"one",e,b))},off:function(a,b,c){!a||Xc(a)?na(this.eventBusEl_,a,b):(Ub(a),Yc(b),Zc(c),c=Y(this,c),this.off("dispose",c),a.nodeName?(na(a,b,c),na(a,"dispose",c)):ob(a)&&(a.off(b,c),a.off("dispose",c)))},trigger:function(a,b){return sa(this.eventBusEl_,a,b)}},Vd={state:{},setState:function(a){var b=this;"function"===typeof a&&(a=a());var c=void 0;y(a,function(a,d){b.state[d]!==a&&(c=c||{},c[d]={from:b.state[d],to:a});b.state[d]=a});c&&ob(this)&&this.trigger({changes:c,type:"statechanged"});return c}},I=function(){function a(b,c,z){M(this,a);this.player_=!b&&this.play?b=this:b;this.options_=ja({},this.options_);c=this.options_=ja(this.options_,c);this.id_=c.id||c.el&&c.el.id;this.id_||(this.id_=(b&&b.id&&b.id()||"no_player")+"_component_"+Ja++);this.name_=c.name||null;c.el?this.el_=c.el:!1!==c.createEl&&(this.el_=this.createEl());!1!==c.evented&&Ra(this,{eventBusKey:this.el_?"el_":null});bb(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};!1!==c.initChildren&&this.initChildren();this.ready(z);!1!==c.reportTouchActivity&&this.enableTouchActivity()}a.prototype.dispose=function(){this.trigger({type:"dispose",bubbles:!1});if(this.children_)for(var a=this.children_.length-1;0<=a;a--)this.children_[a].dispose&&this.children_[a].dispose();this.childNameIndex_=this.childIndex_=this.children_=null;this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),ca(this.el_),this.el_=null);this.player_=null};a.prototype.player=function(){return this.player_};a.prototype.options=function(a){Z.warn("this.options() has been deprecated and will be moved to the constructor in 6.0");return a?this.options_=ja(this.options_,a):this.options_};a.prototype.el=function(){return this.el_};a.prototype.createEl=function(a,b,c){return d(a,b,c)};a.prototype.localize=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a,d=this.player_.language&&this.player_.language(),e=this.player_.languages&&this.player_.languages(),g=e&&e[d],d=d&&d.split("-")[0],e=e&&e[d];g&&g[a]?c=g[a]:e&&e[a]&&(c=e[a]);b&&(c=c.replace(/\{(\d+)\}/g,function(a,c){var z=b[c-1],d=z;"undefined"===typeof z&&(d=a);return d}));return c};a.prototype.contentEl=function(){return this.contentEl_||this.el_};a.prototype.id=function(){return this.id_};a.prototype.name=function(){return this.name_};a.prototype.children=function(){return this.children_};a.prototype.getChildById=function(a){return this.childIndex_[a]};a.prototype.getChild=function(a){if(a)return a=ga(a),this.childNameIndex_[a]};a.prototype.addChild=function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},z=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.children_.length,d=void 0;if("string"===typeof b){var d=ga(b),e=c.componentClass||d;c.name=d;var g=a.getComponent(e);if(!g)throw Error("Component "+e+" does not exist");if("function"!==typeof g)return null;c=new g(this.player_||this,c)}else c=b;this.children_.splice(z,0,c);"function"===typeof c.id&&(this.childIndex_[c.id()]=c);(d=d||c.name&&ga(c.name()))&&(this.childNameIndex_[d]=c);"function"===typeof c.el&&c.el()&&(z=this.contentEl().children[z]||null,this.contentEl().insertBefore(c.el(),z));return c};a.prototype.removeChild=function(a){"string"===typeof a&&(a=this.getChild(a));if(a&&this.children_){for(var b=!1,c=this.children_.length-1;0<=c;c--)if(this.children_[c]===a){b=!0;this.children_.splice(c,1);break}b&&(this.childIndex_[a.id()]=null,this.childNameIndex_[a.name()]=null,(b=a.el())&&b.parentNode===this.contentEl()&&this.contentEl().removeChild(a.el()))}};a.prototype.initChildren=function(){var b=this,c=this.options_.children;if(c){var z=this.options_,d=void 0,e=a.getComponent("Tech"),d=Array.isArray(c)?c:Object.keys(c);d.concat(Object.keys(this.options_).filter(function(a){return!d.some(function(b){return"string"===typeof b?a===b:a===b.name})})).map(function(a){var z;"string"===typeof a?(z=a,a=c[z]||b.options_[z]||{}):z=a.name;return{name:z,opts:a}}).filter(function(b){return(b=a.getComponent(b.opts.componentClass||ga(b.name)))&&!e.isTech(b)}).forEach(function(a){var c=a.name;a=a.opts;void 0!==z[c]&&(a=z[c]);!1!==a&&(!0===a&&(a={}),a.playerOptions=b.options_.playerOptions,(a=b.addChild(c,a))&&(b[c]=a))})}};a.prototype.buildCSSClass=function(){return""};a.prototype.ready=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;a&&(this.isReady_?b?a.call(this):this.setTimeout(a,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(a)))};a.prototype.triggerReady=function(){this.isReady_=!0;this.setTimeout(function(){var a=this.readyQueue_;this.readyQueue_=[];a&&0<a.length&&a.forEach(function(a){a.call(this)},this);this.trigger("ready")},1)};a.prototype.$=function(a,b){return Na(a,b||this.contentEl())};a.prototype.$$=function(a,b){return Tc(a,b||this.contentEl())};a.prototype.hasClass=function(a){return c(this.el_,a)};a.prototype.addClass=function(a){e(this.el_,a)};a.prototype.removeClass=function(a){g(this.el_,a)};a.prototype.toggleClass=function(a,b){r(this.el_,a,b)};a.prototype.show=function(){this.removeClass("vjs-hidden")};a.prototype.hide=function(){this.addClass("vjs-hidden")};a.prototype.lockShowing=function(){this.addClass("vjs-lock-showing")};a.prototype.unlockShowing=function(){this.removeClass("vjs-lock-showing")};a.prototype.getAttribute=function(a){return this.el_.getAttribute(a)};a.prototype.setAttribute=function(a,b){this.el_.setAttribute(a,b)};a.prototype.removeAttribute=function(a){this.el_.removeAttribute(a)};a.prototype.width=function(a,b){return this.dimension("width",a,b)};a.prototype.height=function(a,b){return this.dimension("height",a,b)};a.prototype.dimensions=function(a,b){this.width(a,!0);this.height(b)};a.prototype.dimension=function(a,b,c){if(void 0!==b){if(null===b||b!==b)b=0;-1!==(""+b).indexOf("%")||-1!==(""+b).indexOf("px")?this.el_.style[a]=b:this.el_.style[a]="auto"===b?"":b+"px";c||this.trigger("componentresize")}else{if(!this.el_)return 0;b=this.el_.style[a];c=b.indexOf("px");return-1!==c?parseInt(b.slice(0,c),10):parseInt(this.el_["offset"+ga(a)],10)}};a.prototype.currentDimension=function(a){var b=0;if("width"!==a&&"height"!==a)throw Error("currentDimension only accepts width or height value");"function"===typeof G.getComputedStyle&&(b=G.getComputedStyle(this.el_),b=b.getPropertyValue(a)||b[a]);b=parseFloat(b);0===b&&(a="offset"+ga(a),b=this.el_[a]);return b};a.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};a.prototype.currentWidth=function(){return this.currentDimension("width")};a.prototype.currentHeight=function(){return this.currentDimension("height")};a.prototype.focus=function(){this.el_.focus()};a.prototype.blur=function(){this.el_.blur()};a.prototype.emitTapEvents=function(){var a=0,b=null,c=void 0;this.on("touchstart",function(z){1===z.touches.length&&(b={pageX:z.touches[0].pageX,pageY:z.touches[0].pageY},a=(new Date).getTime(),c=!0)});this.on("touchmove",function(a){if(1<a.touches.length)c=!1;else if(b){var z=a.touches[0].pageX-b.pageX;a=a.touches[0].pageY-b.pageY;10<Math.sqrt(z*z+a*a)&&(c=!1)}});var d=function(){c=!1};this.on("touchleave",d);this.on("touchcancel",d);this.on("touchend",function(z){b=null;!0===c&&200>(new Date).getTime()-a&&(z.preventDefault(),this.trigger("tap"))})};a.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var a=Y(this.player(),this.player().reportUserActivity),b=void 0;this.on("touchstart",function(){a();this.clearInterval(b);b=this.setInterval(a,250)});var c=function(c){a();this.clearInterval(b)};this.on("touchmove",a);this.on("touchend",c);this.on("touchcancel",c)}};a.prototype.setTimeout=function(a,b){var c=this;a=Y(this,a);var d=G.setTimeout(a,b),e=function(){return c.clearTimeout(d)};e.guid="vjs-timeout-"+d;this.on("dispose",e);return d};a.prototype.clearTimeout=function(a){G.clearTimeout(a);var b=function(){};b.guid="vjs-timeout-"+a;this.off("dispose",b);return a};a.prototype.setInterval=function(a,b){var c=this;a=Y(this,a);var d=G.setInterval(a,b),e=function(){return c.clearInterval(d)};e.guid="vjs-interval-"+d;this.on("dispose",e);return d};a.prototype.clearInterval=function(a){G.clearInterval(a);var b=function(){};b.guid="vjs-interval-"+a;this.off("dispose",b);return a};a.prototype.requestAnimationFrame=function(a){var b=this;if(this.supportsRaf_){a=Y(this,a);var c=G.requestAnimationFrame(a);a=function(){return b.cancelAnimationFrame(c)};a.guid="vjs-raf-"+c;this.on("dispose",a);return c}return this.setTimeout(a,1E3/60)};a.prototype.cancelAnimationFrame=function(a){if(this.supportsRaf_){G.cancelAnimationFrame(a);var b=function(){};b.guid="vjs-raf-"+a;this.off("dispose",b);return a}return this.clearTimeout(a)};a.registerComponent=function(b,c){if("string"!==typeof b||!b)throw Error('Illegal component name, "'+b+'"; must be a non-empty string.');var z=a.getComponent("Tech"),z=z&&z.isTech(c),d=a===c||a.prototype.isPrototypeOf(c.prototype);if(z||!d)throw Error('Illegal component, "'+b+'"; '+(z?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");b=ga(b);a.components_||(a.components_={});z=a.getComponent("Player");if("Player"===b&&z&&z.players){var e=z.players,z=Object.keys(e);if(e&&0<z.length&&z.map(function(a){return e[a]}).every(Boolean))throw Error("Can not register Player component after player has been created.");}return a.components_[b]=c};a.getComponent=function(b){if(b&&(b=ga(b),a.components_&&a.components_[b]))return a.components_[b]};return a}();I.prototype.supportsRaf_="function"===typeof G.requestAnimationFrame&&"function"===typeof G.cancelAnimationFrame;I.registerComponent("Component",I);for(var Ha={},wb=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],pe=wb[0],xb=void 0,yb=0;yb<wb.length;yb++)if(wb[yb][1]in L){xb=wb[yb];break}if(xb)for(var zb=0;zb<xb.length;zb++)Ha[pe[zb]]=xb[zb];oa.prototype.code=0;oa.prototype.message="";oa.prototype.status=null;oa.errorTypes="MEDIA_ERR_CUSTOM MEDIA_ERR_ABORTED MEDIA_ERR_NETWORK MEDIA_ERR_DECODE MEDIA_ERR_SRC_NOT_SUPPORTED MEDIA_ERR_ENCRYPTED".split(" ");oa.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Ya=0;Ya<oa.errorTypes.length;Ya++)oa[oa.errorTypes[Ya]]=Ya,oa.prototype[oa.errorTypes[Ya]]=Ya;var Vb=function(a){return"kind label language id inBandMetadataTrackDispatchType mode src".split(" ").reduce(function(b,c,z){a[c]&&(b[c]=a[c]);return b},{cues:a.cues&&Array.prototype.map.call(a.cues,function(a){return{startTime:a.startTime,endTime:a.endTime,text:a.text,id:a.id}})})},ad={textTracksToJson:function(a){var b=a.$$("track"),c=Array.prototype.map.call(b,function(a){return a.track});return Array.prototype.map.call(b,function(a){var b=Vb(a.track);a.src&&(b.src=a.src);return b}).concat(Array.prototype.filter.call(a.textTracks(),function(a){return-1===c.indexOf(a)}).map(Vb))},jsonToTextTracks:function(a,b){a.forEach(function(a){var c=b.addRemoteTextTrack(a).track;!a.src&&a.cues&&a.cues.forEach(function(a){return c.addCue(a)})});return b.textTracks()},trackToJson_:Vb},Za=function(b){function c(e,z){M(this,c);var g=K(this,b.call(this,e,z));g.opened_=g.hasBeenOpened_=g.hasBeenFilled_=!1;g.closeable(!g.options_.uncloseable);g.content(g.options_.content);g.contentEl_=d("div",{className:"vjs-modal-dialog-content"},{role:"document"});g.descEl_=d("p",{className:"vjs-modal-dialog-description vjs-control-text",id:g.el().getAttribute("aria-describedby")});a(g.descEl_,g.description());g.el_.appendChild(g.descEl_);g.el_.appendChild(g.contentEl_);return g}O(c,b);c.prototype.createEl=function(){return b.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};c.prototype.dispose=function(){this.previouslyActiveEl_=this.descEl_=this.contentEl_=null;b.prototype.dispose.call(this)};c.prototype.buildCSSClass=function(){return"vjs-modal-dialog vjs-hidden "+b.prototype.buildCSSClass.call(this)};c.prototype.handleKeyPress=function(a){27===a.which&&this.closeable()&&this.close()};c.prototype.label=function(){return this.localize(this.options_.label||"Modal Window")};c.prototype.description=function(){var a=this.options_.description||this.localize("This is a modal window.");this.closeable()&&(a+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button."));return a};c.prototype.open=function(){if(!this.opened_){var a=this.player();this.trigger("beforemodalopen");this.opened_=!0;(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill();this.wasPlaying_=!a.paused();this.options_.pauseOnOpen&&this.wasPlaying_&&a.pause();if(this.closeable())this.on(this.el_.ownerDocument,"keydown",Y(this,this.handleKeyPress));this.hadControls_=a.controls();a.controls(!1);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=!0}};c.prototype.opened=function(a){if("boolean"===typeof a)this[a?"open":"close"]();return this.opened_};c.prototype.close=function(){if(this.opened_){var a=this.player();this.trigger("beforemodalclose");this.opened_=!1;this.wasPlaying_&&this.options_.pauseOnOpen&&a.play();this.closeable()&&this.off(this.el_.ownerDocument,"keydown",Y(this,this.handleKeyPress));this.hadControls_&&a.controls(!0);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();this.options_.temporary&&this.dispose()}};c.prototype.closeable=function(a){if("boolean"===typeof a){a=this.closeable_=!!a;var b=this.getChild("closeButton");if(a&&!b){var c=this.contentEl_;this.contentEl_=this.el_;b=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=c;this.on(b,"close",this.close)}!a&&b&&(this.off(b,"close",this.close),this.removeChild(b),b.dispose())}return this.closeable_};c.prototype.fill=function(){this.fillWith(this.content())};c.prototype.fillWith=function(a){var b=this.contentEl(),c=b.parentNode,d=b.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=!0;c.removeChild(b);this.empty();T(b,a);this.trigger("modalfill");d?c.insertBefore(b,d):c.appendChild(b);(a=this.getChild("closeButton"))&&c.appendChild(a.el_)};c.prototype.empty=function(){this.trigger("beforemodalempty");Q(this.contentEl());this.trigger("modalempty")};c.prototype.content=function(a){"undefined"!==typeof a&&(this.content_=a);return this.content_};c.prototype.conditionalFocus_=function(){var a=L.activeElement,b=this.player_.el_;this.previouslyActiveEl_=null;if(b.contains(a)||b===a)this.previouslyActiveEl_=a,this.focus(),this.on(L,"keydown",this.handleKeyDown)};c.prototype.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null);this.off(L,"keydown",this.handleKeyDown)};c.prototype.handleKeyDown=function(a){if(9===a.which){for(var b=this.focusableEls_(),c=this.el_.querySelector(":focus"),d=void 0,e=0;e<b.length;e++)if(c===b[e]){d=e;break}L.activeElement===this.el_&&(d=0);a.shiftKey&&0===d?(b[b.length-1].focus(),a.preventDefault()):a.shiftKey||d!==b.length-1||(b[0].focus(),a.preventDefault())}};c.prototype.focusableEls_=function(){var a=this.el_.querySelectorAll("*");return Array.prototype.filter.call(a,function(a){return(a instanceof G.HTMLAnchorElement||a instanceof G.HTMLAreaElement)&&a.hasAttribute("href")||(a instanceof G.HTMLInputElement||a instanceof G.HTMLSelectElement||a instanceof G.HTMLTextAreaElement||a instanceof G.HTMLButtonElement)&&!a.hasAttribute("disabled")||a instanceof G.HTMLIFrameElement||a instanceof G.HTMLObjectElement||a instanceof G.HTMLEmbedElement||a.hasAttribute("tabindex")&&-1!==a.getAttribute("tabindex")||a.hasAttribute("contenteditable")})};return c}(I);Za.prototype.options_={pauseOnOpen:!0,temporary:!0};I.registerComponent("ModalDialog",Za);var wa=function(a){function b(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],d,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;M(this,b);var g=K(this,a.call(this));if(!e&&(e=g,qa)){var e=L.createElement("custom"),f;for(f in b.prototype)"constructor"!==f&&(e[f]=b.prototype[f])}e.tracks_=[];Object.defineProperty(e,"length",{get:function(){return this.tracks_.length}});for(f=0;f<c.length;f++)e.addTrack(c[f]);return d=e,K(g,d)}O(b,a);b.prototype.addTrack=function(a){var b=this.tracks_.length;""+b in this||Object.defineProperty(this,b,{get:function(){return this.tracks_[b]}});-1===this.tracks_.indexOf(a)&&(this.tracks_.push(a),this.trigger({track:a,type:"addtrack"}))};b.prototype.removeTrack=function(a){for(var b=void 0,c=0,d=this.length;c<d;c++)if(this[c]===a){b=this[c];b.off&&b.off();this.tracks_.splice(c,1);break}b&&this.trigger({track:b,type:"removetrack"})};b.prototype.getTrackById=function(a){for(var b=null,c=0,d=this.length;c<d;c++){var e=this[c];if(e.id===a){b=e;break}}return b};return b}(ma);wa.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var qe in wa.prototype.allowedEvents_)wa.prototype["on"+qe]=null;var Wb=function(a,b){for(var c=0;c<a.length;c++)Object.keys(a[c]).length&&b.id!==a[c].id&&(a[c].enabled=!1)},re=function(a){function b(){var c,d,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];M(this,b);for(var g=void 0,f=e.length-1;0<=f;f--)if(e[f].enabled){Wb(e,e[f]);break}if(qa){var g=L.createElement("custom"),r;for(r in wa.prototype)"constructor"!==r&&(g[r]=wa.prototype[r]);for(var l in b.prototype)"constructor"!==l&&(g[l]=b.prototype[l])}g=(c=K(this,a.call(this,e,g)),c);g.changing_=!1;return d=g,K(c,d)}O(b,a);b.prototype.addTrack=function(b){var c=this;b.enabled&&Wb(this,b);a.prototype.addTrack.call(this,b);b.addEventListener&&b.addEventListener("enabledchange",function(){c.changing_||(c.changing_=!0,Wb(c,b),c.changing_=!1,c.trigger("change"))})};return b}(wa),Xb=function(a,b){for(var c=0;c<a.length;c++)Object.keys(a[c]).length&&b.id!==a[c].id&&(a[c].selected=!1)},se=function(a){function b(){var c,d,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];M(this,b);for(var g=void 0,f=e.length-1;0<=f;f--)if(e[f].selected){Xb(e,e[f]);break}if(qa){var g=L.createElement("custom"),r;for(r in wa.prototype)"constructor"!==r&&(g[r]=wa.prototype[r]);for(var l in b.prototype)"constructor"!==l&&(g[l]=b.prototype[l])}g=(c=K(this,a.call(this,e,g)),c);g.changing_=!1;Object.defineProperty(g,"selectedIndex",{get:function(){for(var a=0;a<this.length;a++)if(this[a].selected)return a;return-1},set:function(){}});return d=g,K(c,d)}O(b,a);b.prototype.addTrack=function(b){var c=this;b.selected&&Xb(this,b);a.prototype.addTrack.call(this,b);b.addEventListener&&b.addEventListener("selectedchange",function(){c.changing_||(c.changing_=!0,Xb(c,b),c.changing_=!1,c.trigger("change"))})};return b}(wa),bd=function(a){function b(){var c,d,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];M(this,b);var g=void 0;if(qa){var g=L.createElement("custom"),f;for(f in wa.prototype)"constructor"!==f&&(g[f]=wa.prototype[f]);for(var r in b.prototype)"constructor"!==r&&(g[r]=b.prototype[r])}g=(c=K(this,a.call(this,e,g)),c);return d=g,K(c,d)}O(b,a);b.prototype.addTrack=function(b){a.prototype.addTrack.call(this,b);b.addEventListener("modechange",Y(this,function(){this.trigger("change")}));-1===["metadata","chapters"].indexOf(b.kind)&&b.addEventListener("modechange",Y(this,function(){this.trigger("selectedlanguagechange")}))};return b}(wa),te=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];M(this,a);var c=this;if(qa){var c=L.createElement("custom"),d;for(d in a.prototype)"constructor"!==d&&(c[d]=a.prototype[d])}c.trackElements_=[];Object.defineProperty(c,"length",{get:function(){return this.trackElements_.length}});d=0;for(var e=b.length;d<e;d++)c.addTrackElement_(b[d]);if(qa)return c}a.prototype.addTrackElement_=function(a){var b=this.trackElements_.length;""+b in this||Object.defineProperty(this,b,{get:function(){return this.trackElements_[b]}});-1===this.trackElements_.indexOf(a)&&this.trackElements_.push(a)};a.prototype.getTrackElementByTrack_=function(a){for(var b=void 0,c=0,d=this.trackElements_.length;c<d;c++)if(a===this.trackElements_[c].track){b=this.trackElements_[c];break}return b};a.prototype.removeTrackElement_=function(a){for(var b=0,c=this.trackElements_.length;b<c;b++)if(a===this.trackElements_[b]){this.trackElements_.splice(b,1);break}};return a}(),cd=function(){function a(b){M(this,a);var c=this;if(qa){var c=L.createElement("custom"),d;for(d in a.prototype)"constructor"!==d&&(c[d]=a.prototype[d])}a.prototype.setCues_.call(c,b);Object.defineProperty(c,"length",{get:function(){return this.length_}});if(qa)return c}a.prototype.setCues_=function(a){var b=this.length||0,c=0,d=a.length;this.cues_=a;this.length_=a.length;a=function(a){""+a in this||Object.defineProperty(this,""+a,{get:function(){return this.cues_[a]}})};if(b<d)for(c=b;c<d;c++)a.call(this,c)};a.prototype.getCueById=function(a){for(var b=null,c=0,d=this.length;c<d;c++){var e=this[c];if(e.id===a){b=e;break}}return b};return a}(),ue={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},ve={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},we={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},dd={disabled:"disabled",hidden:"hidden",showing:"showing"},Yb=function(a){function b(){var c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};M(this,b);var e=K(this,a.call(this)),g=e;if(qa){var g=L.createElement("custom"),f;for(f in b.prototype)"constructor"!==f&&(g[f]=b.prototype[f])}var r={id:d.id||"vjs_track_"+Ja++,kind:d.kind||"",label:d.label||"",language:d.language||""},d=function(a){Object.defineProperty(g,a,{get:function(){return r[a]},set:function(){}})},l;for(l in r)d(l);return c=g,K(e,c)}O(b,a);return b}(ma),Zb=function(a){var b="protocol hostname port pathname search hash host".split(" "),c=L.createElement("a");c.href=a;var d=""===c.host&&"file:"!==c.protocol,e=void 0;d&&(e=L.createElement("div"),e.innerHTML='\x3ca href\x3d"'+a+'"\x3e\x3c/a\x3e',c=e.firstChild,e.setAttribute("style","display:none; position:absolute;"),L.body.appendChild(e));a={};for(var g=0;g<b.length;g++)a[b[g]]=c[b[g]];"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,""));"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,""));a.protocol||(a.protocol=G.location.protocol);d&&L.body.removeChild(e);return a},ed=function(a){return"string"===typeof a&&(a=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(a))?a.pop().toLowerCase():""},Ab=function(a){var b=G.location;a=Zb(a);return(":"===a.protocol?b.protocol:a.protocol)+a.host!==b.protocol+b.host},xe=(Object.freeze||Object)({parseUrl:Zb,getAbsoluteURL:function(a){if(!a.match(/^https?:\/\//)){var b=L.createElement("div");b.innerHTML='\x3ca href\x3d"'+a+'"\x3ex\x3c/a\x3e';a=b.firstChild.href}return a},getFileExtension:ed,isCrossOrigin:Ab}),zc=function(a){var b=ye.call(a);return"[object Function]"===b||"function"===typeof a&&"[object RegExp]"!==b||"undefined"!==typeof window&&(a===window.setTimeout||a===window.alert||a===window.confirm||a===window.prompt)},ye=Object.prototype.toString,$b=t(function(a,b){b=a.exports=function(a){return a.replace(/^\s*|\s*$/g,"")};b.left=function(a){return a.replace(/^\s*/,"")};b.right=function(a){return a.replace(/\s*$/,"")}}),Ae=function(a,b,c){if(!zc(b))throw new TypeError("iterator must be a function");3>arguments.length&&(c=this);if("[object Array]"===ze.call(a))for(var d=c,e=0,g=a.length;e<g;e++)fd.call(a,e)&&b.call(d,a[e],e,a);else if("string"===typeof a)for(d=c,e=0,g=a.length;e<g;e++)b.call(d,a.charAt(e),e,a);else for(e in d=c,a)fd.call(a,e)&&b.call(d,a[e],e,a)},ze=Object.prototype.toString,fd=Object.prototype.hasOwnProperty,Yd=function(a){if(!a)return{};var b={};Ae($b(a).split("\n"),function(a){var c=a.indexOf(":"),d=$b(a.slice(0,c)).toLowerCase();a=$b(a.slice(c+1));"undefined"===typeof b[d]?b[d]=a:"[object Array]"===Object.prototype.toString.call(b[d])?b[d].push(a):b[d]=[b[d],a]});return b},Xd=function(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Be.call(c,d)&&(a[d]=c[d])}return a},Be=Object.prototype.hasOwnProperty;za.XMLHttpRequest=G.XMLHttpRequest||Zd;za.XDomainRequest="withCredentials"in new za.XMLHttpRequest?za.XMLHttpRequest:G.XDomainRequest;(function(a,b){for(var c=0;c<a.length;c++)b(a[c])})("get put post patch head delete".split(" "),function(a){za["delete"===a?"del":a]=function(b,c,d){c=yc(b,c,d);c.method=a.toUpperCase();return Ac(c)}});var gd=function(a,b){var c=new G.WebVTT.Parser(G,G.vttjs,G.WebVTT.StringDecoder()),d=[];c.oncue=function(a){b.addCue(a)};c.onparsingerror=function(a){d.push(a)};c.onflush=function(){b.trigger({type:"loadeddata",target:b})};c.parse(a);0<d.length&&(G.console&&G.console.groupCollapsed&&G.console.groupCollapsed("Text Track parsing errors for "+b.src),d.forEach(function(a){return Z.error(a)}),G.console&&G.console.groupEnd&&G.console.groupEnd());c.flush()},Ce=function(a,b){var c={uri:a},d=Ab(a);d&&(c.cors=d);za(c,Y(this,function(a,c,d){if(a)return Z.error(a,c);b.loaded_=!0;if("function"!==typeof G.WebVTT){if(b.tech_){var e=function(){return gd(d,b)};b.tech_.on("vttjsloaded",e);b.tech_.on("vttjserror",function(){Z.error("vttjs failed to load, stopping trying to process "+b.src);b.tech_.off("vttjsloaded",e)})}}else gd(d,b)}))},ib=function(a){function b(){var c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};M(this,b);if(!d.tech)throw Error("A tech was not provided.");var d=ja(d,{kind:we[d.kind]||"subtitles",language:d.language||d.srclang||""}),e=dd[d.mode]||"disabled",g=d["default"];if("metadata"===d.kind||"chapters"===d.kind)e="hidden";var f=(c=K(this,a.call(this,d)),c);f.tech_=d.tech;if(qa)for(var r in b.prototype)"constructor"!==r&&(f[r]=b.prototype[r]);f.cues_=[];f.activeCues_=[];var l=new cd(f.cues_),h=new cd(f.activeCues_),m=!1,v=Y(f,function(){this.activeCues;m&&(this.trigger("cuechange"),m=!1)});"disabled"!==e&&f.tech_.ready(function(){f.tech_.on("timeupdate",v)},!0);Object.defineProperty(f,"default",{get:function(){return g},set:function(){}});Object.defineProperty(f,"mode",{get:function(){return e},set:function(a){var b=this;dd[a]&&(e=a,"showing"===e&&this.tech_.ready(function(){b.tech_.on("timeupdate",v)},!0),this.trigger("modechange"))}});Object.defineProperty(f,"cues",{get:function(){return this.loaded_?l:null},set:function(){}});Object.defineProperty(f,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return h;for(var a=this.tech_.currentTime(),b=[],c=0,d=this.cues.length;c<d;c++){var e=this.cues[c];e.startTime<=a&&e.endTime>=a?b.push(e):e.startTime===e.endTime&&e.startTime<=a&&e.startTime+.5>=a&&b.push(e)}m=!1;if(b.length!==this.activeCues_.length)m=!0;else for(a=0;a<b.length;a++)-1===this.activeCues_.indexOf(b[a])&&(m=!0);this.activeCues_=b;h.setCues_(this.activeCues_);return h},set:function(){}});d.src?(f.src=d.src,Ce(d.src,f)):f.loaded_=!0;return K(c,f)}O(b,a);b.prototype.addCue=function(a){var b=a;if(G.vttjs&&!(a instanceof G.vttjs.VTTCue)){var b=new G.vttjs.VTTCue(a.startTime,a.endTime,a.text),c;for(c in a)c in b||(b[c]=a[c]);b.id=a.id;b.originalCue_=a}a=this.tech_.textTracks();for(c=0;c<a.length;c++)a[c]!==this&&a[c].removeCue(b);this.cues_.push(b);this.cues.setCues_(this.cues_)};b.prototype.removeCue=function(a){for(var b=this.cues_.length;b--;){var c=this.cues_[b];if(c===a||c.originalCue_&&c.originalCue_===a){this.cues_.splice(b,1);this.cues.setCues_(this.cues_);break}}};return b}(Yb);ib.prototype.allowedEvents_={cuechange:"cuechange"};var hd=function(a){function b(){var c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};M(this,b);var d=ja(d,{kind:ve[d.kind]||""}),e=(c=K(this,a.call(this,d)),c),g=!1;if(qa)for(var f in b.prototype)"constructor"!==f&&(e[f]=b.prototype[f]);Object.defineProperty(e,"enabled",{get:function(){return g},set:function(a){"boolean"===typeof a&&a!==g&&(g=a,this.trigger("enabledchange"))}});d.enabled&&(e.enabled=d.enabled);e.loaded_=!0;return K(c,e)}O(b,a);return b}(Yb),id=function(a){function b(){var c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};M(this,b);var d=ja(d,{kind:ue[d.kind]||""}),e=(c=K(this,a.call(this,d)),c),g=!1;if(qa)for(var f in b.prototype)"constructor"!==f&&(e[f]=b.prototype[f]);Object.defineProperty(e,"selected",{get:function(){return g},set:function(a){"boolean"===typeof a&&a!==g&&(g=a,this.trigger("selectedchange"))}});d.selected&&(e.selected=d.selected);return K(c,e)}O(b,a);return b}(Yb),$a=function(a){function b(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};M(this,b);var d=K(this,a.call(this)),e=void 0,g=d;if(qa){var g=L.createElement("custom"),f;for(f in b.prototype)"constructor"!==f&&(g[f]=b.prototype[f])}var r=new ib(c);g.kind=r.kind;g.src=r.src;g.srclang=r.language;g.label=r.label;g["default"]=r["default"];Object.defineProperty(g,"readyState",{get:function(){return e}});Object.defineProperty(g,"track",{get:function(){return r}});e=0;r.addEventListener("loadeddata",function(){e=2;g.trigger({type:"load",target:g})});if(qa){var l;return l=g,K(d,l)}return d}O(b,a);return b}(ma);$a.prototype.allowedEvents_={load:"load"};$a.NONE=0;$a.LOADING=1;$a.LOADED=2;$a.ERROR=3;var xa={audio:{ListClass:re,TrackClass:hd,capitalName:"Audio"},video:{ListClass:se,TrackClass:id,capitalName:"Video"},text:{ListClass:bd,TrackClass:ib,capitalName:"Text"}};Object.keys(xa).forEach(function(a){xa[a].getterName=a+"Tracks";xa[a].privateName=a+"Tracks_"});var jb={remoteText:{ListClass:bd,TrackClass:ib,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:te,TrackClass:$a,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},ua=ja(xa,jb);jb.names=Object.keys(jb);xa.names=Object.keys(xa);ua.names=[].concat(jb.names).concat(xa.names);var Lb=Object.create||function(){function a(){}return function(b){if(1!==arguments.length)throw Error("Object.create shim only accepts one parameter.");a.prototype=b;return new a}}();ta.prototype=Lb(Error.prototype);ta.prototype.constructor=ta;ta.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};db.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){return b.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(b=parseFloat(b),0<=b&&100>=b)?(this.set(a,b),!0):!1}};var ae={"\x26amp;":"\x26","\x26lt;":"\x3c","\x26gt;":"\x3e","\x26lrm;":"\u200e","\x26rlm;":"\u200f","\x26nbsp;":"\u00a0"},be={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},ce={v:"title",lang:"lang"},Cc={rt:"ruby"},Dc=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];Mb.prototype.applyStyles=function(a,b){b=b||this.div;for(var c in a)a.hasOwnProperty(c)&&(b.style[c]=a[c])};Mb.prototype.formatStyle=function(a,b){return 0===a?0:a+b};pb.prototype=Lb(Mb.prototype);pb.prototype.constructor=pb;pa.prototype.move=function(a,b){b=void 0!==b?b:this.lineHeight;switch(a){case "+x":this.left+=b;this.right+=b;break;case "-x":this.left-=b;this.right-=b;break;case "+y":this.top+=b;this.bottom+=b;break;case "-y":this.top-=b,this.bottom-=b}};pa.prototype.overlaps=function(a){return this.left<a.right&&this.right>a.left&&this.top<a.bottom&&this.bottom>a.top};pa.prototype.overlapsAny=function(a){for(var b=0;b<a.length;b++)if(this.overlaps(a[b]))return!0;return!1};pa.prototype.within=function(a){return this.top>=a.top&&this.bottom<=a.bottom&&this.left>=a.left&&this.right<=a.right};pa.prototype.overlapsOppositeAxis=function(a,b){switch(b){case "+x":return this.left<a.left;case "-x":return this.right>a.right;case "+y":return this.top<a.top;case "-y":return this.bottom>a.bottom}};pa.prototype.intersectPercentage=function(a){return Math.max(0,Math.min(this.right,a.right)-Math.max(this.left,a.left))*Math.max(0,Math.min(this.bottom,a.bottom)-Math.max(this.top,a.top))/(this.height*this.width)};pa.prototype.toCSSCompatValues=function(a){return{top:this.top-a.top,bottom:a.bottom-this.bottom,left:this.left-a.left,right:a.right-this.right,height:this.height,width:this.width}};pa.getSimpleBoxPosition=function(a){var b=a.div?a.div.offsetHeight:a.tagName?a.offsetHeight:0,c=a.div?a.div.offsetWidth:a.tagName?a.offsetWidth:0,d=a.div?a.div.offsetTop:a.tagName?a.offsetTop:0;a=a.div?a.div.getBoundingClientRect():a.tagName?a.getBoundingClientRect():a;return{left:a.left,right:a.right,top:a.top||d,height:a.height||b,bottom:a.bottom||d+(a.height||b),width:a.width||c}};Ua.StringDecoder=function(){return{decode:function(a){if(!a)return"";if("string"!==typeof a)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}};Ua.convertCueToDOMTree=function(a,b){return a&&b?Bc(a,b):null};Ua.processCues=function(a,b,c){if(!a||!b||!c)return null;for(;c.firstChild;)c.removeChild(c.firstChild);var d=a.document.createElement("div");d.style.position="absolute";d.style.left="0";d.style.right="0";d.style.top="0";d.style.bottom="0";d.style.margin="1.5%";c.appendChild(d);if(function(a){for(var b=0;b<a.length;b++)if(a[b].hasBeenReset||!a[b].displayState)return!0;return!1}(b)){var e=[],g=pa.getSimpleBoxPosition(d),f={font:Math.round(5*g.height)/100+"px sans-serif"};(function(){for(var c,z,r=0;r<b.length;r++){z=b[r];c=new pb(a,z,f);d.appendChild(c.div);var l=c,h=g,m=e,v=new pa(l),R=l.cue,C;if("number"===typeof R.line&&(R.snapToLines||0<=R.line&&100>=R.line))C=R.line;else if(R.track&&R.track.textTrackList&&R.track.textTrackList.mediaElement){C=R.track;for(var D=C.textTrackList,E=0,B=0;B<D.length&&D[B]!==C;B++)"showing"===D[B].mode&&E++;C=-1*++E}else C=-1;D=[];if(R.snapToLines){var ea=void 0;switch(R.vertical){case "":D=["+y","-y"];ea="height";break;case "rl":D=["+x","-x"];ea="width";break;case "lr":D=["-x","+x"],ea="width"}var E=v.lineHeight,B=E*Math.round(C),ea=h[ea]+E,H=D[0];Math.abs(B)>ea&&(B=(0>B?-1:1)*Math.ceil(ea/E)*E);0>C&&(B+=""===R.vertical?h.height:h.width,D=D.reverse());v.move(H,B)}else{v=v.lineHeight/h.height*100;switch(R.lineAlign){case "middle":C-=v/2;break;case "end":C-=v}switch(R.vertical){case "":l.applyStyles({top:l.formatStyle(C,"%")});break;case "rl":l.applyStyles({left:l.formatStyle(C,"%")});break;case "lr":l.applyStyles({right:l.formatStyle(C,"%")})}D=["+y","-x","+x","-y"];v=new pa(l)}a:{R=v;v=D;C=void 0;D=new pa(R);E=1;for(B=0;B<v.length;B++){for(;R.overlapsOppositeAxis(h,v[B])||R.within(h)&&R.overlapsAny(m);)R.move(v[B]);if(R.within(h)){m=R;break a}ea=R.intersectPercentage(h);E>ea&&(C=new pa(R),E=ea);R=new pa(D)}m=C||D}l.move(m.toCSSCompatValues(h));z.displayState=c.div;e.push(pa.getSimpleBoxPosition(c))}})()}else for(c=0;c<b.length;c++)d.appendChild(b[c].displayState)};Ua.Parser=function(a,b,c){c||(c=b,b={});b||(b={});this.window=a;this.vttjs=b;this.state="INITIAL";this.buffer="";this.decoder=c||new TextDecoder("utf8");this.regionList=[]};Ua.Parser.prototype={reportOrThrowError:function(a){if(a instanceof ta)this.onparsingerror&&this.onparsingerror(a);else throw a;},parse:function(a){function b(){for(var a=g.buffer,b=0;b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var c=a.substr(0,b);"\r"===a[b]&&++b;"\n"===a[b]&&++b;g.buffer=a.substr(b);return c}function c(a){var b=new db;eb(a,function(a,c){switch(a){case "id":b.set(a,c);break;case "width":b.percent(a,c);break;case "lines":b.integer(a,c);break;case "regionanchor":case "viewportanchor":var d=c.split(",");if(2!==d.length)break;var e=new db;e.percent("x",d[0]);e.percent("y",d[1]);if(!e.has("x")||!e.has("y"))break;b.set(a+"X",e.get("x"));b.set(a+"Y",e.get("y"));break;case "scroll":b.alt(a,c,["up"])}},/=/,/\s/);b.has("id")&&(a=new (g.vttjs.VTTRegion||g.window.VTTRegion),a.width=b.get("width",100),a.lines=b.get("lines",3),a.regionAnchorX=b.get("regionanchorX",0),a.regionAnchorY=b.get("regionanchorY",100),a.viewportAnchorX=b.get("viewportanchorX",0),a.viewportAnchorY=b.get("viewportanchorY",100),a.scroll=b.get("scroll",""),g.onregion&&g.onregion(a),g.regionList.push({id:b.get("id"),region:a}))}function d(a){var b=new db;eb(a,function(a,c){switch(a){case "MPEGT":b.integer(a+"S",c);break;case "LOCA":b.set(a+"L",Kb(c))}},/[^\d]:/,/,/);g.ontimestampmap&&g.ontimestampmap({MPEGTS:b.get("MPEGTS"),LOCAL:b.get("LOCAL")})}function e(a){a.match(/X-TIMESTAMP-MAP/)?eb(a,function(a,b){switch(a){case "X-TIMESTAMP-MAP":d(b)}},/=/):eb(a,function(a,b){switch(a){case "Region":c(b)}},/:/)}var g=this;a&&(g.buffer+=g.decoder.decode(a,{stream:!0}));try{var f;if("INITIAL"===g.state){if(!/\r\n|\n/.test(g.buffer))return this;f=b();var r=f.match(/^WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new ta(ta.Errors.BadSignature);g.state="HEADER"}for(a=!1;g.buffer;){if(!/\r\n|\n/.test(g.buffer))return this;a?a=!1:f=b();switch(g.state){case "HEADER":/:/.test(f)?e(f):f||(g.state="ID");continue;case "NOTE":f||(g.state="ID");continue;case "ID":if(/^NOTE($|[ \t])/.test(f)){g.state="NOTE";break}if(!f)continue;g.cue=new (g.vttjs.VTTCue||g.window.VTTCue)(0,0,"");g.state="CUE";if(-1===f.indexOf("--\x3e")){g.cue.id=f;continue}case "CUE":try{$d(f,g.cue,g.regionList)}catch(Ka){g.reportOrThrowError(Ka);g.cue=null;g.state="BADCUE";continue}g.state="CUETEXT";continue;case "CUETEXT":var l=-1!==f.indexOf("--\x3e");if(!f||l&&(a=!0)){g.oncue&&g.oncue(g.cue);g.cue=null;g.state="ID";continue}g.cue.text&&(g.cue.text+="\n");g.cue.text+=f;continue;case "BADCUE":f||(g.state="ID")}}}catch(Ka){g.reportOrThrowError(Ka);if("CUETEXT"===g.state&&g.cue&&g.oncue)g.oncue(g.cue);g.cue=null;g.state="INITIAL"===g.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{this.buffer+=this.decoder.decode();if(this.cue||"HEADER"===this.state)this.buffer+="\n\n",this.parse();if("INITIAL"===this.state)throw new ta(ta.Errors.BadSignature);}catch(sc){this.reportOrThrowError(sc)}this.onflush&&this.onflush();return this}};var ge={"":!0,lr:!0,rl:!0},fe={start:!0,middle:!0,end:!0,left:!0,right:!0};Ec.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var De={"":!0,up:!0},Ee=function(){var a=100,b=3,c=0,d=100,e=0,g=100,f="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return a},set:function(b){if(!fb(b))throw Error("Width must be between 0 and 100.");a=b}},lines:{enumerable:!0,get:function(){return b},set:function(a){if("number"!==typeof a)throw new TypeError("Lines must be set to a number.");b=a}},regionAnchorY:{enumerable:!0,get:function(){return d},set:function(a){if(!fb(a))throw Error("RegionAnchorX must be between 0 and 100.");d=a}},regionAnchorX:{enumerable:!0,get:function(){return c},set:function(a){if(!fb(a))throw Error("RegionAnchorY must be between 0 and 100.");c=a}},viewportAnchorY:{enumerable:!0,get:function(){return g},set:function(a){if(!fb(a))throw Error("ViewportAnchorY must be between 0 and 100.");g=a}},viewportAnchorX:{enumerable:!0,get:function(){return e},set:function(a){if(!fb(a))throw Error("ViewportAnchorX must be between 0 and 100.");e=a}},scroll:{enumerable:!0,get:function(){return f},set:function(a){a="string"!==typeof a?!1:De[a.toLowerCase()]?a.toLowerCase():!1;if(!1===a)throw new SyntaxError("An invalid or illegal string was specified.");f=a}}})},jd=t(function(a){a=a.exports={WebVTT:Ua,VTTCue:Ec,VTTRegion:Ee};G.vttjs=a;G.WebVTT=a.WebVTT;var b=a.VTTCue,c=a.VTTRegion,d=G.VTTCue,e=G.VTTRegion;a.shim=function(){G.VTTCue=b;G.VTTRegion=c};a.restore=function(){G.VTTCue=d;G.VTTRegion=e};G.VTTCue||a.shim()}),ha=function(a){function b(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};M(this,b);c.reportTouchActivity=!1;var e=K(this,a.call(this,null,c,d));e.hasStarted_=!1;e.on("playing",function(){this.hasStarted_=!0});e.on("loadstart",function(){this.hasStarted_=!1});ua.names.forEach(function(a){a=ua[a];c&&c[a.getterName]&&(e[a.privateName]=c[a.getterName])});e.featuresProgressEvents||e.manualProgressOn();e.featuresTimeupdateEvents||e.manualTimeUpdatesOn();["Text","Audio","Video"].forEach(function(a){!1===c["native"+a+"Tracks"]&&(e["featuresNative"+a+"Tracks"]=!1)});if(!1===c.nativeCaptions||!1===c.nativeTextTracks)e.featuresNativeTextTracks=!1;else if(!0===c.nativeCaptions||!0===c.nativeTextTracks)e.featuresNativeTextTracks=!0;e.featuresNativeTextTracks||e.emulateTextTracks();e.autoRemoteTextTracks_=new ua.text.ListClass;e.initTrackListeners();c.nativeControlsForTouch||e.emitTapEvents();e.constructor&&(e.name_=e.constructor.name||"Unknown Tech");return e}O(b,a);b.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange);this.manualProgress=!0;this.one("ready",this.trackProgress)};b.prototype.manualProgressOff=function(){this.manualProgress=!1;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)};b.prototype.trackProgress=function(a){this.stopTrackingProgress();this.progressInterval=this.setInterval(Y(this,function(){var a=this.bufferedPercent();this.bufferedPercent_!==a&&this.trigger("progress");this.bufferedPercent_=a;1===a&&this.stopTrackingProgress()}),500)};b.prototype.onDurationChange=function(a){this.duration_=this.duration()};b.prototype.buffered=function(){return La(0,0)};b.prototype.bufferedPercent=function(){return xc(this.buffered(),this.duration_)};b.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)};b.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)};b.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)};b.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime();this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)};b.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})};b.prototype.dispose=function(){this.clearTracks(xa.names);this.manualProgress&&this.manualProgressOff();this.manualTimeUpdates&&this.manualTimeUpdatesOff();a.prototype.dispose.call(this)};b.prototype.clearTracks=function(a){var b=this;a=[].concat(a);a.forEach(function(a){for(var c=b[a+"Tracks"]()||[],d=c.length;d--;){var e=c[d];"text"===a&&b.removeRemoteTextTrack(e);c.removeTrack(e)}})};b.prototype.cleanupAutoTextTracks=function(){for(var a=this.autoRemoteTextTracks_||[],b=a.length;b--;)this.removeRemoteTextTrack(a[b])};b.prototype.reset=function(){};b.prototype.error=function(a){void 0!==a&&(this.error_=new oa(a),this.trigger("error"));return this.error_};b.prototype.played=function(){return this.hasStarted_?La(0,0):La()};b.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})};b.prototype.initTrackListeners=function(){var a=this;xa.names.forEach(function(b){var c=function(){a.trigger(b+"trackchange")},d=a[xa[b].getterName]();d.addEventListener("removetrack",c);d.addEventListener("addtrack",c);a.on("dispose",function(){d.removeEventListener("removetrack",c);d.removeEventListener("addtrack",c)})})};b.prototype.addWebVttScript_=function(){var a=this;if(!G.WebVTT)if(L.body.contains(this.el()))if(!this.options_["vtt.js"]&&n(jd)&&0<Object.keys(jd).length)this.trigger("vttjsloaded");else{var b=L.createElement("script");b.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.12.4/vtt.min.js";b.onload=function(){a.trigger("vttjsloaded")};b.onerror=function(){a.trigger("vttjserror")};this.on("dispose",function(){b.onload=null;b.onerror=null});G.WebVTT=!0;this.el().parentNode.appendChild(b)}else this.ready(this.addWebVttScript_)};b.prototype.emulateTextTracks=function(){var a=this,b=this.textTracks(),c=this.remoteTextTracks(),d=function(a){return b.addTrack(a.track)},e=function(a){return b.removeTrack(a.track)};c.on("addtrack",d);c.on("removetrack",e);this.addWebVttScript_();var g=function(){return a.trigger("texttrackchange")},f=function(){g();for(var a=0;a<b.length;a++){var c=b[a];c.removeEventListener("cuechange",g);"showing"===c.mode&&c.addEventListener("cuechange",g)}};f();b.addEventListener("change",f);b.addEventListener("addtrack",f);b.addEventListener("removetrack",f);this.on("dispose",function(){c.off("addtrack",d);c.off("removetrack",e);b.removeEventListener("change",f);b.removeEventListener("addtrack",f);b.removeEventListener("removetrack",f);for(var a=0;a<b.length;a++)b[a].removeEventListener("cuechange",g)})};b.prototype.addTextTrack=function(a,b,c){if(!a)throw Error("TextTrack kind is required but was not provided");return he(this,a,b,c)};b.prototype.createRemoteTextTrack=function(a){a=ja(a,{tech:this});return new jb.remoteTextEl.TrackClass(a)};b.prototype.addRemoteTextTrack=function(){var a=this,b=arguments[1],c=this.createRemoteTextTrack(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});!0!==b&&!1!==b&&(Z.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),b=!0);this.remoteTextTrackEls().addTrackElement_(c);this.remoteTextTracks().addTrack(c.track);!0!==b&&this.ready(function(){return a.autoRemoteTextTracks_.addTrack(c.track)});return c};b.prototype.removeRemoteTextTrack=function(a){var b=this.remoteTextTrackEls().getTrackElementByTrack_(a);this.remoteTextTrackEls().removeTrackElement_(b);this.remoteTextTracks().removeTrack(a);this.autoRemoteTextTracks_.removeTrack(a)};b.prototype.getVideoPlaybackQuality=function(){return{}};b.prototype.setPoster=function(){};b.prototype.playsinline=function(){};b.prototype.setPlaysinline=function(){};b.prototype.canPlayType=function(){return""};b.canPlayType=function(){return""};b.canPlaySource=function(a,c){return b.canPlayType(a.type)};b.isTech=function(a){return a.prototype instanceof b||a instanceof b||a===b};b.registerTech=function(a,c){b.techs_||(b.techs_={});if(!b.isTech(c))throw Error("Tech "+a+" must be a Tech");if(!b.canPlayType)throw Error("Techs must have a static canPlayType method on them");if(!b.canPlaySource)throw Error("Techs must have a static canPlaySource method on them");a=ga(a);b.techs_[a]=c;"Tech"!==a&&b.defaultTechOrder_.push(a);return c};b.getTech=function(a){if(a){a=ga(a);if(b.techs_&&b.techs_[a])return b.techs_[a];if(G&&G.videojs&&G.videojs[a])return Z.warn("The "+a+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),G.videojs[a]}};return b}(I);ua.names.forEach(function(a){var b=ua[a];ha.prototype[b.getterName]=function(){this[b.privateName]=this[b.privateName]||new b.ListClass;return this[b.privateName]}});ha.prototype.featuresVolumeControl=!0;ha.prototype.featuresFullscreenResize=!1;ha.prototype.featuresPlaybackRate=!1;ha.prototype.featuresProgressEvents=!1;ha.prototype.featuresTimeupdateEvents=!1;ha.prototype.featuresNativeTextTracks=!1;ha.withSourceHandlers=function(a){a.registerSourceHandler=function(b,c){var d=a.sourceHandlers;d||(d=a.sourceHandlers=[]);void 0===c&&(c=d.length);d.splice(c,0,b)};a.canPlayType=function(b){for(var c=a.sourceHandlers||[],d,e=0;e<c.length;e++)if(d=c[e].canPlayType(b))return d;return""};a.selectSourceHandler=function(b,c){for(var d=a.sourceHandlers||[],e,g=0;g<d.length;g++)if(e=d[g].canHandleSource(b,c))return d[g];return null};a.canPlaySource=function(b,c){var d=a.selectSourceHandler(b,c);return d?d.canHandleSource(b,c):""};["seekable","duration"].forEach(function(a){var b=this[a];"function"===typeof b&&(this[a]=function(){return this.sourceHandler_&&this.sourceHandler_[a]?this.sourceHandler_[a].apply(this.sourceHandler_,arguments):b.apply(this,arguments)})},a.prototype);a.prototype.setSource=function(b){var c=a.selectSourceHandler(b,this.options_);c||(a.nativeSourceHandler?c=a.nativeSourceHandler:Z.error("No source hander found for the current source."));this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);c!==a.nativeSourceHandler&&(this.currentSource_=b);this.sourceHandler_=c.handleSource(b,this,this.options_);this.on("dispose",this.disposeSourceHandler)};a.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null);this.cleanupAutoTextTracks();this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};I.registerComponent("Tech",ha);ha.registerTech("Tech",ha);ha.defaultTechOrder_=[];var Ma={},Fe={buffered:1,currentTime:1,duration:1,seekable:1,played:1},Ge={setCurrentTime:1},He=function fa(a){if(Array.isArray(a)){var b=[];a.forEach(function(a){a=fa(a);Array.isArray(a)?b=b.concat(a):A(a)&&b.push(a)});a=b}else a="string"===typeof a&&a.trim()?[{src:a}]:A(a)&&"string"===typeof a.src&&a.src&&a.src.trim()?[a]:[];return a},Ie=function(a){function b(c,d,e){M(this,b);var g=ja({createEl:!1},d);e=K(this,a.call(this,c,g,e));if(d.playerOptions.sources&&0!==d.playerOptions.sources.length)c.src(d.playerOptions.sources);else for(g=0,d=d.playerOptions.techOrder;g<d.length;g++){var z=ga(d[g]),f=ha.getTech(z);z||(f=I.getComponent(z));if(f&&f.isSupported()){c.loadTech_(z);break}}return e}O(b,a);return b}(I);I.registerComponent("MediaLoader",Ie);var Bb=function(b){function c(a,d){M(this,c);var e=K(this,b.call(this,a,d));e.emitTapEvents();e.enable();return e}O(c,b);c.prototype.createEl=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"div",c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},c=u({innerHTML:'\x3cspan aria-hidden\x3d"true" class\x3d"vjs-icon-placeholder"\x3e\x3c/span\x3e',className:this.buildCSSClass(),tabIndex:0},c);"button"===a&&Z.error("Creating a ClickableComponent with an HTML element of "+a+" is not supported; use a Button instead.");d=u({role:"button","aria-live":"polite"},d);this.tabIndex_=c.tabIndex;a=b.prototype.createEl.call(this,a,c,d);this.createControlTextEl(a);return a};c.prototype.dispose=function(){this.controlTextEl_=null;b.prototype.dispose.call(this)};c.prototype.createControlTextEl=function(a){this.controlTextEl_=d("span",{className:"vjs-control-text"});a&&a.appendChild(this.controlTextEl_);this.controlText(this.controlText_,a);return this.controlTextEl_};c.prototype.controlText=function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.el();if(void 0===b)return this.controlText_||"Need Text";var d=this.localize(b);this.controlText_=b;a(this.controlTextEl_,d);this.nonIconControl||c.setAttribute("title",d)};c.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+b.prototype.buildCSSClass.call(this)};c.prototype.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!==typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))};c.prototype.disable=function(){this.enabled_=!1;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");"undefined"!==typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex");this.off(["tap","click"],this.handleClick);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur)};c.prototype.handleClick=function(a){};c.prototype.handleFocus=function(a){ia(L,"keydown",Y(this,this.handleKeyPress))};c.prototype.handleKeyPress=function(a){32===a.which||13===a.which?(a.preventDefault(),this.trigger("click")):b.prototype.handleKeyPress&&b.prototype.handleKeyPress.call(this,a)};c.prototype.handleBlur=function(a){na(L,"keydown",Y(this,this.handleKeyPress))};return c}(I);I.registerComponent("ClickableComponent",Bb);var Je=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.update();c.on("posterchange",Y(e,e.update));return e}O(b,a);b.prototype.dispose=function(){this.player().off("posterchange",this.update);a.prototype.dispose.call(this)};b.prototype.createEl=function(){var a=d("div",{className:"vjs-poster",tabIndex:-1});Sc||(this.fallbackImg_=d("img"),a.appendChild(this.fallbackImg_));return a};b.prototype.update=function(a){a=this.player().poster();this.setSrc(a);a?this.show():this.hide()};b.prototype.setSrc=function(a){if(this.fallbackImg_)this.fallbackImg_.src=a;else{var b="";a&&(b='url("'+a+'")');this.el_.style.backgroundImage=b}};b.prototype.handleClick=function(a){this.player_.controls()&&(this.player_.paused()?this.player_.play():this.player_.pause())};return b}(Bb);I.registerComponent("PosterImage",Je);var Ke={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},Le=function(a){function b(c,d,e){M(this,b);d=K(this,a.call(this,c,d,e));c.on("loadstart",Y(d,d.toggleDisplay));c.on("texttrackchange",Y(d,d.updateDisplay));c.on("loadstart",Y(d,d.preselectTrack));c.ready(Y(d,function(){if(c.tech_&&c.tech_.featuresNativeTextTracks)this.hide();else{c.on("fullscreenchange",Y(this,this.updateDisplay));for(var a=this.options_.playerOptions.tracks||[],b=0;b<a.length;b++)this.player_.addRemoteTextTrack(a[b],!0);this.preselectTrack()}}));return d}O(b,a);b.prototype.preselectTrack=function(){for(var a={captions:1,subtitles:1},b=this.player_.textTracks(),c=this.player_.cache_.selectedLanguage,d=void 0,e=void 0,g=void 0,f=0;f<b.length;f++){var r=b[f];c&&c.enabled&&c.language===r.language?r.kind===c.kind?g=r:g||(g=r):c&&!c.enabled?e=d=g=null:r["default"]&&("descriptions"!==r.kind||d?r.kind in a&&!e&&(e=r):d=r)}g?g.mode="showing":e?e.mode="showing":d&&(d.mode="showing")};b.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()};b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})};b.prototype.clearDisplay=function(){"function"===typeof G.WebVTT&&G.WebVTT.processCues(G,[],this.el_)};b.prototype.updateDisplay=function(){var a=this.player_.textTracks();this.clearDisplay();for(var b=null,c=null,d=a.length;d--;){var e=a[d];"showing"===e.mode&&("descriptions"===e.kind?b=e:c=e)}c?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(c)):b&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(b))};b.prototype.updateForTrack=function(a){if("function"===typeof G.WebVTT&&a.activeCues){for(var b=this.player_.textTrackSettings.getValues(),c=[],d=0;d<a.activeCues.length;d++)c.push(a.activeCues[d]);G.WebVTT.processCues(G,c,this.el_);for(a=c.length;a--;)if(d=c[a]){d=d.displayState;b.color&&(d.firstChild.style.color=b.color);if(b.textOpacity){var e=Ob(b.color||"#fff",b.textOpacity);try{d.firstChild.style.color=e}catch(Ta){}}b.backgroundColor&&(d.firstChild.style.backgroundColor=b.backgroundColor);if(b.backgroundOpacity){e=Ob(b.backgroundColor||"#000",b.backgroundOpacity);try{d.firstChild.style.backgroundColor=e}catch(Ta){}}if(b.windowColor)if(b.windowOpacity){e=Ob(b.windowColor,b.windowOpacity);try{d.style.backgroundColor=e}catch(Ta){}}else d.style.backgroundColor=b.windowColor;b.edgeStyle&&("dropshadow"===b.edgeStyle?d.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===b.edgeStyle?d.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===b.edgeStyle?d.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===b.edgeStyle&&(d.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222"));b.fontPercent&&1!==b.fontPercent&&(e=G.parseFloat(d.style.fontSize),d.style.fontSize=e*b.fontPercent+"px",d.style.height="auto",d.style.top="auto",d.style.bottom="2px");b.fontFamily&&"default"!==b.fontFamily&&("small-caps"===b.fontFamily?d.firstChild.style.fontVariant="small-caps":d.firstChild.style.fontFamily=Ke[b.fontFamily])}}};return b}(I);I.registerComponent("TextTrackDisplay",Le);var Me=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"})};return b}(I);I.registerComponent("LoadingSpinner",Me);var Ba=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};a="button";b=u({innerHTML:'\x3cspan aria-hidden\x3d"true" class\x3d"vjs-icon-placeholder"\x3e\x3c/span\x3e',className:this.buildCSSClass()},b);c=u({type:"button","aria-live":"polite"},c);b=I.prototype.createEl.call(this,a,b,c);this.createControlTextEl(b);return b};b.prototype.addChild=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Z.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead.");return I.prototype.addChild.call(this,a,b)};b.prototype.enable=function(){a.prototype.enable.call(this);this.el_.removeAttribute("disabled")};b.prototype.disable=function(){a.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")};b.prototype.handleKeyPress=function(b){32!==b.which&&13!==b.which&&a.prototype.handleKeyPress.call(this,b)};return b}(Bb);I.registerComponent("Button",Ba);var kd=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.mouseused_=!1;e.on("mousedown",e.handleMouseDown);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-big-play-button"};b.prototype.handleClick=function(a){var b=this.player_.play();if(!(this.mouseused_&&a.clientX&&a.clientY)){var c=(a=this.player_.getChild("controlBar"))&&a.getChild("playToggle");c?(a=function(){return c.focus()},void 0!==b&&"function"===typeof b.then?b.then(a,function(){}):this.setTimeout(a,1)):this.player_.focus()}};b.prototype.handleKeyPress=function(b){this.mouseused_=!1;a.prototype.handleKeyPress.call(this,b)};b.prototype.handleMouseDown=function(a){this.mouseused_=!0};return b}(Ba);kd.prototype.controlText_="Play Video";I.registerComponent("BigPlayButton",kd);var Ne=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.controlText(d&&d.controlText||e.localize("Close"));return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-close-button "+a.prototype.buildCSSClass.call(this)};b.prototype.handleClick=function(a){this.trigger({type:"close",bubbles:!1})};return b}(Ba);I.registerComponent("CloseButton",Ne);var ld=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on(c,"play",e.handlePlay);e.on(c,"pause",e.handlePause);e.on(c,"ended",e.handleEnded);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-play-control "+a.prototype.buildCSSClass.call(this)};b.prototype.handleClick=function(a){this.player_.paused()?this.player_.play():this.player_.pause()};b.prototype.handleSeeked=function(a){this.removeClass("vjs-ended");this.player_.paused()?this.handlePause(a):this.handlePlay(a)};b.prototype.handlePlay=function(a){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};b.prototype.handlePause=function(a){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};b.prototype.handleEnded=function(a){this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",this.handleSeeked)};return b}(Ba);ld.prototype.controlText_="Play";I.registerComponent("PlayToggle",ld);var kb=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.throttledUpdateContent=Xa(Y(e,e.updateContent),25);e.on(c,"timeupdate",e.throttledUpdateContent);return e}O(b,a);b.prototype.createEl=function(b){b=this.buildCSSClass();var c=a.prototype.createEl.call(this,"div",{className:b+" vjs-time-control vjs-control"});this.contentEl_=d("div",{className:b+"-display"},{"aria-live":"off"},d("span",{className:"vjs-control-text",textContent:this.localize(this.controlText_)}));this.updateTextNode_();c.appendChild(this.contentEl_);return c};b.prototype.dispose=function(){this.textNode_=this.contentEl_=null;a.prototype.dispose.call(this)};b.prototype.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=L.createTextNode(this.formattedTime_||"0:00");this.contentEl_.appendChild(this.textNode_)}};b.prototype.formatTime_=function(a){return Wa(a)};b.prototype.updateFormattedTime_=function(a){a=this.formatTime_(a);a!==this.formattedTime_&&(this.formattedTime_=a,this.requestAnimationFrame(this.updateTextNode_))};b.prototype.updateContent=function(a){};return b}(I);kb.prototype.controlText_="Time";I.registerComponent("TimeDisplay",kb);var md=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on(c,"ended",e.handleEnded);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-current-time"};b.prototype.updateContent=function(a){a=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(a)};b.prototype.handleEnded=function(a){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())};return b}(kb);md.prototype.controlText_="Current Time";I.registerComponent("CurrentTimeDisplay",md);var nd=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on(c,"durationchange",e.updateContent);e.on(c,"loadedmetadata",e.throttledUpdateContent);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-duration"};b.prototype.updateContent=function(a){(a=this.player_.duration())&&this.duration_!==a&&(this.duration_=a,this.updateFormattedTime_(a))};return b}(kb);nd.prototype.controlText_="Duration Time";I.registerComponent("DurationDisplay",nd);var Oe=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"\x3cdiv\x3e\x3cspan\x3e/\x3c/span\x3e\x3c/div\x3e"})};return b}(I);I.registerComponent("TimeDivider",Oe);var od=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on(c,"durationchange",e.throttledUpdateContent);e.on(c,"ended",e.handleEnded);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-remaining-time"};b.prototype.formatTime_=function(b){return"-"+a.prototype.formatTime_.call(this,b)};b.prototype.updateContent=function(a){this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))};b.prototype.handleEnded=function(a){this.player_.duration()&&this.updateFormattedTime_(0)};return b}(kb);od.prototype.controlText_="Remaining Time";I.registerComponent("RemainingTimeDisplay",od);var Pe=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.updateShowing();e.on(e.player(),"durationchange",e.updateShowing);return e}O(b,a);b.prototype.createEl=function(){var b=a.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=d("div",{className:"vjs-live-display",innerHTML:'\x3cspan class\x3d"vjs-control-text"\x3e'+this.localize("Stream Type")+"\x3c/span\x3e"+this.localize("LIVE")},{"aria-live":"off"});b.appendChild(this.contentEl_);return b};b.prototype.dispose=function(){this.contentEl_=null;a.prototype.dispose.call(this)};b.prototype.updateShowing=function(a){Infinity===this.player().duration()?this.show():this.hide()};return b}(I);I.registerComponent("LiveDisplay",Pe);var ac=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.bar=e.getChild(e.options_.barName);e.vertical(!!e.options_.vertical);e.enable();return e}O(b,a);b.prototype.enabled=function(){return this.enabled_};b.prototype.enable=function(){if(!this.enabled()){this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);this.on("click",this.handleClick);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent)this.on(this.player_,this.playerEvent,this.update);this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=!0}};b.prototype.disable=function(){if(this.enabled()){var a=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown);this.off("touchstart",this.handleMouseDown);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur);this.off("click",this.handleClick);this.off(this.player_,"controlsvisible",this.update);this.off(a,"mousemove",this.handleMouseMove);this.off(a,"mouseup",this.handleMouseUp);this.off(a,"touchmove",this.handleMouseMove);this.off(a,"touchend",this.handleMouseUp);this.removeAttribute("tabindex");this.addClass("disabled");this.playerEvent&&this.off(this.player_,this.playerEvent,this.update);this.enabled_=!1}};b.prototype.createEl=function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};c.className+=" vjs-slider";c=u({tabIndex:0},c);d=u({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},d);return a.prototype.createEl.call(this,b,c,d)};b.prototype.handleMouseDown=function(a){var b=this.bar.el_.ownerDocument;a.preventDefault();v();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(b,"mousemove",this.handleMouseMove);this.on(b,"mouseup",this.handleMouseUp);this.on(b,"touchmove",this.handleMouseMove);this.on(b,"touchend",this.handleMouseUp);this.handleMouseMove(a)};b.prototype.handleMouseMove=function(a){};b.prototype.handleMouseUp=function(){var a=this.bar.el_.ownerDocument;D();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(a,"mousemove",this.handleMouseMove);this.off(a,"mouseup",this.handleMouseUp);this.off(a,"touchmove",this.handleMouseMove);this.off(a,"touchend",this.handleMouseUp);this.update()};b.prototype.update=function(){if(this.el_){var a=this.getPercent(),b=this.bar;if(b){if("number"!==typeof a||a!==a||0>a||Infinity===a)a=0;var c=(100*a).toFixed(2)+"%",b=b.el().style;this.vertical()?b.height=c:b.width=c;return a}}};b.prototype.calculateDistance=function(a){a=S(this.el_,a);return this.vertical()?a.y:a.x};b.prototype.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};b.prototype.handleKeyPress=function(a){if(37===a.which||40===a.which)a.preventDefault(),this.stepBack();else if(38===a.which||39===a.which)a.preventDefault(),this.stepForward()};b.prototype.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};b.prototype.handleClick=function(a){a.stopImmediatePropagation();a.preventDefault()};b.prototype.vertical=function(a){if(void 0===a)return this.vertical_||!1;(this.vertical_=!!a)?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")};return b}(I);I.registerComponent("Slider",ac);var Qe=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.partEls_=[];e.on(c,"progress",e.update);return e}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'\x3cspan class\x3d"vjs-control-text"\x3e\x3cspan\x3e'+this.localize("Loaded")+"\x3c/span\x3e: 0%\x3c/span\x3e"})};b.prototype.dispose=function(){this.partEls_=null;a.prototype.dispose.call(this)};b.prototype.update=function(a){a=this.player_.buffered();var b=this.player_.duration(),c=this.player_.bufferedEnd(),e=this.partEls_,g=function(a,b){var c=a/b||0;return 100*(1<=c?1:c)+"%"};this.el_.style.width=g(c,b);for(b=0;b<a.length;b++){var f=a.start(b),z=a.end(b),r=e[b];r||(r=this.el_.appendChild(d()),e[b]=r);r.style.left=g(f,c);r.style.width=g(z-f,c)}for(c=e.length;c>a.length;c--)this.el_.removeChild(e[c-1]);e.length=a.length};return b}(I);I.registerComponent("LoadProgressBar",Qe);var Re=function(b){function c(){M(this,c);return K(this,b.apply(this,arguments))}O(c,b);c.prototype.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})};c.prototype.update=function(b,c,d){var e=B(this.el_),g=B(this.player_.el()),f=b.width*c;g&&e&&(c=b.left-g.left+f,b=b.width-f+(g.right-b.right),g=e.width/2,c<g?g+=g-c:b<g&&(g=b),0>g?g=0:g>e.width&&(g=e.width),this.el_.style.right="-"+g+"px",a(this.el_,d))};return c}(I);I.registerComponent("TimeTooltip",Re);var bc=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'\x3cspan class\x3d"vjs-control-text"\x3e\x3cspan\x3e'+this.localize("Progress")+"\x3c/span\x3e: 0%\x3c/span\x3e"})};b.prototype.update=function(a,b){var c=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_);this.rafId_=this.requestAnimationFrame(function(){var d=c.player_.scrubbing()?c.player_.getCache().currentTime:c.player_.currentTime(),d=Wa(d,c.player_.duration()),e=c.getChild("timeTooltip");e&&e.update(a,b,d)})};return b}(I);bc.prototype.options_={children:[]};Ga&&!(8<Ga)||Oa||Aa||bc.prototype.options_.children.push("timeTooltip");I.registerComponent("PlayProgressBar",bc);var pd=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.update=Xa(Y(e,e.update),25);return e}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};b.prototype.update=function(a,b){var c=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_);this.rafId_=this.requestAnimationFrame(function(){var d=c.player_.duration(),d=Wa(b*d,d);c.el_.style.left=a.width*b+"px";c.getChild("timeTooltip").update(a,b,d)})};return b}(I);pd.prototype.options_={children:["timeTooltip"]};I.registerComponent("MouseTimeDisplay",pd);var Cb=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.update=Xa(Y(e,e.update),30);e.on(c,"timeupdate",e.update);e.on(c,"ended",e.handleEnded);e.updateInterval=null;e.on(c,["playing"],function(){e.clearInterval(e.updateInterval);e.updateInterval=e.setInterval(function(){e.requestAnimationFrame(function(){e.update()})},30)});e.on(c,["ended","pause","waiting"],function(){e.clearInterval(e.updateInterval)});e.on(c,["timeupdate","ended"],e.update);return e}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})};b.prototype.update_=function(a,b){var c=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*b).toFixed(2));this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime\x3d{1} duration\x3d{2}",[Wa(a,c),Wa(c,c)],"{1} of {2}"));this.bar.update(B(this.el_),b)};b.prototype.update=function(b){b=a.prototype.update.call(this);this.update_(this.getCurrentTime_(),b);return b};b.prototype.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()};b.prototype.handleEnded=function(a){this.update_(this.player_.duration(),1)};b.prototype.getPercent=function(){var a=this.getCurrentTime_()/this.player_.duration();return 1<=a?1:a};b.prototype.handleMouseDown=function(b){W(b)&&(this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),a.prototype.handleMouseDown.call(this,b))};b.prototype.handleMouseMove=function(a){W(a)&&(a=this.calculateDistance(a)*this.player_.duration(),a===this.player_.duration()&&(a-=.1),this.player_.currentTime(a))};b.prototype.enable=function(){a.prototype.enable.call(this);var b=this.getChild("mouseTimeDisplay");b&&b.show()};b.prototype.disable=function(){a.prototype.disable.call(this);var b=this.getChild("mouseTimeDisplay");b&&b.hide()};b.prototype.handleMouseUp=function(b){a.prototype.handleMouseUp.call(this,b);this.player_.scrubbing(!1);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0});this.videoWasPlaying&&Jb(this.player_.play())};b.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)};b.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)};b.prototype.handleAction=function(a){this.player_.paused()?this.player_.play():this.player_.pause()};b.prototype.handleKeyPress=function(b){32===b.which||13===b.which?(b.preventDefault(),this.handleAction(b)):a.prototype.handleKeyPress&&a.prototype.handleKeyPress.call(this,b)};return b}(ac);Cb.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};Ga&&!(8<Ga)||Oa||Aa||Cb.prototype.options_.children.splice(1,0,"mouseTimeDisplay");Cb.prototype.playerEvent="timeupdate";I.registerComponent("SeekBar",Cb);var qd=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.handleMouseMove=Xa(Y(e,e.handleMouseMove),25);e.throttledHandleMouseSeek=Xa(Y(e,e.handleMouseSeek),25);e.enable();return e}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};b.prototype.handleMouseMove=function(a){var b=this.getChild("seekBar"),c=b.getChild("mouseTimeDisplay"),d=b.el(),b=B(d);a=S(d,a).x;1<a?a=1:0>a&&(a=0);c&&c.update(b,a)};b.prototype.handleMouseSeek=function(a){this.getChild("seekBar").handleMouseMove(a)};b.prototype.enabled=function(){return this.enabled_};b.prototype.disable=function(){this.children().forEach(function(a){return a.disable&&a.disable()});this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)};b.prototype.enable=function(){this.children().forEach(function(a){return a.enable&&a.enable()});this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)};b.prototype.handleMouseDown=function(a){a=this.el_.ownerDocument;this.on(a,"mousemove",this.throttledHandleMouseSeek);this.on(a,"touchmove",this.throttledHandleMouseSeek);this.on(a,"mouseup",this.handleMouseUp);this.on(a,"touchend",this.handleMouseUp)};b.prototype.handleMouseUp=function(a){a=this.el_.ownerDocument;this.off(a,"mousemove",this.throttledHandleMouseSeek);this.off(a,"touchmove",this.throttledHandleMouseSeek);this.off(a,"mouseup",this.handleMouseUp);this.off(a,"touchend",this.handleMouseUp)};return b}(I);qd.prototype.options_={children:["seekBar"]};I.registerComponent("ProgressControl",qd);var rd=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on(c,"fullscreenchange",e.handleFullscreenChange);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+a.prototype.buildCSSClass.call(this)};b.prototype.handleFullscreenChange=function(a){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")};b.prototype.handleClick=function(a){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()};return b}(Ba);rd.prototype.controlText_="Fullscreen";I.registerComponent("FullscreenToggle",rd);var cc=function(a,b){b.tech_&&!b.tech_.featuresVolumeControl&&a.addClass("vjs-hidden");a.on(b,"loadstart",function(){b.tech_.featuresVolumeControl?a.removeClass("vjs-hidden"):a.addClass("vjs-hidden")})},Se=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'\x3cspan class\x3d"vjs-control-text"\x3e\x3c/span\x3e'})};return b}(I);I.registerComponent("VolumeLevel",Se);var dc=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on("slideractive",e.updateLastVolume_);e.on(c,"volumechange",e.updateARIAAttributes);c.ready(function(){return e.updateARIAAttributes()});return e}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})};b.prototype.handleMouseDown=function(b){W(b)&&a.prototype.handleMouseDown.call(this,b)};b.prototype.handleMouseMove=function(a){W(a)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(a)))};b.prototype.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)};b.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()};b.prototype.stepForward=function(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};b.prototype.stepBack=function(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};b.prototype.updateARIAAttributes=function(a){a=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",a);this.el_.setAttribute("aria-valuetext",a+"%")};b.prototype.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())};b.prototype.updateLastVolume_=function(){var a=this,b=this.player_.volume();this.one("sliderinactive",function(){0===a.player_.volume()&&a.player_.lastVolume_(b)})};return b}(ac);dc.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};dc.prototype.playerEvent="volumechange";I.registerComponent("VolumeBar",dc);var sd=function(a){function b(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};M(this,b);d.vertical=d.vertical||!1;if("undefined"===typeof d.volumeBar||n(d.volumeBar))d.volumeBar=d.volumeBar||{},d.volumeBar.vertical=d.vertical;var e=K(this,a.call(this,c,d));cc(e,c);e.throttledHandleMouseMove=Xa(Y(e,e.handleMouseMove),25);e.on("mousedown",e.handleMouseDown);e.on("touchstart",e.handleMouseDown);e.on(e.volumeBar,["focus","slideractive"],function(){e.volumeBar.addClass("vjs-slider-active");e.addClass("vjs-slider-active");e.trigger("slideractive")});e.on(e.volumeBar,["blur","sliderinactive"],function(){e.volumeBar.removeClass("vjs-slider-active");e.removeClass("vjs-slider-active");e.trigger("sliderinactive")});return e}O(b,a);b.prototype.createEl=function(){var b="vjs-volume-horizontal";this.options_.vertical&&(b="vjs-volume-vertical");return a.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+b})};b.prototype.handleMouseDown=function(a){a=this.el_.ownerDocument;this.on(a,"mousemove",this.throttledHandleMouseMove);this.on(a,"touchmove",this.throttledHandleMouseMove);this.on(a,"mouseup",this.handleMouseUp);this.on(a,"touchend",this.handleMouseUp)};b.prototype.handleMouseUp=function(a){a=this.el_.ownerDocument;this.off(a,"mousemove",this.throttledHandleMouseMove);this.off(a,"touchmove",this.throttledHandleMouseMove);this.off(a,"mouseup",this.handleMouseUp);this.off(a,"touchend",this.handleMouseUp)};b.prototype.handleMouseMove=function(a){this.volumeBar.handleMouseMove(a)};return b}(I);sd.prototype.options_={children:["volumeBar"]};I.registerComponent("VolumeControl",sd);var td=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));cc(e,c);e.on(c,["loadstart","volumechange"],e.update);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-mute-control "+a.prototype.buildCSSClass.call(this)};b.prototype.handleClick=function(a){a=this.player_.volume();var b=this.player_.lastVolume_();0===a?(this.player_.volume(.1>b?.1:b),this.player_.muted(!1)):this.player_.muted(this.player_.muted()?!1:!0)};b.prototype.update=function(a){this.updateIcon_();this.updateControlText_()};b.prototype.updateIcon_=function(){var a=this.player_.volume(),b=3;0===a||this.player_.muted()?b=0:.33>a?b=1:.67>a&&(b=2);for(a=0;4>a;a++)g(this.el_,"vjs-vol-"+a);e(this.el_,"vjs-vol-"+b)};b.prototype.updateControlText_=function(){var a=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==a&&this.controlText(a)};return b}(Ba);td.prototype.controlText_="Mute";I.registerComponent("MuteToggle",td);var ud=function(a){function b(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};M(this,b);d.inline="undefined"!==typeof d.inline?d.inline:!0;if("undefined"===typeof d.volumeControl||n(d.volumeControl))d.volumeControl=d.volumeControl||{},d.volumeControl.vertical=!d.inline;d=K(this,a.call(this,c,d));cc(d,c);d.on(d.volumeControl,["slideractive"],d.sliderActive_);d.on(d.volumeControl,["sliderinactive"],d.sliderInactive_);return d}O(b,a);b.prototype.sliderActive_=function(){this.addClass("vjs-slider-active")};b.prototype.sliderInactive_=function(){this.removeClass("vjs-slider-active")};b.prototype.createEl=function(){var b="vjs-volume-panel-horizontal";this.options_.inline||(b="vjs-volume-panel-vertical");return a.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+b})};return b}(I);ud.prototype.options_={children:["muteToggle","volumeControl"]};I.registerComponent("VolumePanel",ud);var ec=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));d&&(e.menuButton_=d.menuButton);e.focusedChild_=-1;e.on("keydown",e.handleKeyPress);return e}O(b,a);b.prototype.addItem=function(a){this.addChild(a);a.on("click",Y(this,function(b){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==a.name()&&this.menuButton_.focus())}))};b.prototype.createEl=function(){this.contentEl_=d(this.options_.contentElType||"ul",{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var b=a.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});b.appendChild(this.contentEl_);ia(b,"click",function(a){a.preventDefault();a.stopImmediatePropagation()});return b};b.prototype.dispose=function(){this.contentEl_=null;a.prototype.dispose.call(this)};b.prototype.handleKeyPress=function(a){if(37===a.which||40===a.which)a.preventDefault(),this.stepForward();else if(38===a.which||39===a.which)a.preventDefault(),this.stepBack()};b.prototype.stepForward=function(){var a=0;void 0!==this.focusedChild_&&(a=this.focusedChild_+1);this.focus(a)};b.prototype.stepBack=function(){var a=0;void 0!==this.focusedChild_&&(a=this.focusedChild_-1);this.focus(a)};b.prototype.focus=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=this.children().slice();b.length&&b[0].className&&/vjs-menu-title/.test(b[0].className)&&b.shift();0<b.length&&(0>a?a=0:a>=b.length&&(a=b.length-1),this.focusedChild_=a,b[a].el_.focus())};return b}(I);I.registerComponent("Menu",ec);var fc=function(a){function c(b){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};M(this,c);var e=K(this,a.call(this,b,d));e.menuButton_=new Ba(b,d);e.menuButton_.controlText(e.controlText_);e.menuButton_.el_.setAttribute("aria-haspopup","true");d=Ba.prototype.buildCSSClass();e.menuButton_.el_.className=e.buildCSSClass()+" "+d;e.menuButton_.removeClass("vjs-control");e.addChild(e.menuButton_);e.update();e.enabled_=!0;e.on(e.menuButton_,"tap",e.handleClick);e.on(e.menuButton_,"click",e.handleClick);e.on(e.menuButton_,"focus",e.handleFocus);e.on(e.menuButton_,"blur",e.handleBlur);e.on("keydown",e.handleSubmenuKeyPress);return e}O(c,a);c.prototype.update=function(){var a=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu));this.menu=a;this.addChild(a);this.buttonPressed_=!1;this.menuButton_.el_.setAttribute("aria-expanded","false");this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()};c.prototype.createMenu=function(){var a=new ec(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var c=d("li",{className:"vjs-menu-title",innerHTML:ga(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;a.children_.unshift(c);b(c,a.contentEl())}if(this.items=this.createItems())for(c=0;c<this.items.length;c++)a.addItem(this.items[c]);return a};c.prototype.createItems=function(){};c.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})};c.prototype.buildWrapperCSSClass=function(){var b="vjs-menu-button",b=!0===this.options_.inline?b+"-inline":b+"-popup",c=Ba.prototype.buildCSSClass();return"vjs-menu-button "+b+" "+c+" "+a.prototype.buildCSSClass.call(this)};c.prototype.buildCSSClass=function(){var b="vjs-menu-button",b=!0===this.options_.inline?b+"-inline":b+"-popup";return"vjs-menu-button "+b+" "+a.prototype.buildCSSClass.call(this)};c.prototype.controlText=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(a,b)};c.prototype.handleClick=function(a){this.one(this.menu.contentEl(),"mouseleave",Y(this,function(a){this.unpressButton();this.el_.blur()}));this.buttonPressed_?this.unpressButton():this.pressButton()};c.prototype.focus=function(){this.menuButton_.focus()};c.prototype.blur=function(){this.menuButton_.blur()};c.prototype.handleFocus=function(){ia(L,"keydown",Y(this,this.handleKeyPress))};c.prototype.handleBlur=function(){na(L,"keydown",Y(this,this.handleKeyPress))};c.prototype.handleKeyPress=function(a){27===a.which||9===a.which?(this.buttonPressed_&&this.unpressButton(),9!==a.which&&(a.preventDefault(),this.menuButton_.el_.focus())):38!==a.which&&40!==a.which||this.buttonPressed_||(this.pressButton(),a.preventDefault())};c.prototype.handleSubmenuKeyPress=function(a){if(27===a.which||9===a.which)this.buttonPressed_&&this.unpressButton(),9!==a.which&&(a.preventDefault(),this.menuButton_.el_.focus())};c.prototype.pressButton=function(){this.enabled_&&(this.buttonPressed_=!0,this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Oa&&l()||this.menu.focus())};c.prototype.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","false"))};c.prototype.disable=function(){this.unpressButton();this.enabled_=!1;this.addClass("vjs-disabled");this.menuButton_.disable()};c.prototype.enable=function(){this.enabled_=!0;this.removeClass("vjs-disabled");this.menuButton_.enable()};return c}(I);I.registerComponent("MenuButton",fc);var gc=function(a){function b(c,d){M(this,b);var e=d.tracks,g=K(this,a.call(this,c,d));1>=g.items.length&&g.hide();if(!e)return K(g);var f=Y(g,g.update);e.addEventListener("removetrack",f);e.addEventListener("addtrack",f);g.player_.on("ready",f);g.player_.on("dispose",function(){e.removeEventListener("removetrack",f);e.removeEventListener("addtrack",f)});return g}O(b,a);return b}(fc);I.registerComponent("TrackButton",gc);var lb=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.selectable=d.selectable;e.selected(d.selected);e.selectable?e.el_.setAttribute("role","menuitemcheckbox"):e.el_.setAttribute("role","menuitem");return e}O(b,a);b.prototype.createEl=function(b,c,d){this.nonIconControl=!0;return a.prototype.createEl.call(this,"li",u({className:"vjs-menu-item",innerHTML:'\x3cspan class\x3d"vjs-menu-item-text"\x3e'+this.localize(this.options_.label)+"\x3c/span\x3e",tabIndex:-1},c),d)};b.prototype.handleClick=function(a){this.selected(!0)};b.prototype.selected=function(a){this.selectable&&(a?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected")):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText("")))};return b}(Bb);I.registerComponent("MenuItem",lb);var mb=function(a){function b(c,d){M(this,b);var e=d.track,g=c.textTracks();d.label=e.label||e.language||"Unknown";d.selected="showing"===e.mode;var f=K(this,a.call(this,c,d));f.track=e;var r=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];f.handleTracksChange.apply(f,b)},l=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];f.handleSelectedLanguageChange.apply(f,b)};c.on(["loadstart","texttrackchange"],r);g.addEventListener("change",r);g.addEventListener("selectedlanguagechange",l);f.on("dispose",function(){c.off(["loadstart","texttrackchange"],r);g.removeEventListener("change",r);g.removeEventListener("selectedlanguagechange",l)});if(void 0===g.onchange){var h=void 0;f.on(["tap","click"],function(){if("object"!==Sa(G.Event))try{h=new G.Event("change")}catch(cf){}h||(h=L.createEvent("Event"),h.initEvent("change",!0,!0));g.dispatchEvent(h)})}f.handleTracksChange();return f}O(b,a);b.prototype.handleClick=function(b){var c=this.track.kind,d=this.track.kinds,e=this.player_.textTracks();d||(d=[c]);a.prototype.handleClick.call(this,b);if(e)for(b=0;b<e.length;b++)c=e[b],c===this.track&&-1<d.indexOf(c.kind)?"showing"!==c.mode&&(c.mode="showing"):"disabled"!==c.mode&&(c.mode="disabled")};b.prototype.handleTracksChange=function(a){this.selected("showing"===this.track.mode)};b.prototype.handleSelectedLanguageChange=function(a){"showing"===this.track.mode&&(a=this.player_.cache_.selectedLanguage,a&&a.enabled&&a.language===this.track.language&&a.kind!==this.track.kind||(this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}))};b.prototype.dispose=function(){this.track=null;a.prototype.dispose.call(this)};return b}(lb);I.registerComponent("TextTrackMenuItem",mb);var vd=function(a){function b(c,d){M(this,b);d.track={player:c,kind:d.kind,kinds:d.kinds,"default":!1,mode:"disabled"};d.kinds||(d.kinds=[d.kind]);d.track.label=d.label?d.label:d.kinds.join(" and ")+" off";d.selectable=!0;return K(this,a.call(this,c,d))}O(b,a);b.prototype.handleTracksChange=function(a){a=this.player().textTracks();for(var b=!0,c=0,d=a.length;c<d;c++){var e=a[c];if(-1<this.options_.kinds.indexOf(e.kind)&&"showing"===e.mode){b=!1;break}}this.selected(b)};b.prototype.handleSelectedLanguageChange=function(a){a=this.player().textTracks();for(var b=!0,c=0,d=a.length;c<d;c++){var e=a[c];if(-1<["captions","descriptions","subtitles"].indexOf(e.kind)&&"showing"===e.mode){b=!1;break}}b&&(this.player_.cache_.selectedLanguage={enabled:!1})};return b}(mb);I.registerComponent("OffTextTrackMenuItem",vd);var ab=function(a){function b(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};M(this,b);d.tracks=c.textTracks();return K(this,a.call(this,c,d))}O(b,a);b.prototype.createItems=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:mb,c=void 0;this.label_&&(c=this.label_+" off");a.push(new vd(this.player_,{kinds:this.kinds_,kind:this.kind_,label:c}));this.hideThreshold_+=1;c=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var d=0;d<c.length;d++){var e=c[d];if(-1<this.kinds_.indexOf(e.kind)){var g=new b(this.player_,{track:e,selectable:!0});g.addClass("vjs-"+e.kind+"-menu-item");a.push(g)}}return a};return b}(gc);I.registerComponent("TextTrackButton",ab);var wd=function(a){function b(c,d){M(this,b);var e=d.track,g=d.cue,f=c.currentTime();d.selectable=!0;d.label=g.text;d.selected=g.startTime<=f&&f<g.endTime;f=K(this,a.call(this,c,d));f.track=e;f.cue=g;e.addEventListener("cuechange",Y(f,f.update));return f}O(b,a);b.prototype.handleClick=function(b){a.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};b.prototype.update=function(a){a=this.cue;var b=this.player_.currentTime();this.selected(a.startTime<=b&&b<a.endTime)};return b}(lb);I.registerComponent("ChaptersTrackMenuItem",wd);var hc=function(a){function b(c,d,e){M(this,b);return K(this,a.call(this,c,d,e))}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-chapters-button "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-chapters-button "+a.prototype.buildWrapperCSSClass.call(this)};b.prototype.update=function(b){this.track_&&(!b||"addtrack"!==b.type&&"removetrack"!==b.type)||this.setTrack(this.findChaptersTrack());a.prototype.update.call(this)};b.prototype.setTrack=function(a){if(this.track_!==a){this.updateHandler_||(this.updateHandler_=this.update.bind(this));if(this.track_){var b=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);b&&b.removeEventListener("load",this.updateHandler_);this.track_=null}if(this.track_=a)this.track_.mode="hidden",(a=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_))&&a.addEventListener("load",this.updateHandler_)}};b.prototype.findChaptersTrack=function(){for(var a=this.player_.textTracks()||[],b=a.length-1;0<=b;b--){var c=a[b];if(c.kind===this.kind_)return c}};b.prototype.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(ga(this.kind_))};b.prototype.createMenu=function(){this.options_.title=this.getMenuCaption();return a.prototype.createMenu.call(this)};b.prototype.createItems=function(){var a=[];if(!this.track_)return a;var b=this.track_.cues;if(!b)return a;for(var c=0,d=b.length;c<d;c++){var e=new wd(this.player_,{track:this.track_,cue:b[c]});a.push(e)}return a};return b}(ab);hc.prototype.kind_="chapters";hc.prototype.controlText_="Chapters";I.registerComponent("ChaptersButton",hc);var ic=function(a){function b(c,d,e){M(this,b);d=K(this,a.call(this,c,d,e));var g=c.textTracks(),f=Y(d,d.handleTracksChange);g.addEventListener("change",f);d.on("dispose",function(){g.removeEventListener("change",f)});return d}O(b,a);b.prototype.handleTracksChange=function(a){a=this.player().textTracks();for(var b=!1,c=0,d=a.length;c<d;c++){var e=a[c];if(e.kind!==this.kind_&&"showing"===e.mode){b=!0;break}}b?this.disable():this.enable()};b.prototype.buildCSSClass=function(){return"vjs-descriptions-button "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+a.prototype.buildWrapperCSSClass.call(this)};return b}(ab);ic.prototype.kind_="descriptions";ic.prototype.controlText_="Descriptions";I.registerComponent("DescriptionsButton",ic);var jc=function(a){function b(c,d,e){M(this,b);return K(this,a.call(this,c,d,e))}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+a.prototype.buildWrapperCSSClass.call(this)};return b}(ab);jc.prototype.kind_="subtitles";jc.prototype.controlText_="Subtitles";I.registerComponent("SubtitlesButton",jc);var kc=function(a){function b(c,d){M(this,b);d.track={player:c,kind:d.kind,label:d.kind+" settings",selectable:!1,"default":!1,mode:"disabled"};d.selectable=!1;d.name="CaptionSettingsMenuItem";var e=K(this,a.call(this,c,d));e.addClass("vjs-texttrack-settings");e.controlText(", opens "+d.kind+" settings dialog");return e}O(b,a);b.prototype.handleClick=function(a){this.player().getChild("textTrackSettings").open()};return b}(mb);I.registerComponent("CaptionSettingsMenuItem",kc);var lc=function(a){function b(c,d,e){M(this,b);return K(this,a.call(this,c,d,e))}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-captions-button "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-captions-button "+a.prototype.buildWrapperCSSClass.call(this)};b.prototype.createItems=function(){var b=[];this.player().tech_&&this.player().tech_.featuresNativeTextTracks||(b.push(new kc(this.player_,{kind:this.kind_})),this.hideThreshold_+=1);return a.prototype.createItems.call(this,b)};return b}(ab);lc.prototype.kind_="captions";lc.prototype.controlText_="Captions";I.registerComponent("CaptionsButton",lc);var xd=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(b,c,d){var e='\x3cspan class\x3d"vjs-menu-item-text"\x3e'+this.localize(this.options_.label);"captions"===this.options_.track.kind&&(e+='\n        \x3cspan aria-hidden\x3d"true" class\x3d"vjs-icon-placeholder"\x3e\x3c/span\x3e\n        \x3cspan class\x3d"vjs-control-text"\x3e '+this.localize("Captions")+"\x3c/span\x3e\n      ");return a.prototype.createEl.call(this,b,u({innerHTML:e+"\x3c/span\x3e"},c),d)};return b}(mb);I.registerComponent("SubsCapsMenuItem",xd);var mc=function(a){function b(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};M(this,b);d=K(this,a.call(this,c,d));d.label_="subtitles";-1<["en","en-us","en-ca","fr-ca"].indexOf(d.player_.language_)&&(d.label_="captions");d.menuButton_.controlText(ga(d.label_));return d}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-subs-caps-button "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+a.prototype.buildWrapperCSSClass.call(this)};b.prototype.createItems=function(){var b=[];this.player().tech_&&this.player().tech_.featuresNativeTextTracks||(b.push(new kc(this.player_,{kind:this.label_})),this.hideThreshold_+=1);return b=a.prototype.createItems.call(this,b,xd)};return b}(ab);mc.prototype.kinds_=["captions","subtitles"];mc.prototype.controlText_="Subtitles";I.registerComponent("SubsCapsButton",mc);var yd=function(a){function b(c,d){M(this,b);var e=d.track,g=c.audioTracks();d.label=e.label||e.language||"Unknown";d.selected=e.enabled;var f=K(this,a.call(this,c,d));f.track=e;var r=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];f.handleTracksChange.apply(f,b)};g.addEventListener("change",r);f.on("dispose",function(){g.removeEventListener("change",r)});return f}O(b,a);b.prototype.handleClick=function(b){var c=this.player_.audioTracks();a.prototype.handleClick.call(this,b);for(b=0;b<c.length;b++){var d=c[b];d.enabled=d===this.track}};b.prototype.handleTracksChange=function(a){this.selected(this.track.enabled)};return b}(lb);I.registerComponent("AudioTrackMenuItem",yd);var zd=function(a){function b(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};M(this,b);d.tracks=c.audioTracks();return K(this,a.call(this,c,d))}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-audio-button "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-audio-button "+a.prototype.buildWrapperCSSClass.call(this)};b.prototype.createItems=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.hideThreshold_=1;for(var b=this.player_.audioTracks(),c=0;c<b.length;c++)a.push(new yd(this.player_,{track:b[c],selectable:!0}));return a};return b}(gc);zd.prototype.controlText_="Audio Track";I.registerComponent("AudioTrackButton",zd);var nc=function(a){function b(c,d){M(this,b);var e=d.rate,g=parseFloat(e,10);d.label=e;d.selected=1===g;d.selectable=!0;var f=K(this,a.call(this,c,d));f.label=e;f.rate=g;f.on(c,"ratechange",f.update);return f}O(b,a);b.prototype.handleClick=function(b){a.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};b.prototype.update=function(a){this.selected(this.player().playbackRate()===this.rate)};return b}(lb);nc.prototype.contentElType="button";I.registerComponent("PlaybackRateMenuItem",nc);var Ad=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.updateVisibility();e.updateLabel();e.on(c,"loadstart",e.updateVisibility);e.on(c,"ratechange",e.updateLabel);return e}O(b,a);b.prototype.createEl=function(){var b=a.prototype.createEl.call(this);this.labelEl_=d("div",{className:"vjs-playback-rate-value",innerHTML:"1x"});b.appendChild(this.labelEl_);return b};b.prototype.dispose=function(){this.labelEl_=null;a.prototype.dispose.call(this)};b.prototype.buildCSSClass=function(){return"vjs-playback-rate "+a.prototype.buildCSSClass.call(this)};b.prototype.buildWrapperCSSClass=function(){return"vjs-playback-rate "+a.prototype.buildWrapperCSSClass.call(this)};b.prototype.createMenu=function(){var a=new ec(this.player()),b=this.playbackRates();if(b)for(var c=b.length-1;0<=c;c--)a.addChild(new nc(this.player(),{rate:b[c]+"x"}));return a};b.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};b.prototype.handleClick=function(a){a=this.player().playbackRate();for(var b=this.playbackRates(),c=b[0],d=0;d<b.length;d++)if(b[d]>a){c=b[d];break}this.player().playbackRate(c)};b.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates};b.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length};b.prototype.updateVisibility=function(a){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")};b.prototype.updateLabel=function(a){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")};return b}(fc);Ad.prototype.controlText_="Playback Rate";I.registerComponent("PlaybackRateMenuButton",Ad);var Bd=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-spacer "+a.prototype.buildCSSClass.call(this)};b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};return b}(I);I.registerComponent("Spacer",Bd);var Te=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+a.prototype.buildCSSClass.call(this)};b.prototype.createEl=function(){var b=a.prototype.createEl.call(this,{className:this.buildCSSClass()});b.innerHTML="\u00a0";return b};return b}(Bd);I.registerComponent("CustomControlSpacer",Te);var Cd=function(a){function b(){M(this,b);return K(this,a.apply(this,arguments))}O(b,a);b.prototype.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"},{role:"group"})};return b}(I);Cd.prototype.options_={children:"playToggle volumePanel currentTimeDisplay timeDivider durationDisplay progressControl liveDisplay remainingTimeDisplay customControlSpacer playbackRateMenuButton chaptersButton descriptionsButton subsCapsButton audioTrackButton fullscreenToggle".split(" ")};I.registerComponent("ControlBar",Cd);var Dd=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d));e.on(c,"error",e.open);return e}O(b,a);b.prototype.buildCSSClass=function(){return"vjs-error-display "+a.prototype.buildCSSClass.call(this)};b.prototype.content=function(){var a=this.player().error();return a?this.localize(a.message):""};return b}(Za);Dd.prototype.options_=ja(Za.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});I.registerComponent("ErrorDisplay",Dd);var Ed=["#000","Black"],Fd=["#00F","Blue"],Gd=["#0FF","Cyan"],Hd=["#0F0","Green"],Id=["#F0F","Magenta"],Jd=["#F00","Red"],Kd=["#FFF","White"],Ld=["#FF0","Yellow"],oc=["1","Opaque"],pc=["0.5","Semi-Transparent"],Md=["0","Transparent"],Pa={backgroundColor:{selector:".vjs-bg-color \x3e select",id:"captions-background-color-%s",label:"Color",options:[Ed,Kd,Jd,Hd,Fd,Ld,Id,Gd]},backgroundOpacity:{selector:".vjs-bg-opacity \x3e select",id:"captions-background-opacity-%s",label:"Transparency",options:[oc,pc,Md]},color:{selector:".vjs-fg-color \x3e select",id:"captions-foreground-color-%s",label:"Color",options:[Kd,Ed,Jd,Hd,Fd,Ld,Id,Gd]},edgeStyle:{selector:".vjs-edge-style \x3e select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family \x3e select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent \x3e select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],"default":2,parser:function(a){return"1.00"===a?null:Number(a)}},textOpacity:{selector:".vjs-text-opacity \x3e select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[oc,pc]},windowColor:{selector:".vjs-window-color \x3e select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity \x3e select",id:"captions-window-opacity-%s",label:"Transparency",options:[Md,pc,oc]}};Pa.windowColor.options=Pa.backgroundColor.options;var Ue=function(a){function b(c,e){M(this,b);e.temporary=!1;var g=K(this,a.call(this,c,e));g.updateDisplay=Y(g,g.updateDisplay);g.fill();g.hasBeenOpened_=g.hasBeenFilled_=!0;g.endDialog=d("p",{className:"vjs-control-text",textContent:g.localize("End of dialog window.")});g.el().appendChild(g.endDialog);g.setDefaults();void 0===e.persistTextTrackSettings&&(g.options_.persistTextTrackSettings=g.options_.playerOptions.persistTextTrackSettings);g.on(g.$(".vjs-done-button"),"click",function(){g.saveSettings();g.close()});g.on(g.$(".vjs-default-button"),"click",function(){g.setDefaults();g.updateDisplay()});y(Pa,function(a){g.on(g.$(a.selector),"change",g.updateDisplay)});g.options_.persistTextTrackSettings&&g.restoreSettings();return g}O(b,a);b.prototype.dispose=function(){this.endDialog=null;a.prototype.dispose.call(this)};b.prototype.createElSelect_=function(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"label",e=Pa[a],g=e.id.replace("%s",this.id_);return["\x3c"+d+' id\x3d"'+g+'" class\x3d"'+("label"===d?"vjs-label":"")+'"\x3e',this.localize(e.label),"\x3c/"+d+"\x3e",'\x3cselect aria-labelledby\x3d"'+(""!==c?c+" ":"")+g+'"\x3e'].concat(e.options.map(function(a){var d=g+"-"+a[1];return['\x3coption id\x3d"'+d+'" value\x3d"'+a[0]+'" ','aria-labelledby\x3d"'+(""!==c?c+" ":"")+g+" "+d+'"\x3e',b.localize(a[1]),"\x3c/option\x3e"].join("")})).concat("\x3c/select\x3e").join("")};b.prototype.createElFgColor_=function(){var a="captions-text-legend-"+this.id_;return['\x3cfieldset class\x3d"vjs-fg-color vjs-track-setting"\x3e','\x3clegend id\x3d"'+a+'"\x3e',this.localize("Text"),"\x3c/legend\x3e",this.createElSelect_("color",a),'\x3cspan class\x3d"vjs-text-opacity vjs-opacity"\x3e',this.createElSelect_("textOpacity",a),"\x3c/span\x3e\x3c/fieldset\x3e"].join("")};b.prototype.createElBgColor_=function(){var a="captions-background-"+this.id_;return['\x3cfieldset class\x3d"vjs-bg-color vjs-track-setting"\x3e','\x3clegend id\x3d"'+a+'"\x3e',this.localize("Background"),"\x3c/legend\x3e",this.createElSelect_("backgroundColor",a),'\x3cspan class\x3d"vjs-bg-opacity vjs-opacity"\x3e',this.createElSelect_("backgroundOpacity",a),"\x3c/span\x3e\x3c/fieldset\x3e"].join("")};b.prototype.createElWinColor_=function(){var a="captions-window-"+this.id_;return['\x3cfieldset class\x3d"vjs-window-color vjs-track-setting"\x3e','\x3clegend id\x3d"'+a+'"\x3e',this.localize("Window"),"\x3c/legend\x3e",this.createElSelect_("windowColor",a),'\x3cspan class\x3d"vjs-window-opacity vjs-opacity"\x3e',this.createElSelect_("windowOpacity",a),"\x3c/span\x3e\x3c/fieldset\x3e"].join("")};b.prototype.createElColors_=function(){return d("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})};b.prototype.createElFont_=function(){return d("div",{className:'vjs-track-settings-font"\x3e',innerHTML:['\x3cfieldset class\x3d"vjs-font-percent vjs-track-setting"\x3e',this.createElSelect_("fontPercent","","legend"),'\x3c/fieldset\x3e\x3cfieldset class\x3d"vjs-edge-style vjs-track-setting"\x3e',this.createElSelect_("edgeStyle","","legend"),'\x3c/fieldset\x3e\x3cfieldset class\x3d"vjs-font-family vjs-track-setting"\x3e',this.createElSelect_("fontFamily","","legend"),"\x3c/fieldset\x3e"].join("")})};b.prototype.createElControls_=function(){var a=this.localize("restore all settings to the default values");return d("div",{className:"vjs-track-settings-controls",innerHTML:['\x3cbutton class\x3d"vjs-default-button" title\x3d"'+a+'"\x3e',this.localize("Reset"),'\x3cspan class\x3d"vjs-control-text"\x3e '+a+"\x3c/span\x3e","\x3c/button\x3e",'\x3cbutton class\x3d"vjs-done-button"\x3e'+this.localize("Done")+"\x3c/button\x3e"].join("")})};b.prototype.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]};b.prototype.label=function(){return this.localize("Caption Settings Dialog")};b.prototype.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")};b.prototype.buildCSSClass=function(){return a.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"};b.prototype.getValues=function(){var a=this;return p(Pa,function(b,c,d){var e=a.$(c.selector);c=Gc(e.options[e.options.selectedIndex].value,c.parser);void 0!==c&&(b[d]=c);return b},{})};b.prototype.setValues=function(a){var b=this;y(Pa,function(c,d){var e=b.$(c.selector),g=a[d],f=c.parser;if(g)for(var r=0;r<e.options.length;r++)if(Gc(e.options[r].value,f)===g){e.selectedIndex=r;break}})};b.prototype.setDefaults=function(){var a=this;y(Pa,function(b){var c=b.hasOwnProperty("default")?b["default"]:0;a.$(b.selector).selectedIndex=c})};b.prototype.restoreSettings=function(){var a=void 0;try{a=JSON.parse(G.localStorage.getItem("vjs-text-track-settings"))}catch(Fa){Z.warn(Fa)}a&&this.setValues(a)};b.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var a=this.getValues();try{Object.keys(a).length?G.localStorage.setItem("vjs-text-track-settings",JSON.stringify(a)):G.localStorage.removeItem("vjs-text-track-settings")}catch(Fa){Z.warn(Fa)}}};b.prototype.updateDisplay=function(){var a=this.player_.getChild("textTrackDisplay");a&&a.updateDisplay()};b.prototype.conditionalBlur_=function(){this.previouslyActiveEl_=null;this.off(L,"keydown",this.handleKeyDown);var a=this.player_.controlBar,b=a&&a.subsCapsButton,a=a&&a.captionsButton;b?b.focus():a&&a.focus()};return b}(Za);I.registerComponent("TextTrackSettings",Ue);var Ve=Sb(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]),N=function(a){function b(c,d){M(this,b);var e=K(this,a.call(this,c,d)),g=c.source,f=!1;g&&(e.el_.currentSrc!==g.src||c.tag&&3===c.tag.initNetworkState_)?e.setSource(g):e.handleLateInit_(e.el_);if(e.el_.hasChildNodes()){for(var r=e.el_.childNodes,l=r.length,g=[];l--;){var h=r[l];"track"===h.nodeName.toLowerCase()&&(e.featuresNativeTextTracks?(e.remoteTextTrackEls().addTrackElement_(h),e.remoteTextTracks().addTrack(h.track),e.textTracks().addTrack(h.track),f||e.el_.hasAttribute("crossorigin")||!Ab(h.src)||(f=!0)):g.push(h))}for(r=0;r<g.length;r++)e.el_.removeChild(g[r])}e.proxyNativeTracks_();e.featuresNativeTextTracks&&f&&Z.warn(Hb(Ve));e.restoreMetadataTracksInIOSNativePlayer_();(tb||Qb||Nc)&&!0===c.nativeControlsForTouch&&e.setControls(!0);e.proxyWebkitFullscreen_();e.triggerReady();return e}O(b,a);b.prototype.dispose=function(){b.disposeMediaElement(this.el_);this.options_=null;a.prototype.dispose.call(this)};b.prototype.restoreMetadataTracksInIOSNativePlayer_=function(){var a=this.textTracks(),b=void 0,c=function(){b=[];for(var c=0;c<a.length;c++){var d=a[c];"metadata"===d.kind&&b.push({track:d,storedMode:d.mode})}};c();a.addEventListener("change",c);this.on("dispose",function(){return a.removeEventListener("change",c)});var d=function Ta(){for(var c=0;c<b.length;c++){var d=b[c];"disabled"===d.track.mode&&d.track.mode!==d.storedMode&&(d.track.mode=d.storedMode)}a.removeEventListener("change",Ta)};this.on("webkitbeginfullscreen",function(){a.removeEventListener("change",c);a.removeEventListener("change",d);a.addEventListener("change",d)});this.on("webkitendfullscreen",function(){a.removeEventListener("change",c);a.addEventListener("change",c);a.removeEventListener("change",d)})};b.prototype.proxyNativeTracks_=function(){var a=this;xa.names.forEach(function(b){b=xa[b];var c=a.el()[b.getterName],d=a[b.getterName]();if(a["featuresNative"+b.capitalName+"Tracks"]&&c&&c.addEventListener){var e={change:function(a){d.trigger({type:"change",target:d,currentTarget:d,srcElement:d})},addtrack:function(a){d.addTrack(a.track)},removetrack:function(a){d.removeTrack(a.track)}},g=function(){for(var a=[],b=0;b<d.length;b++){for(var e=!1,g=0;g<c.length;g++)if(c[g]===d[b]){e=!0;break}e||a.push(d[b])}for(;a.length;)d.removeTrack(a.shift())};Object.keys(e).forEach(function(b){var d=e[b];c.addEventListener(b,d);a.on("dispose",function(a){return c.removeEventListener(b,d)})});a.on("loadstart",g);a.on("dispose",function(b){return a.off("loadstart",g)})}})};b.prototype.createEl=function(){var a=this.options_.tag;if(!a||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(a){var c=a.cloneNode(!0);a.parentNode&&a.parentNode.insertBefore(c,a);b.disposeMediaElement(a);a=c}else a=L.createElement("video"),c=this.options_.tag&&C(this.options_.tag),c=ja({},c),tb&&!0===this.options_.nativeControlsForTouch||delete c.controls,E(a,u(c,{id:this.options_.techId,"class":"vjs-tech"}));a.playerId=this.options_.playerId}"undefined"!==typeof this.options_.preload&&a.setAttribute("preload",this.options_.preload);for(var c=["loop","muted","playsinline","autoplay"],d=0;d<c.length;d++){var e=c[d],g=this.options_[e];"undefined"!==typeof g&&(g?a.setAttribute(e,e):a.removeAttribute(e),a[e]=g)}return a};b.prototype.handleLateInit_=function(a){if(0!==a.networkState&&3!==a.networkState)if(0===a.readyState){var b=!1,c=function(){b=!0};this.on("loadstart",c);var d=function(){b||this.trigger("loadstart")};this.on("loadedmetadata",d);this.ready(function(){this.off("loadstart",c);this.off("loadedmetadata",d);b||this.trigger("loadstart")})}else{var e=["loadstart"];e.push("loadedmetadata");2<=a.readyState&&e.push("loadeddata");3<=a.readyState&&e.push("canplay");4<=a.readyState&&e.push("canplaythrough");this.ready(function(){e.forEach(function(a){this.trigger(a)},this)})}};b.prototype.setCurrentTime=function(a){try{this.el_.currentTime=a}catch(Fa){Z(Fa,"Video is not ready. (Video.js)")}};b.prototype.duration=function(){var a=this;return Infinity===this.el_.duration&&Aa&&gb&&0===this.el_.currentTime?(this.on("timeupdate",function ea(){0<a.el_.currentTime&&(Infinity===a.el_.duration&&a.trigger("durationchange"),a.off("timeupdate",ea))}),NaN):this.el_.duration||NaN};b.prototype.width=function(){return this.el_.offsetWidth};b.prototype.height=function(){return this.el_.offsetHeight};b.prototype.proxyWebkitFullscreen_=function(){var a=this;if("webkitDisplayingFullscreen"in this.el_){var b=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},c=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",b),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",c);this.on("dispose",function(){a.off("webkitbeginfullscreen",c);a.off("webkitendfullscreen",b)})}};b.prototype.supportsFullScreen=function(){if("function"===typeof this.el_.webkitEnterFullScreen){var a=G.navigator&&G.navigator.userAgent||"";if(/Android/.test(a)||!/Chrome|Mac OS X 10.5/.test(a))return!0}return!1};b.prototype.enterFullScreen=function(){var a=this.el_;a.paused&&a.networkState<=a.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){a.pause();a.webkitEnterFullScreen()},0)):a.webkitEnterFullScreen()};b.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()};b.prototype.src=function(a){if(void 0===a)return this.el_.src;this.setSrc(a)};b.prototype.reset=function(){b.resetMediaElement(this.el_)};b.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc};b.prototype.setControls=function(a){this.el_.controls=!!a};b.prototype.addTextTrack=function(b,c,d){return this.featuresNativeTextTracks?this.el_.addTextTrack(b,c,d):a.prototype.addTextTrack.call(this,b,c,d)};b.prototype.createRemoteTextTrack=function(b){if(!this.featuresNativeTextTracks)return a.prototype.createRemoteTextTrack.call(this,b);var c=L.createElement("track");b.kind&&(c.kind=b.kind);b.label&&(c.label=b.label);if(b.language||b.srclang)c.srclang=b.language||b.srclang;b["default"]&&(c["default"]=b["default"]);b.id&&(c.id=b.id);b.src&&(c.src=b.src);return c};b.prototype.addRemoteTextTrack=function(b,c){var d=a.prototype.addRemoteTextTrack.call(this,b,c);this.featuresNativeTextTracks&&this.el().appendChild(d);return d};b.prototype.removeRemoteTextTrack=function(b){a.prototype.removeRemoteTextTrack.call(this,b);if(this.featuresNativeTextTracks)for(var c=this.$$("track"),d=c.length;d--;)b!==c[d]&&b!==c[d].track||this.el().removeChild(c[d])};b.prototype.getVideoPlaybackQuality=function(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var a={};"undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount&&(a.droppedVideoFrames=this.el().webkitDroppedFrameCount,a.totalVideoFrames=this.el().webkitDecodedFrameCount);G.performance&&"function"===typeof G.performance.now?a.creationTime=G.performance.now():G.performance&&G.performance.timing&&"number"===typeof G.performance.timing.navigationStart&&(a.creationTime=G.Date.now()-G.performance.timing.navigationStart);return a};return b}(ha);if(m()){N.TEST_VID=L.createElement("video");var Db=L.createElement("track");Db.kind="captions";Db.srclang="en";Db.label="English";N.TEST_VID.appendChild(Db)}N.isSupported=function(){try{N.TEST_VID.volume=.5}catch(fa){return!1}return!(!N.TEST_VID||!N.TEST_VID.canPlayType)};N.canPlayType=function(a){return N.TEST_VID.canPlayType(a)};N.canPlaySource=function(a,b){return N.canPlayType(a.type)};N.canControlVolume=function(){try{var a=N.TEST_VID.volume;N.TEST_VID.volume=a/2+.1;return a!==N.TEST_VID.volume}catch(R){return!1}};N.canControlPlaybackRate=function(){if(Aa&&gb&&58>Pc)return!1;try{var a=N.TEST_VID.playbackRate;N.TEST_VID.playbackRate=a/2+.1;return a!==N.TEST_VID.playbackRate}catch(R){return!1}};N.supportsNativeTextTracks=function(){return Rc};N.supportsNativeVideoTracks=function(){return!(!N.TEST_VID||!N.TEST_VID.videoTracks)};N.supportsNativeAudioTracks=function(){return!(!N.TEST_VID||!N.TEST_VID.audioTracks)};N.Events="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange resize volumechange".split(" ");N.prototype.featuresVolumeControl=N.canControlVolume();N.prototype.featuresPlaybackRate=N.canControlPlaybackRate();N.prototype.movingMediaElementInDOM=!Oa;N.prototype.featuresFullscreenResize=!0;N.prototype.featuresProgressEvents=!0;N.prototype.featuresTimeupdateEvents=!0;N.prototype.featuresNativeTextTracks=N.supportsNativeTextTracks();N.prototype.featuresNativeVideoTracks=N.supportsNativeVideoTracks();N.prototype.featuresNativeAudioTracks=N.supportsNativeAudioTracks();var qc=N.TEST_VID&&N.TEST_VID.constructor.prototype.canPlayType,We=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,Xe=/^video\/mp4/i;N.patchCanPlayType=function(){4<=sb&&!Oc?N.TEST_VID.constructor.prototype.canPlayType=function(a){return a&&We.test(a)?"maybe":qc.call(this,a)}:Mc&&(N.TEST_VID.constructor.prototype.canPlayType=function(a){return a&&Xe.test(a)?"maybe":qc.call(this,a)})};N.unpatchCanPlayType=function(){var a=N.TEST_VID.constructor.prototype.canPlayType;N.TEST_VID.constructor.prototype.canPlayType=qc;return a};N.patchCanPlayType();N.disposeMediaElement=function(a){if(a){for(a.parentNode&&a.parentNode.removeChild(a);a.hasChildNodes();)a.removeChild(a.firstChild);a.removeAttribute("src");if("function"===typeof a.load)try{a.load()}catch(R){}}};N.resetMediaElement=function(a){if(a){for(var b=a.querySelectorAll("source"),c=b.length;c--;)a.removeChild(b[c]);a.removeAttribute("src");if("function"===typeof a.load)try{a.load()}catch(Fa){}}};"muted defaultMuted autoplay controls loop playsinline".split(" ").forEach(function(a){N.prototype[a]=function(){return this.el_[a]||this.el_.hasAttribute(a)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(a){N.prototype["set"+ga(a)]=function(b){(this.el_[a]=b)?this.el_.setAttribute(a,a):this.el_.removeAttribute(a)}});"paused currentTime buffered volume poster preload error seeking seekable ended playbackRate defaultPlaybackRate played networkState readyState videoWidth videoHeight".split(" ").forEach(function(a){N.prototype[a]=function(){return this.el_[a]}});"volume src poster preload playbackRate defaultPlaybackRate".split(" ").forEach(function(a){N.prototype["set"+ga(a)]=function(b){this.el_[a]=b}});["pause","load","play"].forEach(function(a){N.prototype[a]=function(){return this.el_[a]()}});ha.withSourceHandlers(N);N.nativeSourceHandler={};N.nativeSourceHandler.canPlayType=function(a){try{return N.TEST_VID.canPlayType(a)}catch(R){return""}};N.nativeSourceHandler.canHandleSource=function(a,b){if(a.type)return N.nativeSourceHandler.canPlayType(a.type);if(a.src){var c=ed(a.src);return N.nativeSourceHandler.canPlayType("video/"+c)}return""};N.nativeSourceHandler.handleSource=function(a,b,c){b.setSrc(a.src)};N.nativeSourceHandler.dispose=function(){};N.registerSourceHandler(N.nativeSourceHandler);ha.registerTech("Html5",N);var Ye=Sb(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "],["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]),Nd="progress abort suspend emptied stalled loadedmetadata loadeddata timeupdate ratechange resize volumechange texttrackchange".split(" "),ka=function(a){function d(b,c,e){M(this,d);b.id=b.id||"vjs_video_"+Ja++;c=u(d.getTagSettings(b),c);c.initChildren=!1;c.createEl=!1;c.evented=!1;c.reportTouchActivity=!1;if(!c.language)if("function"===typeof b.closest){var g=b.closest("[lang]");g&&g.getAttribute&&(c.language=g.getAttribute("lang"))}else for(g=b;g&&1===g.nodeType;){if(C(g).hasOwnProperty("lang")){c.language=g.getAttribute("lang");break}g=g.parentNode}e=K(this,a.call(this,null,c,e));e.isReady_=!1;e.hasStarted_=!1;e.userActive_=!1;if(!e.options_||!e.options_.techOrder||!e.options_.techOrder.length)throw Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");e.tag=b;e.tagAttributes=b&&C(b);e.language(e.options_.language);if(c.languages){var f={};Object.getOwnPropertyNames(c.languages).forEach(function(a){f[a.toLowerCase()]=c.languages[a]});e.languages_=f}else e.languages_=d.prototype.options_.languages;e.cache_={};e.poster_=c.poster||"";e.controls_=!!c.controls;e.cache_.lastVolume=1;b.controls=!1;b.removeAttribute("controls");e.scrubbing_=!1;e.el_=e.createEl();Ra(e,{eventBusKey:"el_"});g=ja(e.options_);if(c.plugins){var r=c.plugins;Object.keys(r).forEach(function(a){if("function"===typeof this[a])this[a](r[a]);else throw Error('plugin "'+a+'" does not exist');},e)}e.options_.playerOptions=g;e.middleware_=[];e.initChildren();e.isAudio("audio"===b.nodeName.toLowerCase());e.controls()?e.addClass("vjs-controls-enabled"):e.addClass("vjs-controls-disabled");e.el_.setAttribute("role","region");e.isAudio()?e.el_.setAttribute("aria-label",e.localize("Audio Player")):e.el_.setAttribute("aria-label",e.localize("Video Player"));e.isAudio()&&e.addClass("vjs-audio");e.flexNotSupported_()&&e.addClass("vjs-no-flex");Oa||e.addClass("vjs-workinghover");d.players[e.id_]=e;e.addClass("vjs-v6");e.userActive(!0);e.reportUserActivity();e.listenForUserActivity_();e.on("fullscreenchange",e.handleFullscreenChange_);e.on("stageclick",e.handleStageClick_);e.changingSrc_=!1;e.playWaitingForReady_=!1;e.playOnLoadstart_=null;e.forceAutoplayInChrome_();return e}O(d,a);d.prototype.dispose=function(){this.trigger("dispose");this.off("dispose");this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null);d.players[this.id_]=null;this.tag&&this.tag.player&&(this.tag.player=null);this.el_&&this.el_.player&&(this.el_.player=null);this.tech_&&this.tech_.dispose();this.playerElIngest_&&(this.playerElIngest_=null);this.tag&&(this.tag=null);a.prototype.dispose.call(this)};d.prototype.createEl=function(){var d=this.tag,g=void 0,f=this.playerElIngest_=d.parentNode&&d.parentNode.hasAttribute&&d.parentNode.hasAttribute("data-vjs-player"),r="video-js"===this.tag.tagName.toLowerCase();f?g=this.el_=d.parentNode:r||(g=this.el_=a.prototype.createEl.call(this,"div"));var l=C(d);if(r){g=this.el_=d;for(d=this.tag=L.createElement("video");g.children.length;)d.appendChild(g.firstChild);c(g,"video-js")||e(g,"video-js");g.appendChild(d);f=this.playerElIngest_=g}d.setAttribute("tabindex","-1");d.removeAttribute("width");d.removeAttribute("height");Object.getOwnPropertyNames(l).forEach(function(a){"class"===a?(g.className+=" "+l[a],r&&(d.className+=" "+l[a])):(g.setAttribute(a,l[a]),r&&d.setAttribute(a,l[a]))});d.playerId=d.id;d.id+="_html5_api";d.className="vjs-tech";d.player=g.player=this;this.addClass("vjs-paused");if(!0!==G.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Vc("vjs-styles-dimensions");var h=Na(".vjs-styles-defaults"),m=Na("head");m.insertBefore(this.styleEl_,h?h.nextSibling:m.firstChild)}this.width(this.options_.width);this.height(this.options_.height);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);h=d.getElementsByTagName("a");for(m=0;m<h.length;m++){var v=h.item(m);e(v,"vjs-hidden");v.setAttribute("hidden","hidden")}d.initNetworkState_=d.networkState;d.parentNode&&!f&&d.parentNode.insertBefore(g,d);b(d,g);this.children_.unshift(d);this.el_.setAttribute("lang",this.language_);return this.el_=g};d.prototype.width=function(a,b){return this.dimension("width",a,b)};d.prototype.height=function(a,b){return this.dimension("height",a,b)};d.prototype.dimension=function(a,b,c){var d=a+"_";if(void 0===b)return this[d]||0;if(""===b)this[d]=void 0,this.updateStyleEl_();else{var e=parseFloat(b);isNaN(e)?Z.error('Improper value "'+b+'" supplied for for '+a):(this[d]=e,this.updateStyleEl_(),this.isReady_&&!c&&this.trigger("playerresize"))}};d.prototype.fluid=function(a){if(void 0===a)return!!this.fluid_;this.fluid_=!!a;a?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid");this.updateStyleEl_()};d.prototype.aspectRatio=function(a){if(void 0===a)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(a))throw Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=a;this.fluid(!0);this.updateStyleEl_()};d.prototype.updateStyleEl_=function(){if(!0===G.VIDEOJS_NO_DYNAMIC_STYLE){var a="number"===typeof this.width_?this.width_:this.options_.width,b="number"===typeof this.height_?this.height_:this.options_.height,c=this.tech_&&this.tech_.el();c&&(0<=a&&(c.width=a),0<=b&&(c.height=b))}else{var a=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),d=a[1]/a[0],a=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/d:this.videoWidth()||300,b=void 0!==this.height_?this.height_:a*d,c=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions";this.addClass(c);Wc(this.styleEl_,"\n      ."+c+" {\n        width: "+a+"px;\n        height: "+b+"px;\n      }\n\n      ."+c+".vjs-fluid {\n        padding-top: "+100*d+"%;\n      }\n    ")}};d.prototype.loadTech_=function(a,c){var d=this;this.tech_&&this.unloadTech_();var e=ga(a),g=a.charAt(0).toLowerCase()+a.slice(1);"Html5"!==e&&this.tag&&(ha.getTech("Html5").disposeMediaElement(this.tag),this.tag=this.tag.player=null);this.techName_=e;this.isReady_=!1;var f={source:c,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+e+"_api",autoplay:this.options_.autoplay,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"]};ua.names.forEach(function(a){a=ua[a];f[a.getterName]=d[a.privateName]});u(f,this.options_[e]);u(f,this.options_[g]);u(f,this.options_[a.toLowerCase()]);this.tag&&(f.tag=this.tag);c&&c.src===this.cache_.src&&0<this.cache_.currentTime&&(f.startTime=this.cache_.currentTime);g=ha.getTech(a);if(!g)throw Error("No Tech named '"+e+"' exists! '"+e+"' should be registered using videojs.registerTech()'");this.tech_=new g(f);this.tech_.ready(Y(this,this.handleTechReady_),!0);ad.jsonToTextTracks(this.textTracksJson_||[],this.tech_);Nd.forEach(function(a){d.on(d.tech_,a,d["handleTech"+ga(a)+"_"])});this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"canplay",this.handleTechCanPlay_);this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_);this.on(this.tech_,"playing",this.handleTechPlaying_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"seeked",this.handleTechSeeked_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.usingNativeControls(this.techGet_("controls"));this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_();this.tech_.el().parentNode===this.el()||"Html5"===e&&this.tag||b(this.tech_.el(),this.el());this.tag&&(this.tag=this.tag.player=null)};d.prototype.unloadTech_=function(){var a=this;ua.names.forEach(function(b){b=ua[b];a[b.privateName]=a[b.getterName]()});this.textTracksJson_=ad.textTracksToJson(this.tech_);this.isReady_=!1;this.tech_.dispose();this.tech_=!1};d.prototype.tech=function(a){void 0===a&&Z.warn(Hb(Ye));return this.tech_};d.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)};d.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_)};d.prototype.handleTechReady_=function(){this.triggerReady();this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume);this.handleTechPosterChange_();this.handleTechDurationChange_();if((this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused())try{delete this.tag.poster}catch(z){Z("deleting tag.poster throws in some browsers",z)}};d.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"))};d.prototype.hasStarted=function(a){if(void 0===a)return this.hasStarted_;a!==this.hasStarted_&&((this.hasStarted_=a)?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))};d.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(!0);this.trigger("play")};d.prototype.handleTechWaiting_=function(){var a=this;this.addClass("vjs-waiting");this.trigger("waiting");this.one("timeupdate",function(){return a.removeClass("vjs-waiting")})};d.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting");this.trigger("canplay")};d.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};d.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting");this.trigger("playing")};d.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking");this.trigger("seeking")};d.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking");this.trigger("seeked")};d.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&(Z.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime));this.addClass("vjs-has-started");this.trigger("firstplay")};d.prototype.handleTechPause_=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};d.prototype.handleTechEnded_=function(){this.addClass("vjs-ended");this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause();this.trigger("ended")};d.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))};d.prototype.handleTechClick_=function(a){W(a)&&this.controls_&&(this.paused()?this.play():this.pause())};d.prototype.handleTechTap_=function(){this.userActive(!this.userActive())};d.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()};d.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()};d.prototype.handleTechTouchEnd_=function(a){a.preventDefault()};d.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")};d.prototype.handleStageClick_=function(){this.reportUserActivity()};d.prototype.handleTechFullscreenChange_=function(a,b){b&&this.isFullscreen(b.isFullscreen);this.trigger("fullscreenchange")};d.prototype.handleTechError_=function(){var a=this.tech_.error();this.error(a)};d.prototype.handleTechTextData_=function(){var a=null;1<arguments.length&&(a=arguments[1]);this.trigger("textdata",a)};d.prototype.getCache=function(){return this.cache_};d.prototype.techCall_=function(a,b){this.ready(function(){if(a in Ge)return this.tech_[a](this.middleware_.reduce(Fc(a),b));try{if(this.tech_)this.tech_[a](b)}catch(ea){throw Z(ea),ea;}},!0)};d.prototype.techGet_=function(a){if(this.tech_&&this.tech_.isReady_){if(a in Fe){var b=this.tech_;return this.middleware_.reduceRight(Fc(a),b[a]())}try{return this.tech_[a]()}catch(ea){if(void 0===this.tech_[a])throw Z("Video.js: "+a+" method not defined for "+this.techName_+" playback technology.",ea),ea;if("TypeError"===ea.name)throw Z("Video.js: "+a+" unavailable on "+this.techName_+" playback technology element.",ea),this.tech_.isReady_=!1,ea;Z(ea);throw ea;}}};d.prototype.play=function(){var a=this;this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_);if(this.isReady_)if(this.changingSrc_||!this.src()&&!this.currentSrc())this.playOnLoadstart_=function(){a.playOnLoadstart_=null;Jb(a.play())},this.one("loadstart",this.playOnLoadstart_);else return this.techGet_("play");else this.playWaitingForReady_||(this.playWaitingForReady_=!0,this.ready(function(){a.playWaitingForReady_=!1;Jb(a.play())}))};d.prototype.pause=function(){this.techCall_("pause")};d.prototype.paused=function(){return!1===this.techGet_("paused")?!1:!0};d.prototype.played=function(){return this.techGet_("played")||La(0,0)};d.prototype.scrubbing=function(a){if("undefined"===typeof a)return this.scrubbing_;this.scrubbing_=!!a;a?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")};d.prototype.currentTime=function(a){if("undefined"!==typeof a)0>a&&(a=0),this.techCall_("setCurrentTime",a);else return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime};d.prototype.duration=function(a){if(void 0===a)return void 0!==this.cache_.duration?this.cache_.duration:NaN;a=parseFloat(a);0>a&&(a=Infinity);a!==this.cache_.duration&&(this.cache_.duration=a,Infinity===a?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange"))};d.prototype.remainingTime=function(){return this.duration()-this.currentTime()};d.prototype.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())};d.prototype.buffered=function(){var a=this.techGet_("buffered");a&&a.length||(a=La(0,0));return a};d.prototype.bufferedPercent=function(){return xc(this.buffered(),this.duration())};d.prototype.bufferedEnd=function(){var a=this.buffered(),b=this.duration(),a=a.end(a.length-1);a>b&&(a=b);return a};d.prototype.volume=function(a){if(void 0!==a)a=Math.max(0,Math.min(1,parseFloat(a))),this.cache_.volume=a,this.techCall_("setVolume",a),0<a&&this.lastVolume_(a);else return a=parseFloat(this.techGet_("volume")),isNaN(a)?1:a};d.prototype.muted=function(a){if(void 0!==a)this.techCall_("setMuted",a);else return this.techGet_("muted")||!1};d.prototype.defaultMuted=function(a){return void 0!==a?this.techCall_("setDefaultMuted",a):this.techGet_("defaultMuted")||!1};d.prototype.lastVolume_=function(a){if(void 0!==a&&0!==a)this.cache_.lastVolume=a;else return this.cache_.lastVolume};d.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1};d.prototype.isFullscreen=function(a){if(void 0!==a)this.isFullscreen_=!!a;else return!!this.isFullscreen_};d.prototype.requestFullscreen=function(){this.isFullscreen(!0);Ha.requestFullscreen?(ia(L,Ha.fullscreenchange,Y(this,function Fa(a){this.isFullscreen(L[Ha.fullscreenElement]);!1===this.isFullscreen()&&na(L,Ha.fullscreenchange,Fa);this.trigger("fullscreenchange")})),this.el_[Ha.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))};d.prototype.exitFullscreen=function(){this.isFullscreen(!1);if(Ha.requestFullscreen)L[Ha.exitFullscreen]();else this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))};d.prototype.enterFullWindow=function(){this.isFullWindow=!0;this.docOrigOverflow=L.documentElement.style.overflow;ia(L,"keydown",Y(this,this.fullWindowOnEscKey));L.documentElement.style.overflow="hidden";e(L.body,"vjs-full-window");this.trigger("enterFullWindow")};d.prototype.fullWindowOnEscKey=function(a){27===a.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())};d.prototype.exitFullWindow=function(){this.isFullWindow=!1;na(L,"keydown",this.fullWindowOnEscKey);L.documentElement.style.overflow=this.docOrigOverflow;g(L.body,"vjs-full-window");this.trigger("exitFullWindow")};d.prototype.canPlayType=function(a){for(var b,c=0,d=this.options_.techOrder;c<d.length;c++){b=d[c];var e=ha.getTech(b);e||(e=I.getComponent(b));if(!e)Z.error('The "'+b+'" tech is undefined. Skipped browser support check for that tech.');else if(e.isSupported()&&(b=e.canPlayType(a)))return b}return""};d.prototype.selectSource=function(a){var b=this,c=this.options_.techOrder.map(function(a){return[a,ha.getTech(a)]}).filter(function(a){var b=a[0];if(a=a[1])return a.isSupported();Z.error('The "'+b+'" tech is undefined. Skipped browser support check for that tech.');return!1}),d=function(a,b,c){var d=void 0;a.some(function(a){return b.some(function(b){if(d=c(a,b))return!0})});return d},e=void 0,e=function(a){return function(b,c){return a(c,b)}},g=function(a,c){var d=a[0];if(a[1].canPlaySource(c,b.options_[d.toLowerCase()]))return{source:c,tech:d}};return(e=this.options_.sourceOrder?d(a,c,e(g)):d(c,a,g))||!1};d.prototype.src=function(a){var b=this;if("undefined"===typeof a)return this.cache_.src||"";var c=He(a);c.length?(this.cache_.sources=c,this.changingSrc_=!0,this.cache_.source=c[0],ie(this,c[0],function(a,d){b.middleware_=d;if(b.src_(a)){if(1<c.length)return b.src(c.slice(1));b.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);b.triggerReady()}else b.changingSrc_=!1,b.cache_.src=a.src,je(d,b.tech_)})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)};d.prototype.src_=function(a){var b=this.selectSource([a]);if(!b)return!0;if(!Pd(b.tech,this.techName_))return this.changingSrc_=!0,this.loadTech_(b.tech,b.source),!1;this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",a):this.techCall_("src",a.src);"auto"===this.options_.preload&&this.load()},!0);return!1};d.prototype.load=function(){this.techCall_("load")};d.prototype.reset=function(){this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset")};d.prototype.currentSources=function(){var a=this.currentSource(),b=[];0!==Object.keys(a).length&&b.push(a);return this.cache_.sources||b};d.prototype.currentSource=function(){return this.cache_.source||{}};d.prototype.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""};d.prototype.currentType=function(){return this.currentSource()&&this.currentSource().type||""};d.prototype.preload=function(a){if(void 0!==a)this.techCall_("setPreload",a),this.options_.preload=a;else return this.techGet_("preload")};d.prototype.autoplay=function(a){if(void 0!==a)this.techCall_("setAutoplay",a),this.options_.autoplay=a,this.ready(this.forceAutoplayInChrome_);else return this.techGet_("autoplay",a)};d.prototype.forceAutoplayInChrome_=function(){this.paused()&&(this.autoplay()||this.options_.autoplay)&&gb&&!Aa&&this.play()};d.prototype.playsinline=function(a){return void 0!==a?(this.techCall_("setPlaysinline",a),this.options_.playsinline=a,this):this.techGet_("playsinline")};d.prototype.loop=function(a){if(void 0!==a)this.techCall_("setLoop",a),this.options_.loop=a;else return this.techGet_("loop")};d.prototype.poster=function(a){if(void 0===a)return this.poster_;a||(a="");this.poster_=a;this.techCall_("setPoster",a);this.trigger("posterchange")};d.prototype.handleTechPosterChange_=function(){!this.poster_&&this.tech_&&this.tech_.poster&&(this.poster_=this.tech_.poster()||"",this.trigger("posterchange"))};d.prototype.controls=function(a){if(void 0===a)return!!this.controls_;a=!!a;this.controls_!==a&&(this.controls_=a,this.usingNativeControls()&&this.techCall_("setControls",a),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))};d.prototype.usingNativeControls=function(a){if(void 0===a)return!!this.usingNativeControls_;a=!!a;this.usingNativeControls_!==a&&((this.usingNativeControls_=a)?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))};d.prototype.error=function(a){if(void 0===a)return this.error_||null;null===a?(this.error_=a,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close()):(this.error_=new oa(a),this.addClass("vjs-error"),Z.error("(CODE:"+this.error_.code+" "+oa.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"))};d.prototype.reportUserActivity=function(a){this.userActivity_=!0};d.prototype.userActive=function(a){if(void 0===a)return this.userActive_;a=!!a;if(a!==this.userActive_)if(this.userActive_=a)this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");else{if(this.tech_)this.tech_.one("mousemove",function(a){a.stopPropagation();a.preventDefault()});this.userActivity_=!1;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")}};d.prototype.listenForUserActivity_=function(){var a=void 0,b=void 0,c=void 0,d=Y(this,this.reportUserActivity);this.on("mousedown",function(){d();this.clearInterval(a);a=this.setInterval(d,250)});this.on("mousemove",function(a){if(a.screenX!==b||a.screenY!==c)b=a.screenX,c=a.screenY,d()});this.on("mouseup",function(b){d();this.clearInterval(a)});this.on("keydown",d);this.on("keyup",d);var e=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1;this.userActive(!0);this.clearTimeout(e);var a=this.options_.inactivityTimeout;0>=a||(e=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},a))}},250)};d.prototype.playbackRate=function(a){if(void 0!==a)this.techCall_("setPlaybackRate",a);else return this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("playbackRate"):1};d.prototype.defaultPlaybackRate=function(a){return void 0!==a?this.techCall_("setDefaultPlaybackRate",a):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1};d.prototype.isAudio=function(a){if(void 0!==a)this.isAudio_=!!a;else return!!this.isAudio_};d.prototype.addTextTrack=function(a,b,c){if(this.tech_)return this.tech_.addTextTrack(a,b,c)};d.prototype.addRemoteTextTrack=function(a,b){if(this.tech_)return this.tech_.addRemoteTextTrack(a,b)};d.prototype.removeRemoteTextTrack=function(){var a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).track,a=void 0===a?arguments[0]:a;if(this.tech_)return this.tech_.removeRemoteTextTrack(a)};d.prototype.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")};d.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};d.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};d.prototype.language=function(a){if(void 0===a)return this.language_;this.language_=String(a).toLowerCase()};d.prototype.languages=function(){return ja(d.prototype.options_.languages,this.languages_)};d.prototype.toJSON=function(){var a=ja(this.options_),b=a.tracks;a.tracks=[];for(var c=0;c<b.length;c++){var d=b[c],d=ja(d);d.player=void 0;a.tracks[c]=d}return a};d.prototype.createModal=function(a,b){var c=this;b=b||{};b.content=a||"";var d=new Za(this,b);this.addChild(d);d.on("dispose",function(){c.removeChild(d)});d.open();return d};d.getTagSettings=function(a){var b={sources:[],tracks:[]},d=C(a),e=d["data-setup"];c(a,"vjs-fluid")&&(d.fluid=!0);if(null!==e){var g,f=null;try{g=JSON.parse(e||"{}",void 0)}catch(Ka){f=Ka}g=[f,g];e=g[0];g=g[1];e&&Z.error(e);u(d,g)}u(b,d);if(a.hasChildNodes())for(a=a.childNodes,d=0,e=a.length;d<e;d++)g=a[d],f=g.nodeName.toLowerCase(),"source"===f?b.sources.push(C(g)):"track"===f&&b.tracks.push(C(g));return b};d.prototype.flexNotSupported_=function(){var a=L.createElement("i");return!("flexBasis"in a.style||"webkitFlexBasis"in a.style||"mozFlexBasis"in a.style||"msFlexBasis"in a.style||"msFlexOrder"in a.style)};return d}(I);ua.names.forEach(function(a){var b=ua[a];ka.prototype[b.getterName]=function(){if(this.tech_)return this.tech_[b.getterName]();this[b.privateName]=this[b.privateName]||new b.ListClass;return this[b.privateName]}});ka.players={};var nb=G.navigator;ka.prototype.options_={techOrder:ha.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2E3,playbackRates:[],children:"mediaLoader posterImage textTrackDisplay loadingSpinner bigPlayButton controlBar errorDisplay textTrackSettings".split(" "),language:nb&&(nb.languages&&nb.languages[0]||nb.userLanguage||nb.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."};["ended","seeking","seekable","networkState","readyState"].forEach(function(a){ka.prototype[a]=function(){return this.techGet_(a)}});Nd.forEach(function(a){ka.prototype["handleTech"+ga(a)+"_"]=function(){return this.trigger(a)}});I.registerComponent("Player",ka);var Ca={},Eb=function(a){return Ca.hasOwnProperty(a)?Ca[a]:void 0},Fb=function(a,b,c){c=(c?"before":"")+"pluginsetup";a.trigger(c,b);a.trigger(c+":"+b.name,b)},Ze=function(a,b){var c=function(){Fb(this,{name:a,plugin:b,instance:null},!0);var c=b.apply(this,arguments);this.activePlugins_=this.activePlugins_||{};this.activePlugins_[a]=!0;Fb(this,{name:a,plugin:b,instance:c});return c};Object.keys(b).forEach(function(a){c[a]=b[a]});return c},Od=function(a,b){b.prototype.name=a;return function(){Fb(this,{name:a,plugin:b,instance:null},!0);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];var g=new (Function.prototype.bind.apply(b,[null].concat([this].concat(d))));this[a]=function(){return g};Fb(this,g.getEventHash());return g}},Da=function(){function a(b){M(this,a);if(this.constructor===a)throw Error("Plugin must be sub-classed; not directly instantiated.");this.player=b;Ra(this);delete this.trigger;bb(this,this.constructor.defaultState);var c=this.name;b.activePlugins_=b.activePlugins_||{};b.activePlugins_[c]=!0;this.dispose=Y(this,this.dispose);b.on("dispose",this.dispose)}a.prototype.version=function(){return this.constructor.VERSION};a.prototype.getEventHash=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a.name=this.name;a.plugin=this.constructor;a.instance=this;return a};a.prototype.trigger=function(a){return sa(this.eventBusEl_,a,this.getEventHash(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))};a.prototype.handleStateChanged=function(a){};a.prototype.dispose=function(){var a=this.name,b=this.player;this.trigger("dispose");this.off();b.off("dispose",this.dispose);b.activePlugins_[a]=!1;this.player=this.state=null;b[a]=Od(a,Ca[a])};a.isBasic=function(b){b="string"===typeof b?Eb(b):b;return"function"===typeof b&&!a.prototype.isPrototypeOf(b.prototype)};a.registerPlugin=function(b,c){if("string"!==typeof b)throw Error('Illegal plugin name, "'+b+'", must be a string, was '+("undefined"===typeof b?"undefined":Sa(b))+".");if(Ca.hasOwnProperty(b))Z.warn('A plugin named "'+b+'" already exists. You may want to avoid re-registering plugins!');else if(ka.prototype.hasOwnProperty(b))throw Error('Illegal plugin name, "'+b+'", cannot share a name with an existing player method!');if("function"!==typeof c)throw Error('Illegal plugin for "'+b+'", must be a function, was '+("undefined"===typeof c?"undefined":Sa(c))+".");Ca[b]=c;"plugin"!==b&&(a.isBasic(c)?ka.prototype[b]=Ze(b,c):ka.prototype[b]=Od(b,c));return c};a.deregisterPlugin=function(a){if("plugin"===a)throw Error("Cannot de-register base plugin.");Ca.hasOwnProperty(a)&&(delete Ca[a],delete ka.prototype[a])};a.getPlugins=function(){var a=void 0;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(Ca)).forEach(function(b){var c=Eb(b);c&&(a=a||{},a[b]=c)});return a};a.getPluginVersion=function(a){return(a=Eb(a))&&a.VERSION||""};return a}();Da.getPlugin=Eb;Da.BASE_PLUGIN_NAME="plugin";Da.registerPlugin("plugin",Da);ka.prototype.usingPlugin=function(a){return!!this.activePlugins_&&!0===this.activePlugins_[a]};ka.prototype.hasPlugin=function(a){return!!Ca.hasOwnProperty(a)};var $e=function(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof b?"undefined":Sa(b)));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(a.super_=b)};"undefined"===typeof HTMLVideoElement&&m()&&(L.createElement("video"),L.createElement("audio"),L.createElement("track"),L.createElement("video-js"));P.hooks_={};P.hooks=function(a,b){P.hooks_[a]=P.hooks_[a]||[];b&&(P.hooks_[a]=P.hooks_[a].concat(b));return P.hooks_[a]};P.hook=function(a,b){P.hooks(a,b)};P.hookOnce=function(a,b){P.hooks(a,[].concat(b).map(function(b){return function ea(){P.removeHook(a,ea);return b.apply(void 0,arguments)}}))};P.removeHook=function(a,b){var c=P.hooks(a).indexOf(b);if(-1>=c)return!1;P.hooks_[a]=P.hooks_[a].slice();P.hooks_[a].splice(c,1);return!0};if(!0!==G.VIDEOJS_NO_DYNAMIC_STYLE&&m()){var Gb=Na(".vjs-styles-defaults");if(!Gb){var Gb=Vc("vjs-styles-defaults"),rc=Na("head");rc&&rc.insertBefore(Gb,rc.firstChild);Wc(Gb,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}Qa(1,P);P.VERSION="6.6.3";P.options=ka.prototype.options_;P.getPlayers=function(){return ka.players};P.players=ka.players;P.getComponent=I.getComponent;P.registerComponent=function(a,b){ha.isTech(b)&&Z.warn("The "+a+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)");I.registerComponent.call(I,a,b)};P.getTech=ha.getTech;P.registerTech=ha.registerTech;P.use=function(a,b){Ma[a]=Ma[a]||[];Ma[a].push(b)};P.browser=ne;P.TOUCH_ENABLED=tb;P.extend=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=function(){a.apply(this,arguments)},d={};"object"===("undefined"===typeof b?"undefined":Sa(b))?(b.constructor!==Object.prototype.constructor&&(c=b.constructor),d=b):"function"===typeof b&&(c=b);$e(c,a);for(var e in d)d.hasOwnProperty(e)&&(c.prototype[e]=d[e]);return c};P.mergeOptions=ja;P.bind=Y;P.registerPlugin=Da.registerPlugin;P.plugin=function(a,b){Z.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return Da.registerPlugin(a,b)};P.getPlugins=Da.getPlugins;P.getPlugin=Da.getPlugin;P.getPluginVersion=Da.getPluginVersion;P.addLanguage=function(a,b){var c;a=(""+a).toLowerCase();P.options.languages=ja(P.options.languages,(c={},c[a]=b,c));return P.options.languages[a]};P.log=Z;P.createTimeRange=P.createTimeRanges=La;P.formatTime=Wa;P.parseUrl=Zb;P.isCrossOrigin=Ab;P.EventTarget=ma;P.on=ia;P.one=Ea;P.off=na;P.trigger=sa;P.xhr=za;P.TextTrack=ib;P.AudioTrack=hd;P.VideoTrack=id;"isEl isTextNode createEl hasClass addClass removeClass toggleClass setAttributes getAttributes emptyEl appendContent insertContent".split(" ").forEach(function(a){P[a]=function(){Z.warn("videojs."+a+"() is deprecated; use videojs.dom."+a+"() instead");return Uc[a].apply(null,arguments)}});P.computedStyle=q;P.dom=Uc;P.url=xe;return P});!function(){!function(t){(t=t&&t.videojs)&&(t.CDN_VERSION="6.6.3")}(window);(function(t,y,p,u,A,n,q){y&&!1!==y.HELP_IMPROVE_VIDEOJS&&(.01<A.random()||(n=y.location,q=y.videojs||{},t.src="//www.google-analytics.com/__utm.gif?utmwv\x3d5.4.2\x26utmac\x3dUA-16505296-3\x26utmn\x3d1\x26utmhn\x3d"+u(n.hostname)+"\x26utmsr\x3d"+y.screen.availWidth+"x"+y.screen.availHeight+"\x26utmul\x3d"+(p.language||p.userLanguage||"").toLowerCase()+"\x26utmr\x3d"+u(n.href)+"\x26utmp\x3d"+u(n.hostname+n.pathname)+"\x26utmcc\x3d__utma%3D1."+A.floor(1E10*A.random())+".1.1.1.1%3B\x26utme\x3d8(vjsv*cdnv)9("+q.VERSION+"*"+q.CDN_VERSION+")"))})(new Image,window,navigator,encodeURIComponent,Math)}();
!function(t){function y(u){if(p[u])return p[u].exports;var A=p[u]={i:u,l:!1,exports:{}};return t[u].call(A.exports,A,A.exports,y),A.l=!0,A.exports}var p={};y.m=t;y.c=p;y.d=function(p,A,n){y.o(p,A)||Object.defineProperty(p,A,{enumerable:!0,get:n})};y.r=function(p){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"});Object.defineProperty(p,"__esModule",{value:!0})};y.t=function(p,A){if((1&A&&(p=y(p)),8&A)||4&A&&"object"==typeof p&&p&&p.__esModule)return p;var n=Object.create(null);if(y.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:p}),2&A&&"string"!=typeof p)for(var q in p)y.d(n,q,function(n){return p[n]}.bind(null,q));return n};y.n=function(p){var A=p&&p.__esModule?function(){return p["default"]}:function(){return p};return y.d(A,"a",A),A};y.o=function(p,A){return Object.prototype.hasOwnProperty.call(p,A)};y.p="";y(y.s=0)}([function(t,y,p){y=p(1);window.videojs&&(y.registerConfigPlugin(window.videojs),y.registerSourceHandler(window.videojs));t.exports={register:y.registerSourceHandler}},function(t,y,p){function u(n){n&&(this.srOptions_||(this.srOptions_={}),this.srOptions_.hlsjsConfig||(this.srOptions_.hlsjsConfig=n.hlsjsConfig),this.srOptions_.captionConfig||(this.srOptions_.captionConfig=n.captionConfig))}var A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n=p(2);t.exports={registerSourceHandler:function(q){function x(l,f){function d(a){1===x[n.ErrorTypes.MEDIA_ERROR]?B.recoverMediaError():2===x[n.ErrorTypes.MEDIA_ERROR]?(B.swapAudioCodec(),B.recoverMediaError()):2<x[n.ErrorTypes.MEDIA_ERROR]&&(f.error=function(){return a},f.trigger("error"))}function a(a){B.nextLevel=a}function b(a,b){if("boolean"==typeof b){this[a]._enabled=b;for(var c=!0,d=0;d<this.length;d++)if(!this[d]._enabled){c=!1;break}if(c)B.currentLevel=-1;else{for(c=this.length-1;0<=c&&!this[c]._enabled;c--);B.currentLevel=c}}return this[a]._enabled}function c(){if(Q){var b=[];1<Q.levels.length&&b.push({id:-1,label:"auto",selected:-1===B.manualLevel});Q.levels.forEach(function(a,c){var d={};d.id=c;d.selected=c===B.manualLevel;d.label=a.height?a.height+"p":a.width?Math.round(9*a.width/16)+"p":a.bitrate?a.bitrate/1E3+"kbps":0;b.push(d)});f.trigger("loadedqualitydata",{qualityData:{video:b},qualitySwitchCallback:a});F.removeEventListener("playing",c)}}function e(){for(var a=f.audioTracks(),b=0;b<a.length;b++)if(a[b].enabled){B.audioTrack=b;break}}function g(){var a=B.audioTracks,b=f.audioTracks();if(1<a.length&&0===b.length){for(var c=0;c<a.length;c++)b.addTrack(new q.AudioTrack({id:c,kind:"alternative",label:a[c].name||a[c].lang,language:a[c].lang,enabled:c===B.audioTrack}));b.addEventListener("change",e)}}function r(a,b){return(a.label?a.label:a.language)===(b.label?b.label:b.language)&&a.kind===b.kind}function h(){for(var a=J.textTracks(),b=null,c=0;c<a.length;c++)if("showing"===a[c].mode){b=a[c];break}a=F.textTracks;for(c=0;c<a.length;c++)"subtitles"!==a[c].kind&&"captions"!==a[c].kind||(a[c].mode=b&&r(a[c],b)?"showing":"disabled")}function C(){B.startLoad(-1);F.removeEventListener("play",C)}function v(){for(var a=F.textTracks,b=[],c=0;c<a.length;c++)"subtitles"!==a[c].kind&&"captions"!==a[c].kind||b.push(a[c]);a=J.textTracks();for(c=0;c<b.length;c++){for(var d=!1,e=0;e<a.length;e++)if(r(b[c],a[e])){d=!0;break}d||(d=b[c],J.addRemoteTextTrack({kind:d.kind,label:d.label?d.label:d.language,language:d.language,srclang:d.language},!1))}h();V||(a.addEventListener("change",h),V=!0)}function D(a,c){if(Q=c){var d=J.qualityLevels&&J.qualityLevels();if(d)for(var e=0;e<Q.levels.length;e++){var g=Q.levels[e],g={id:e,width:g.width,height:g.height,bandwidth:g.bitrate,bitrate:g.bitrate,_enabled:!0};g.enabled=b.bind(d,e);d.addQualityLevel(g)}}}f.name_="StreamrootHlsjs";var B,F=f.el(),x={},p=null,Q=null,H=null,t=null,u=null,y=null,J=q(f.options_.playerId),V=!1;this.duration=function(){return p||F.duration||0};this.seekable=function(){return B.media?H?q.createTimeRanges(Math.round(B.media.duration-t),Math.round(B.media.duration-u)):q.createTimeRanges(0,B.media.duration):q.createTimeRanges()};this.dispose=function(){F.removeEventListener("play",C);F.textTracks.removeEventListener("addtrack",v);F.removeEventListener("playing",c);J.textTracks().removeEventListener("change",h);V=!1;J.audioTracks().removeEventListener("change",e);B.destroy()};F.addEventListener("error",function(a){a=a.currentTarget.error;switch(a.code){case a.MEDIA_ERR_ABORTED:break;case a.MEDIA_ERR_DECODE:d(a);break;case a.MEDIA_ERR_NETWORK:case a.MEDIA_ERR_SRC_NOT_SUPPORTED:break;default:a.message}});(function(){var a=J.srOptions_&&J.srOptions_.hlsjsConfig||f.options_.hlsjsConfig;y=a?function(a){for(var b={},c=Object.keys(a),d=0;d<c.length;d++)b[c[d]]=a[c[d]];return b}(a):{};-1!==["","auto"].indexOf(F.preload)||F.autoplay||void 0!==y.autoStartLoad||(y.autoStartLoad=!1);var b=J.srOptions_&&J.srOptions_.captionConfig||f.options_.captionConfig;b&&(y.cueHandler={newCue:function(a,c,d,e){for(var g,f,r=window.VTTCue||window.TextTrackCue,l=0;l<e.rows.length;l++)if(f="",!(g=e.rows[l]).isEmpty()){for(var h=0;h<g.chars.length;h++)f+=g.chars[h].uchar;if(g=new r(c,d,f.trim()),null!=b&&"object"===(void 0===b?"undefined":A(b)))for(f=Object.keys(b),h=0;h<f.length;h++)g[f[h]]=b[f[h]];a.addCue(g);d===c&&a.addCue(new r(d+5,""))}}});!1===y.autoStartLoad&&F.addEventListener("play",C);F.addEventListener("playing",c);B=new n(y);(function(a){if(void 0!==m[a])for(var b=0;b<m[a].length;b++)m[a][b](J,B)})("beforeinitialize");B.on(n.Events.ERROR,function(a,b){!function(a,b){var c={message:"HLS.js error: "+b.type+" - fatal: "+b.fatal+" - "+b.details};if(x[b.type]?x[b.type]+=1:x[b.type]=1,b.fatal)switch(b.type){case n.ErrorTypes.NETWORK_ERROR:c.code=2;f.error=function(){return c};f.trigger("error");break;case n.ErrorTypes.MEDIA_ERROR:c.code=3;d(c);break;default:B.destroy(),f.error=function(){return c},f.trigger("error")}}(0,b)});B.on(n.Events.AUDIO_TRACKS_UPDATED,g);B.on(n.Events.MANIFEST_PARSED,D);B.on(n.Events.LEVEL_LOADED,function(a,b){y.liveSyncDuration?u=y.liveSyncDuration:y.liveSyncDurationCount&&(u=y.liveSyncDurationCount*b.details.targetduration);H=b.details.live;t=b.details.totalduration;p=H?1/0:b.details.totalduration});B.attachMedia(F);F.textTracks.addEventListener("addtrack",v);B.loadSource(l.src)})()}var m={};if(x.addHook=function(l,f){m[l]=m[l]||[];m[l].push(f)},x.removeHook=function(l,f){if(void 0===m[l])return!1;var d=m[l].indexOf(f);return-1!==d&&(m[l].splice(d,1),!0)},n.isSupported()){var h;if("function"==typeof q.getTech)h=q.getTech("Html5");else{if("function"!=typeof q.getComponent)return;h=q.getComponent("Html5")}h&&(h.registerSourceHandler({canHandleSource:function(l){return/^application\/x-mpegURL|application\/vnd\.apple\.mpegurl$/i.test(l.type)?"probably":/\.m3u8/i.test(l.src)?"maybe":""},handleSource:function(l,f){return f.hlsProvider&&f.hlsProvider.dispose(),f.hlsProvider=new x(l,f),f.hlsProvider}},0),q.Html5Hlsjs=x)}},registerConfigPlugin:function(n){(n.registerPlugin||n.plugin)("streamrootHls",u)}}},function(t,y,p){var u;"undefined"!=typeof window&&(u=function(){return function(p){function n(x){if(q[x])return q[x].exports;var m=q[x]={i:x,l:!1,exports:{}};return p[x].call(m.exports,m,m.exports,n),m.l=!0,m.exports}var q={};return n.m=p,n.c=q,n.d=function(q,m,h){n.o(q,m)||Object.defineProperty(q,m,{enumerable:!0,get:h})},n.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},n.t=function(q,m){if((1&m&&(q=n(q)),8&m)||4&m&&"object"==typeof q&&q&&q.__esModule)return q;var h=Object.create(null);if(n.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:q}),2&m&&"string"!=typeof q)for(var l in q)n.d(h,l,function(f){return q[f]}.bind(null,l));return h},n.n=function(q){var m=q&&q.__esModule?function(){return q["default"]}:function(){return q};return n.d(m,"a",m),m},n.o=function(n,m){return Object.prototype.hasOwnProperty.call(n,m)},n.p="/dist/",n(n.s="./src/hls.js")}({"./node_modules/eventemitter3/index.js":function(p,n,q){function x(){}function m(a,c,d){this.fn=a;this.context=c;this.once=d||!1}function h(b,c,d,g,f){if("function"!=typeof d)throw new TypeError("The listener must be a function");d=new m(d,g||b,f);c=a?a+c:c;return b._events[c]?b._events[c].fn?b._events[c]=[b._events[c],d]:b._events[c].push(d):(b._events[c]=d,b._eventsCount++),b}function l(a,c){0==--a._eventsCount?a._events=new x:delete a._events[c]}function f(){this._events=new x;this._eventsCount=0}var d=Object.prototype.hasOwnProperty,a="~";Object.create&&(x.prototype=Object.create(null),(new x).__proto__||(a=!1));f.prototype.eventNames=function(){var b,c,e=[];if(0===this._eventsCount)return e;for(c in b=this._events)d.call(b,c)&&e.push(a?c.slice(1):c);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(b)):e};f.prototype.listeners=function(b){b=this._events[a?a+b:b];if(!b)return[];if(b.fn)return[b.fn];for(var c=0,d=b.length,g=Array(d);c<d;c++)g[c]=b[c].fn;return g};f.prototype.listenerCount=function(b){return(b=this._events[a?a+b:b])?b.fn?1:b.length:0};f.prototype.emit=function(b,c,d,g,f,l){var e=a?a+b:b;if(!this._events[e])return!1;var r,h=this._events[e],m=arguments.length;if(h.fn){switch(h.once&&this.removeListener(b,h.fn,void 0,!0),m){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,c),!0;case 3:return h.fn.call(h.context,c,d),!0;case 4:return h.fn.call(h.context,c,d,g),!0;case 5:return h.fn.call(h.context,c,d,g,f),!0;case 6:return h.fn.call(h.context,c,d,g,f,l),!0}e=1;for(r=Array(m-1);e<m;e++)r[e-1]=arguments[e];h.fn.apply(h.context,r)}else for(var E,n=h.length,e=0;e<n;e++)switch(h[e].once&&this.removeListener(b,h[e].fn,void 0,!0),m){case 1:h[e].fn.call(h[e].context);break;case 2:h[e].fn.call(h[e].context,c);break;case 3:h[e].fn.call(h[e].context,c,d);break;case 4:h[e].fn.call(h[e].context,c,d,g);break;default:if(!r)for(E=1,r=Array(m-1);E<m;E++)r[E-1]=arguments[E];h[e].fn.apply(h[e].context,r)}return!0};f.prototype.on=function(a,c,d){return h(this,a,c,d,!1)};f.prototype.once=function(a,c,d){return h(this,a,c,d,!0)};f.prototype.removeListener=function(b,c,d,g){b=a?a+b:b;if(!this._events[b])return this;if(!c)return l(this,b),this;var e=this._events[b];if(e.fn)e.fn!==c||g&&!e.once||d&&e.context!==d||l(this,b);else{for(var f=0,h=[],m=e.length;f<m;f++)(e[f].fn!==c||g&&!e[f].once||d&&e[f].context!==d)&&h.push(e[f]);h.length?this._events[b]=1===h.length?h[0]:h:l(this,b)}return this};f.prototype.removeAllListeners=function(b){var c;return b?(c=a?a+b:b,this._events[c]&&l(this,c)):(this._events=new x,this._eventsCount=0),this};f.prototype.off=f.prototype.removeListener;f.prototype.addListener=f.prototype.on;f.prefixed=a;f.EventEmitter=f;p.exports=f},"./node_modules/node-libs-browser/node_modules/events/events.js":function(p,n){function q(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function x(h){return"function"==typeof h}function m(h){return"object"==typeof h&&null!==h}((p.exports=q).EventEmitter=q).prototype._events=void 0;q.prototype._maxListeners=void 0;q.defaultMaxListeners=10;q.prototype.setMaxListeners=function(h){if("number"!=typeof h||0>h||isNaN(h))throw TypeError("n must be a positive number");return this._maxListeners=h,this};q.prototype.emit=function(h){var l,f,d,a;if(this._events||(this._events={}),"error"===h&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if((l=arguments[1])instanceof Error)throw l;f=Error('Uncaught, unspecified "error" event. ('+l+")");throw f.context=l,f;}if(void 0===(f=this._events[h]))return!1;if(x(f))switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),f.apply(this,l)}else if(m(f))for(l=Array.prototype.slice.call(arguments,1),f=(a=f.slice()).length,d=0;d<f;d++)a[d].apply(this,l);return!0};q.prototype.on=q.prototype.addListener=function(h,l){var f;if(!x(l))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",h,x(l.listener)?l.listener:l),this._events[h]?m(this._events[h])?this._events[h].push(l):this._events[h]=[this._events[h],l]:this._events[h]=l,m(this._events[h])&&!this._events[h].warned&&(f=void 0===this._maxListeners?q.defaultMaxListeners:this._maxListeners)&&0<f&&this._events[h].length>f&&(this._events[h].warned=!0,console.trace),this};q.prototype.once=function(h,l){function f(){this.removeListener(h,f);d||(d=!0,l.apply(this,arguments))}if(!x(l))throw TypeError("listener must be a function");var d=!1;return f.listener=l,this.on(h,f),this};q.prototype.removeListener=function(h,l){var f,d,a;if(!x(l))throw TypeError("listener must be a function");if(!this._events||!this._events[h])return this;if(a=(f=this._events[h]).length,d=-1,f===l||x(f.listener)&&f.listener===l)delete this._events[h],this._events.removeListener&&this.emit("removeListener",h,l);else if(m(f)){for(;0<a--;)if(f[a]===l||f[a].listener&&f[a].listener===l){d=a;break}if(0>d)return this;1===f.length?(f.length=0,delete this._events[h]):f.splice(d,1);this._events.removeListener&&this.emit("removeListener",h,l)}return this};q.prototype.removeAllListeners=function(h){var l;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[h]&&delete this._events[h],this;if(0===arguments.length){for(l in this._events)"removeListener"!==l&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events={},this}if(x(l=this._events[h]))this.removeListener(h,l);else if(l)for(;l.length;)this.removeListener(h,l[l.length-1]);return delete this._events[h],this};q.prototype.listeners=function(h){return this._events&&this._events[h]?x(this._events[h])?[this._events[h]]:this._events[h].slice():[]};q.prototype.listenerCount=function(h){if(this._events){h=this._events[h];if(x(h))return 1;if(h)return h.length}return 0};q.listenerCount=function(h,l){return h.listenerCount(l)}},"./node_modules/url-toolkit/src/url-toolkit.js":function(p,n,q){var x,m,h,l,f;x=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;m=/^([^\/?#]*)(.*)$/;h=/(?:\/|^)\.(?=\/)/g;l=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;f={buildAbsoluteURL:function(d,a,b){if(b=b||{},d=d.trim(),!(a=a.trim())){if(!b.alwaysNormalize)return d;b=f.parseURL(d);if(!b)throw Error("Error trying to parse base URL.");return b.path=f.normalizePath(b.path),f.buildURLFromParts(b)}var c=f.parseURL(a);if(!c)throw Error("Error trying to parse relative URL.");if(c.scheme)return b.alwaysNormalize?(c.path=f.normalizePath(c.path),f.buildURLFromParts(c)):a;a=f.parseURL(d);if(!a)throw Error("Error trying to parse base URL.");!a.netLoc&&a.path&&"/"!==a.path[0]&&(d=m.exec(a.path),a.netLoc=d[1],a.path=d[2]);a.netLoc&&!a.path&&(a.path="/");d={scheme:a.scheme,netLoc:c.netLoc,path:null,params:c.params,query:c.query,fragment:c.fragment};c.netLoc||(d.netLoc=a.netLoc,"/"===c.path[0])||(c.path?(a=a.path,a=a.substring(0,a.lastIndexOf("/")+1)+c.path,d.path=f.normalizePath(a)):(d.path=a.path,c.params||(d.params=a.params,c.query||(d.query=a.query))));return null===d.path&&(d.path=b.alwaysNormalize?f.normalizePath(c.path):c.path),f.buildURLFromParts(d)},parseURL:function(d){return(d=x.exec(d))?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(h,"");d.length!==(d=d.replace(l,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};p.exports=f},"./node_modules/webworkify-webpack/index.js":function(p,n,q){function x(h){function f(a){if(d[a])return d[a].exports;var b=d[a]={i:a,l:!1,exports:{}};return h[a].call(b.exports,b,b.exports,f),b.l=!0,b.exports}var d={};f.m=h;f.c=d;f.i=function(a){return a};f.d=function(a,c,d){f.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})};f.r=function(a){Object.defineProperty(a,"__esModule",{value:!0})};f.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};return f.d(b,"a",b),b};f.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};f.p="/";f.oe=function(a){throw a;};var a=f(f.s=ENTRY_MODULE);return a["default"]||a}function m(h){return(h+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$\x26")}function h(h){return Object.keys(h).reduce(function(f,d){return f||0<h[d].length},!1)}p.exports=function(l,f){f=f||{};var d={main:q.m},a=f.all?{main:Object.keys(d.main)}:function(a,b){for(var c={main:[b]},d={main:[]},e={main:{}};h(c);)for(var g=Object.keys(c),f=0;f<g.length;f++){var r=g[f],l=c[r].pop();if(e[r]=e[r]||{},!e[r][l]&&a[r][l]){e[r][l]=!0;d[r]=d[r]||[];d[r].push(l);var n=a,Q=a[r][l],l=r,r={};r[l]=[];var Q=Q.toString(),H=Q.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(H){for(var x=H[1],p=new RegExp("(\\\\n|\\W)"+m(x)+"\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");H=p.exec(Q);)"dll-reference"!==H[3]&&r[l].push(H[3]);for(p=new RegExp("\\("+m(x)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");H=p.exec(Q);)n[H[2]]||(r[l].push(H[1]),n[H[2]]=q(H[1]).m),r[H[2]]=r[H[2]]||[],r[H[2]].push(H[4]);l=Object.keys(r);for(Q=0;Q<l.length;Q++)for(H=0;H<r[l[Q]].length;H++)n=r[l[Q]][H],isNaN(1*n)||(r[l[Q]][H]*=1)}n=Object.keys(r);for(l=0;l<n.length;l++)c[n[l]]=c[n[l]]||[],c[n[l]]=c[n[l]].concat(r[n[l]])}}return d}(d,l),b="";Object.keys(a).filter(function(a){return"main"!==a}).forEach(function(c){for(var e=0;a[c][e];)e++;a[c].push(e);d[c][e]="(function(module, exports, __webpack_require__) { module.exports \x3d __webpack_require__; })";b=b+"var "+c+" \x3d ("+x.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[c].map(function(a){return JSON.stringify(a)+": "+d[c][a].toString()}).join(",")+"});\n"});var b=b+"new (("+x.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+a.main.map(function(a){return JSON.stringify(a)+": "+d.main[a].toString()}).join(",")+"}))(self);",c=new window.Blob([b],{type:"text/javascript"});if(f.bare)return c;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(c),e=new window.Worker(c);return e.objectURL=c,e}},"./src/config.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=q("./src/controller/abr-controller.js");var x=q("./src/controller/buffer-controller.js"),m=q("./src/controller/cap-level-controller.js"),h=q("./src/controller/fps-controller.js"),l=q("./src/utils/xhr-loader.js"),f=q("./src/controller/audio-track-controller.js"),d=q("./src/controller/audio-stream-controller.js"),a=q("./src/utils/cues.js"),b=q("./src/controller/timeline-controller.js"),c=q("./src/controller/subtitle-track-controller.js"),e=q("./src/controller/subtitle-stream-controller.js"),g=q("./src/controller/eme-controller.js");q=q("./src/utils/mediakeys-helper.js");n.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6E7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1E4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1E3,manifestLoadingMaxRetryTimeout:64E3,startLevel:void 0,levelLoadingTimeOut:1E4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1E3,levelLoadingMaxRetryTimeout:64E3,fragLoadingTimeOut:2E4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1E3,fragLoadingMaxRetryTimeout:64E3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5E3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:l["default"],fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:p["default"],bufferController:x["default"],capLevelController:m["default"],fpsController:h["default"],stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5E5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:q.requestMediaKeySystemAccess};n.hlsDefaultConfig.subtitleStreamController=e.SubtitleStreamController;n.hlsDefaultConfig.subtitleTrackController=c["default"];n.hlsDefaultConfig.timelineController=b["default"];n.hlsDefaultConfig.cueHandler=a;n.hlsDefaultConfig.enableCEA708Captions=!0;n.hlsDefaultConfig.enableWebVTT=!0;n.hlsDefaultConfig.captionsTextTrack1Label="English";n.hlsDefaultConfig.captionsTextTrack1LanguageCode="en";n.hlsDefaultConfig.captionsTextTrack2Label="Spanish";n.hlsDefaultConfig.captionsTextTrack2LanguageCode="es";n.hlsDefaultConfig.audioStreamController=d["default"];n.hlsDefaultConfig.audioTrackController=f["default"];n.hlsDefaultConfig.emeController=g["default"]},"./src/controller/abr-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=q("./src/event-handler.js"),d=q("./src/utils/buffer-helper.js"),a=q("./src/errors.js"),b=q("./src/utils/logger.js"),c=q("./src/utils/ewma-bandwidth-estimator.js"),e=window.performance,g=function(g){function r(a){var b=g.call(this,a,l["default"].FRAG_LOADING,l["default"].FRAG_LOADED,l["default"].FRAG_BUFFERED,l["default"].ERROR)||this;return b.lastLoadedFragLevel=0,b._nextAutoLevel=-1,b.hls=a,b.timer=null,b._bwEstimator=null,b.onCheck=b._abandonRulesCheck.bind(b),b}return h(r,g),r.prototype.destroy=function(){this.clearTimer();f["default"].prototype.destroy.call(this)},r.prototype.onFragLoading=function(a){var b=a.frag;if("main"===b.type&&(this.timer||(this.fragCurrent=b,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){a=this.hls;var d=a.config,e=void 0,b=a.levels[b.level].details.live?(e=d.abrEwmaFastLive,d.abrEwmaSlowLive):(e=d.abrEwmaFastVoD,d.abrEwmaSlowVoD);this._bwEstimator=new c["default"](a,b,e,d.abrEwmaDefaultEstimate)}},r.prototype._abandonRulesCheck=function(){var a=this.hls,c=a.media,g=this.fragCurrent;if(g){var f=g.loader,r=a.minAutoLevel;if(!f||f.stats&&f.stats.aborted)return b.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var h=f.stats;if(c&&h&&(!c.paused&&0!==c.playbackRate||!c.readyState)&&g.autoLevel&&g.level){var m=e.now()-h.trequest,E=Math.abs(c.playbackRate);if(m>500*g.duration/E){var H=a.levels,n=Math.max(1,h.bw?h.bw/8:1E3*h.loaded/m),q=H[g.level],q=q.realBitrate?Math.max(q.realBitrate,q.bitrate):q.bitrate,p=c.currentTime,q=((h.total?h.total:Math.max(h.loaded,Math.round(g.duration*q/8)))-h.loaded)/n,c=(d.BufferHelper.bufferInfo(c,p,a.config.maxBufferHole).end-p)/E;if(c<2*g.duration/E&&c<q){E=void 0;for(p=g.level-1;r<p&&!((E=g.duration*(H[p].realBitrate?Math.max(H[p].realBitrate,H[p].bitrate):H[p].bitrate)/(6.4*n))<c);p--);E<q&&(b.logger.warn("loading too slow, abort fragment loading and switch to level "+p+":fragLoadedDelay["+p+"]\x3cfragLoadedDelay["+(g.level-1)+"];bufferStarvationDelay:"+E.toFixed(1)+"\x3c"+q.toFixed(1)+":"+c.toFixed(1)),a.nextLoadLevel=p,this._bwEstimator.sample(m,h.loaded),f.abort(),this.clearTimer(),a.trigger(l["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:g,stats:h}))}}}}},r.prototype.onFragLoaded=function(a){var b=a.frag;if("main"===b.type&&p.isFinite(b.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=b.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var b=this.hls.levels[b.level],c=(b.loaded?b.loaded.bytes:0)+a.stats.loaded,d=(b.loaded?b.loaded.duration:0)+a.frag.duration;b.loaded={bytes:c,duration:d};b.realBitrate=Math.round(8*c/d)}a.frag.bitrateTest&&(b=a.stats,b.tparsed=b.tbuffered=b.tload,this.onFragBuffered(a))}},r.prototype.onFragBuffered=function(a){var c=a.stats;a=a.frag;if(!0!==c.aborted&&"main"===a.type&&p.isFinite(a.sn)&&(!a.bitrateTest||c.tload===c.tbuffered)){var d=c.tparsed-c.trequest;b.logger.log("latency/loading/parsing/append/kbps:"+Math.round(c.tfirst-c.trequest)+"/"+Math.round(c.tload-c.tfirst)+"/"+Math.round(c.tparsed-c.tload)+"/"+Math.round(c.tbuffered-c.tparsed)+"/"+Math.round(8*c.loaded/(c.tbuffered-c.trequest)));this._bwEstimator.sample(d,c.loaded);c.bwEstimate=this._bwEstimator.getEstimate();a.bitrateTest?this.bitrateTestDelay=d/1E3:this.bitrateTestDelay=0}},r.prototype.onError=function(b){switch(b.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},r.prototype.clearTimer=function(){clearInterval(this.timer);this.timer=null},Object.defineProperty(r.prototype,"nextAutoLevel",{get:function(){var a=this._nextAutoLevel,b=this._bwEstimator;if(!(-1===a||b&&b.canEstimate()))return a;b=this._nextABRAutoLevel;return-1!==a&&(b=Math.min(a,b)),b},set:function(a){this._nextAutoLevel=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_nextABRAutoLevel",{get:function(){var a=this.hls,c=a.maxAutoLevel,e=a.levels,g=a.config,f=a.minAutoLevel,r=a.media,a=this.lastLoadedFragLevel,h=this.fragCurrent?this.fragCurrent.duration:0,l=r?r.currentTime:0,m=r&&0!==r.playbackRate?Math.abs(r.playbackRate):1,E=this._bwEstimator?this._bwEstimator.getEstimate():g.abrEwmaDefaultEstimate,r=(d.BufferHelper.bufferInfo(r,l,g.maxBufferHole).end-l)/m,l=this._findBestLevel(a,h,E,f,c,r,g.abrBandWidthFactor,g.abrBandWidthUpFactor,e);if(0<=l)return l;b.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var m=h?Math.min(h,g.maxStarvationDelay):g.maxStarvationDelay,n=g.abrBandWidthFactor,q=g.abrBandWidthUpFactor;if(0===r){var p=this.bitrateTestDelay;p&&(m=(h?Math.min(h,g.maxLoadingDelay):g.maxLoadingDelay)-p,b.logger.trace("bitrate test took "+Math.round(1E3*p)+"ms, set first fragment max fetchDuration to "+Math.round(1E3*m)+" ms"),n=q=1)}return l=this._findBestLevel(a,h,E,f,c,r+m,n,q,e),Math.max(l,0)},enumerable:!0,configurable:!0}),r.prototype._findBestLevel=function(a,c,d,e,g,f,r,h,l){for(;e<=g;g--){var m=l[g];if(m){var v=m.details,m=v?v.totalduration/v.fragments.length:c,v=!!v&&v.live,E;E=g<=a?r*d:h*d;var C=l[g].realBitrate?Math.max(l[g].realBitrate,l[g].bitrate):l[g].bitrate,D=C*m/E;if(b.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+g+"/"+Math.round(E)+"/"+C+"/"+m+"/"+f+"/"+D),C<E&&(!D||v&&!this.bitrateTestDelay||D<f))return g}}return-1},r}(f["default"]);n["default"]=g}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/audio-stream-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/utils/binary-search.js"),f=q("./src/utils/buffer-helper.js"),d=q("./src/demux/demuxer.js"),a=q("./src/events.js"),b=q("./src/controller/level-helper.js"),c=q("./src/utils/time-ranges.js"),e=q("./src/errors.js"),g=q("./src/utils/logger.js"),r=q("./src/utils/discontinuities.js"),E=q("./src/controller/fragment-tracker.js"),C=q("./src/loader/fragment.js"),v=q("./src/controller/base-stream-controller.js"),D=window.performance,B=function(m){function B(b,c){var d=m.call(this,b,a["default"].MEDIA_ATTACHED,a["default"].MEDIA_DETACHING,a["default"].AUDIO_TRACKS_UPDATED,a["default"].AUDIO_TRACK_SWITCHING,a["default"].AUDIO_TRACK_LOADED,a["default"].KEY_LOADED,a["default"].FRAG_LOADED,a["default"].FRAG_PARSING_INIT_SEGMENT,a["default"].FRAG_PARSING_DATA,a["default"].FRAG_PARSED,a["default"].ERROR,a["default"].BUFFER_RESET,a["default"].BUFFER_CREATED,a["default"].BUFFER_APPENDED,a["default"].BUFFER_FLUSHED,a["default"].INIT_PTS_FOUND)||this;return d.fragmentTracker=c,d.config=b.config,d.audioCodecSwap=!1,d._state=v.State.STOPPED,d.initPTS=[],d.waitingFragment=null,d.videoTrackCC=null,d}return h(B,m),B.prototype.onHandlerDestroying=function(){this.stopLoad();m.prototype.onHandlerDestroying.call(this)},B.prototype.onHandlerDestroyed=function(){this.state=v.State.STOPPED;this.fragmentTracker=null;m.prototype.onHandlerDestroyed.call(this)},B.prototype.onInitPtsFound=function(a){var b=a.frag.cc,c=a.initPTS;"main"===a.id&&(this.initPTS[b]=c,this.videoTrackCC=b,g.logger.log("InitPTS for cc: "+b+" found from video track: "+c),this.state===v.State.WAITING_INIT_PTS&&this.tick())},B.prototype.startLoad=function(a){if(this.tracks){var b=this.lastCurrentTime;this.stopLoad();this.setInterval(100);this.fragLoadError=0;this.state=0<b&&-1===a?(g.logger.log("audio:override startPosition with lastCurrentTime @"+b.toFixed(3)),v.State.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:a,v.State.STARTING);this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else this.startPosition=a,this.state=v.State.STOPPED},B.prototype.stopLoad=function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragmentTracker.removeFragment(a),this.fragCurrent=null);this.fragPrevious=null;this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);this.state=v.State.STOPPED},Object.defineProperty(B.prototype,"state",{get:function(){return this._state},set:function(a){if(this.state!==a){var b=this.state;this._state=a;g.logger.log("audio stream:"+b+"-\x3e"+a)}},enumerable:!0,configurable:!0}),B.prototype.doTick=function(){var b,c,d=this.hls,e=d.config;switch(this.state){case v.State.STARTING:this.state=v.State.WAITING_TRACK;this.loadedmetadata=!1;break;case v.State.IDLE:c=this.tracks;if(!c)break;if(!this.media&&(this.startFragRequested||!e.startFragPrefetch))break;if(this.loadedmetadata)b=this.media.currentTime;else if(void 0===(b=this.nextLoadPosition))break;var h=this.mediaBuffer?this.mediaBuffer:this.media,m=this.videoBuffer?this.videoBuffer:this.media,C=f.BufferHelper.bufferInfo(h,b,e.maxBufferHole),B=f.BufferHelper.bufferInfo(m,b,e.maxBufferHole),n=C.end,h=this.fragPrevious,m=this.audioSwitch,q=this.trackId;if((C.len<Math.max(Math.min(e.maxBufferLength,e.maxMaxBufferLength),B.len)||m)&&q<c.length)if(void 0===(c=c[q].details))this.state=v.State.WAITING_TRACK;else{if(!m&&this._streamEnded(C,c))return this.hls.trigger(a["default"].BUFFER_EOS,{type:"audio"}),void(this.state=v.State.ENDED);var B=c.fragments,F=B.length,x=B[0].start,A=B[F-1].start+B[F-1].duration,t=void 0;if(m)if(c.live&&!c.PTSKnown)g.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),n=0;else if(n=b,c.PTSKnown&&b<x){if(!(C.end>x||C.nextStart))break;g.logger.log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=x+.05}if(c.initSegment&&!c.initSegment.data)t=c.initSegment;else if(n<=x){if(t=B[0],null!==this.videoTrackCC&&t.cc!==this.videoTrackCC&&(t=r.findFragWithCC(B,this.videoTrackCC)),c.live&&t.loadIdx&&t.loadIdx===this.fragLoadIdx)return d=C.nextStart?C.nextStart:x,g.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(d+.05)),void(this.media.currentTime=d+.05)}else{var C=void 0,u=e.maxFragLookUpTolerance,e=h?B[h.sn-B[0].sn+1]:void 0,x=function(a){var b=Math.min(u,a.duration);return a.start+a.duration-b<=n?1:a.start-b>n&&a.start?-1:0};(C=n<A?(A-u<n&&(u=0),e&&!x(e)?e:l["default"].search(B,x)):B[F-1])&&(x=(t=C).start,h&&t.level===h.level&&t.sn===h.sn&&(t.sn<c.endSN?(t=B[t.sn+1-c.startSN],g.logger.log("SN just loaded, load next one: "+t.sn)):t=null))}t&&(t.encrypted?(g.logger.log("Loading key for "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],track "+q),this.state=v.State.KEY_LOADING,d.trigger(a["default"].KEY_LOADING,{frag:t})):(g.logger.log("Loading "+t.sn+", cc: "+t.cc+" of ["+c.startSN+" ,"+c.endSN+"],track "+q+", currentTime:"+b+",bufferEnd:"+n.toFixed(3)),this.fragCurrent=t,(m||this.fragmentTracker.getState(t)===E.FragmentState.NOT_LOADED)&&(this.startFragRequested=!0,p.isFinite(t.sn)&&(this.nextLoadPosition=t.start+t.duration),d.trigger(a["default"].FRAG_LOADING,{frag:t}),this.state=v.State.FRAG_LOADING)))}break;case v.State.WAITING_TRACK:(b=this.tracks[this.trackId])&&b.details&&(this.state=v.State.IDLE);break;case v.State.FRAG_LOADING_WAITING_RETRY:d=D.now();b=this.retryDate;e=(h=this.media)&&h.seeking;(!b||b<=d||e)&&(g.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=v.State.IDLE);break;case v.State.WAITING_INIT_PTS:d=this.videoTrackCC,void 0!==this.initPTS[d]&&((e=this.waitingFragment)?(e=e.frag.cc,d!==e?(b=this.tracks[this.trackId]).details&&b.details.live&&(g.logger.warn("Waiting fragment CC ("+e+") does not match video track CC ("+d+")"),this.waitingFragment=null,this.state=v.State.IDLE):(this.state=v.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)):this.state=v.State.IDLE)}},B.prototype.onMediaAttached=function(a){a=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);a.addEventListener("seeking",this.onvseeking);a.addEventListener("ended",this.onvended);a=this.config;this.tracks&&a.autoStartLoad&&this.startLoad(a.startPosition)},B.prototype.onMediaDetaching=function(){var a=this.media;a&&a.ended&&(g.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1;this.stopLoad()},B.prototype.onAudioTracksUpdated=function(a){g.logger.log("audio tracks updated");this.tracks=a.audioTracks},B.prototype.onAudioTrackSwitching=function(a){var b=!!a.url;this.trackId=a.id;this.fragCurrent=null;this.state=v.State.PAUSED;this.waitingFragment=null;b?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);b&&(this.audioSwitch=!0,this.state=v.State.IDLE);this.tick()},B.prototype.onAudioTrackLoaded=function(a){var c=a.details,d=a.id;a=this.tracks[d];var e=0;(g.logger.log("track "+d+" loaded ["+c.startSN+","+c.endSN+"],duration:"+c.totalduration),c.live)?(d=a.details)&&0<c.fragments.length?(b.mergeDetails(d,c),e=c.fragments[0].start,c.PTSKnown?g.logger.log("live audio playlist sliding:"+e.toFixed(3)):g.logger.log("live audio playlist - outdated PTS, unknown sliding")):(c.PTSKnown=!1,g.logger.log("live audio playlist - first load, unknown sliding")):c.PTSKnown=!1;(a.details=c,this.startFragRequested)||(-1===this.startPosition&&(c=c.startTimeOffset,p.isFinite(c)?(g.logger.log("start time offset found in playlist, adjust startPosition to "+c),this.startPosition=c):this.startPosition=0),this.nextLoadPosition=this.startPosition);this.state===v.State.WAITING_TRACK&&(this.state=v.State.IDLE);this.tick()},B.prototype.onKeyLoaded=function(){this.state===v.State.KEY_LOADING&&(this.state=v.State.IDLE,this.tick())},B.prototype.onFragLoaded=function(b){var c=this.fragCurrent,e=b.frag;if(this.state===v.State.FRAG_LOADING&&c&&"audio"===e.type&&e.level===c.level&&e.sn===c.sn){var f=this.tracks[this.trackId],e=f.details,r=e.totalduration,h=c.level,l=c.sn,m=c.cc,f=this.config.defaultAudioCodec||f.audioCodec||"mp4a.40.2",E=this.stats=b.stats;if("initSegment"===l)this.state=v.State.IDLE,E.tparsed=E.tbuffered=D.now(),e.initSegment.data=b.payload,this.hls.trigger(a["default"].FRAG_BUFFERED,{stats:E,frag:c,id:"audio"}),this.tick();else{this.state=v.State.PARSING;this.appended=!1;this.demuxer||(this.demuxer=new d["default"](this.hls,"audio"));var E=this.initPTS[m],C=e.initSegment?e.initSegment.data:[];e.initSegment||void 0!==E?(this.pendingBuffering=!0,g.logger.log("Demuxing "+l+" of ["+e.startSN+" ,"+e.endSN+"],track "+h),this.demuxer.push(b.payload,C,f,null,c,r,!1,E)):(g.logger.log("unknown video PTS for continuity counter "+m+", waiting for video PTS before demuxing audio frag "+l+" of ["+e.startSN+" ,"+e.endSN+"],track "+h),this.waitingFragment=b,this.state=v.State.WAITING_INIT_PTS)}}this.fragLoadError=0},B.prototype.onFragParsingInitSegment=function(b){var c=this.fragCurrent,d=b.frag;if(c&&"audio"===b.id&&d.sn===c.sn&&d.level===c.level&&this.state===v.State.PARSING&&(c=b.tracks,c.video&&delete c.video,d=c.audio)){d.levelCodec=d.codec;d.id=b.id;this.hls.trigger(a["default"].BUFFER_CODECS,c);g.logger.log("audio track:audio,container:"+d.container+",codecs[level/parsed]\x3d["+d.levelCodec+"/"+d.codec+"]");if(b=d.initSegment)b={type:"audio",data:b,parent:"audio",content:"initSegment"},this.audioSwitch?this.pendingData=[b]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(a["default"].BUFFER_APPENDING,b));this.tick()}},B.prototype.onFragParsingData=function(c){var d=this,f=this.fragCurrent,r=c.frag;if(f&&"audio"===c.id&&"audio"===c.type&&r.sn===f.sn&&r.level===f.level&&this.state===v.State.PARSING){var r=this.trackId,h=this.tracks[r],l=this.hls;p.isFinite(c.endPTS)||(c.endPTS=c.startPTS+f.duration,c.endDTS=c.startDTS+f.duration);f.addElementaryStream(C["default"].ElementaryStreamTypes.AUDIO);g.logger.log("parsed "+c.type+",PTS:["+c.startPTS.toFixed(3)+","+c.endPTS.toFixed(3)+"],DTS:["+c.startDTS.toFixed(3)+"/"+c.endDTS.toFixed(3)+"],nb:"+c.nb);b.updateFragPTSDTS(h.details,f,c.startPTS,c.endPTS);h=this.media;f=!1;this.audioSwitch&&h&&(h.readyState?(h=h.currentTime,g.logger.log("switching audio track : currentTime:"+h),h>=c.startPTS&&(g.logger.log("switching audio track : flushing all audio"),this.state=v.State.BUFFER_FLUSHING,l.trigger(a["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:p.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,l.trigger(a["default"].AUDIO_TRACK_SWITCHED,{id:r}))):(this.audioSwitch=!1,l.trigger(a["default"].AUDIO_TRACK_SWITCHED,{id:r})));var m=this.pendingData;if(!m)return g.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void l.trigger(a["default"].ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([c.data1,c.data2].forEach(function(a){a&&a.length&&m.push({type:c.type,data:a,parent:"audio",content:"data"})}),!f&&m.length&&(m.forEach(function(b){d.state===v.State.PARSING&&(d.pendingBuffering=!0,d.hls.trigger(a["default"].BUFFER_APPENDING,b))}),this.pendingData=[],this.appended=!0));this.tick()}},B.prototype.onFragParsed=function(a){var b=this.fragCurrent,c=a.frag;b&&"audio"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===v.State.PARSING&&(this.stats.tparsed=D.now(),this.state=v.State.PARSED,this._checkAppendedParsed())},B.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1},B.prototype.onBufferCreated=function(a){var b=a.tracks.audio;b&&(this.mediaBuffer=b.buffer,this.loadedmetadata=!0);a.tracks.video&&(this.videoBuffer=a.tracks.video.buffer)},B.prototype.onBufferAppended=function(a){if("audio"===a.parent){var b=this.state;b!==v.State.PARSING&&b!==v.State.PARSED||(this.pendingBuffering=0<a.pending,this._checkAppendedParsed())}},B.prototype._checkAppendedParsed=function(){if(!(this.state!==v.State.PARSED||this.appended&&this.pendingBuffering)){var b=this.fragCurrent,d=this.stats,e=this.hls;b&&(this.fragPrevious=b,d.tbuffered=D.now(),e.trigger(a["default"].FRAG_BUFFERED,{stats:d,frag:b,id:"audio"}),g.logger.log("audio buffered : "+c["default"].toString((this.mediaBuffer?this.mediaBuffer:this.media).buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,e.trigger(a["default"].AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=v.State.IDLE);this.tick()}},B.prototype.onError=function(b){var c=b.frag;if(!c||"audio"===c.type)switch(b.details){case e.ErrorDetails.FRAG_LOAD_ERROR:case e.ErrorDetails.FRAG_LOAD_TIMEOUT:var d=b.frag;if(d&&"audio"!==d.type)break;b.fatal||(c=this.fragLoadError,(c?c++:c=1,c<=(d=this.config).fragLoadingMaxRetry)?(this.fragLoadError=c,d=Math.min(Math.pow(2,c-1)*d.fragLoadingRetryDelay,d.fragLoadingMaxRetryTimeout),g.logger.warn("AudioStreamController: frag loading failed, retry in "+d+" ms"),this.retryDate=D.now()+d,this.state=v.State.FRAG_LOADING_WAITING_RETRY):(g.logger.error("AudioStreamController: "+b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.state=v.State.ERROR));break;case e.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case e.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case e.ErrorDetails.KEY_LOAD_ERROR:case e.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==v.State.ERROR&&(this.state=b.fatal?v.State.ERROR:v.State.IDLE,g.logger.warn("AudioStreamController: "+b.details+" while loading frag, now switching to "+this.state+" state ..."));break;case e.ErrorDetails.BUFFER_FULL_ERROR:"audio"!==b.parent||this.state!==v.State.PARSING&&this.state!==v.State.PARSED||(b=this.mediaBuffer,c=this.media.currentTime,b&&f.BufferHelper.isBuffered(b,c)&&f.BufferHelper.isBuffered(b,c+.5)?((d=this.config).maxMaxBufferLength>=d.maxBufferLength&&(d.maxMaxBufferLength/=2,g.logger.warn("AudioStreamController: reduce max buffer length to "+d.maxMaxBufferLength+"s")),this.state=v.State.IDLE):(g.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=v.State.BUFFER_FLUSHING,this.hls.trigger(a["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:p.POSITIVE_INFINITY,type:"audio"})))}},B.prototype.onBufferFlushed=function(){var b=this,c=this.pendingData;c&&c.length?(g.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),c.forEach(function(c){b.hls.trigger(a["default"].BUFFER_APPENDING,c)}),this.appended=!0,this.pendingData=[],this.state=v.State.PARSED):(this.state=v.State.IDLE,this.fragPrevious=null,this.tick())},B}(v["default"]);n["default"]=B}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/audio-track-controller.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,a){d.__proto__=a}||function(d,a){for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b])},function(d,a){function b(){this.constructor=d}x(d,a);d.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)});Object.defineProperty(n,"__esModule",{value:!0});var h=q("./src/events.js");p=q("./src/task-loop.js");var l=q("./src/utils/logger.js"),f=q("./src/errors.js");q=function(d){function a(a){a=d.call(this,a,h["default"].MANIFEST_LOADING,h["default"].MANIFEST_PARSED,h["default"].AUDIO_TRACK_LOADED,h["default"].AUDIO_TRACK_SWITCHED,h["default"].LEVEL_LOADED,h["default"].ERROR)||this;return a._trackId=-1,a._selectDefaultTrack=!0,a.tracks=[],a.trackIdBlacklist=Object.create(null),a.audioGroupId=null,a}return m(a,d),a.prototype.onManifestLoading=function(){this.tracks=[];this._trackId=-1;this._selectDefaultTrack=!0},a.prototype.onManifestParsed=function(a){a=this.tracks=a.audioTracks||[];this.hls.trigger(h["default"].AUDIO_TRACKS_UPDATED,{audioTracks:a})},a.prototype.onAudioTrackLoaded=function(a){a.id>=this.tracks.length?l.logger.warn("Invalid audio track id:",a.id):((l.logger.log("audioTrack "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.hasInterval())&&this.setInterval(1E3*a.details.targetduration),!a.details.live&&this.hasInterval()&&this.clearInterval())},a.prototype.onAudioTrackSwitched=function(a){(a=this.tracks[a.id].groupId)&&this.audioGroupId!==a&&(this.audioGroupId=a)},a.prototype.onLevelLoaded=function(a){a=this.hls.levels[a.level];a.audioGroupIds&&(a=a.audioGroupIds[a.urlId],this.audioGroupId!==a&&(this.audioGroupId=a,this._selectInitialAudioTrack()))},a.prototype.onError=function(a){a.type===f.ErrorTypes.NETWORK_ERROR&&(a.fatal&&this.clearInterval(),a.details===f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(l.logger.warn("Network failure on audio-track id:",a.context.id),this._handleLoadError()))},Object.defineProperty(a.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"audioTrack",{get:function(){return this._trackId},set:function(a){this._setAudioTrack(a);this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),a.prototype._setAudioTrack=function(a){if(this._trackId===a&&this.tracks[this._trackId].details)l.logger.debug("Same id as current audio-track passed, and track details available -\x3e no-op");else if(0>a||a>=this.tracks.length)l.logger.warn("Invalid id passed to audio-track controller");else{var b=this.tracks[a];l.logger.log("Now switching to audio-track index "+a);this.clearInterval();this._trackId=a;this.hls.trigger(h["default"].AUDIO_TRACK_SWITCHING,{id:b.id,type:b.type,url:b.url});this._loadTrackDetailsIfNeeded(b)}},a.prototype.doTick=function(){this._updateTrack(this._trackId)},a.prototype._selectInitialAudioTrack=function(){var a=this,c=this.tracks;if(c.length){var d=this.tracks[this._trackId],g=null;if(d&&(g=d.name),this._selectDefaultTrack)d=c.filter(function(a){return a["default"]}),d.length?c=d:l.logger.warn("No default audio tracks defined");var r=!1,d=function(){c.forEach(function(b){r||a.audioGroupId&&b.groupId!==a.audioGroupId||g&&g!==b.name||(a._setAudioTrack(b.id),r=!0)})};d();r||(g=null,d());r||(l.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(h["default"].ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},a.prototype._needsTrackLoading=function(a){var b=a.details;a=a.url;return!(b&&!b.live)&&!!a},a.prototype._loadTrackDetailsIfNeeded=function(a){if(this._needsTrackLoading(a)){var b=a.url;a=a.id;l.logger.log("loading audio-track playlist for id: "+a);this.hls.trigger(h["default"].AUDIO_TRACK_LOADING,{url:b,id:a})}},a.prototype._updateTrack=function(a){0>a||a>=this.tracks.length||(this.clearInterval(),this._trackId=a,l.logger.log("trying to update audio-track "+a),this._loadTrackDetailsIfNeeded(this.tracks[a]))},a.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var a=this._trackId,c=this.tracks[a],d=c.name,g=c.language;l.logger.warn("Loading failed on audio track id: "+a+", group-id: "+c.groupId+', name/language: "'+d+'" / "'+g+'"');for(var c=a,f=0;f<this.tracks.length;f++)if(!this.trackIdBlacklist[f]&&this.tracks[f].name===d){c=f;break}c!==a?(l.logger.log("Attempting audio-track fallback id:",c,"group-id:",this.tracks[c].groupId),this._setAudioTrack(c)):l.logger.warn('No fallback audio-track found for name/language: "'+d+'" / "'+g+'"')},a}(p["default"]);n["default"]=q},"./src/controller/base-stream-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])},function(a,c){function b(){this.constructor=a}m(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/task-loop.js"),f=q("./src/controller/fragment-tracker.js"),d=q("./src/utils/buffer-helper.js"),a=q("./src/utils/logger.js");n.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};l=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return h(c,b),c.prototype.doTick=function(){},c.prototype._streamEnded=function(a,b){var c=this.fragCurrent;if(b.live||!c||c.backtracked||c.sn!==b.endSN||a.nextStart)return!1;c=this.fragmentTracker.getState(c);return c===f.FragmentState.PARTIAL||c===f.FragmentState.OK},c.prototype.onMediaSeeking=function(){var b=this.config,c=this.media,f=this.state,h=c?c.currentTime:null,l=d.BufferHelper.bufferInfo(this.mediaBuffer||c,h,this.config.maxBufferHole);(p.isFinite(h)&&a.logger.log("media seeking to "+h.toFixed(3)),f===n.State.FRAG_LOADING)?(f=this.fragCurrent,0===l.len&&f&&(b=b.maxFragLookUpTolerance,l=f.start+f.duration+b,h<f.start-b||l<h?(f.loader&&(a.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),f.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=n.State.IDLE):a.logger.log("seeking outside of buffer but within currently loaded fragment range"))):f===n.State.ENDED&&(0===l.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=n.State.IDLE);c&&(this.lastCurrentTime=h);this.loadedmetadata||(this.nextLoadPosition=this.startPosition=h);this.tick()},c.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},c}(l["default"]);n["default"]=l}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/buffer-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=q("./src/event-handler.js"),d=q("./src/utils/logger.js"),a=q("./src/errors.js"),b=q("./src/utils/mediasource-helper.js").getMediaSource(),c=function(c){function e(a){a=c.call(this,a,l["default"].MEDIA_ATTACHING,l["default"].MEDIA_DETACHING,l["default"].MANIFEST_PARSED,l["default"].BUFFER_RESET,l["default"].BUFFER_APPENDING,l["default"].BUFFER_CODECS,l["default"].BUFFER_EOS,l["default"].BUFFER_FLUSHING,l["default"].LEVEL_PTS_UPDATED,l["default"].LEVEL_UPDATED)||this;return a._msDuration=null,a._levelDuration=null,a._levelTargetDuration=10,a._live=null,a._objectUrl=null,a.bufferCodecEventsExpected=0,a.onsbue=a.onSBUpdateEnd.bind(a),a.onsbe=a.onSBUpdateError.bind(a),a.pendingTracks={},a.tracks={},a}return h(e,c),e.prototype.destroy=function(){f["default"].prototype.destroy.call(this)},e.prototype.onLevelPtsUpdated=function(a){var b=this.tracks.audio;if("audio"===a.type&&b&&"audio/mpeg"===b.container&&(b=this.sourceBuffer.audio,.1<Math.abs(b.timestampOffset-a.start))){var c=b.updating;try{b.abort()}catch(v){d.logger.warn("can not abort audio buffer: "+v)}c?this.audioTimestampOffset=a.start:(d.logger.warn("change mpeg audio timestamp offset from "+b.timestampOffset+" to "+a.start),b.timestampOffset=a.start)}},e.prototype.onManifestParsed=function(a){this.bufferCodecEventsExpected=a.altAudio?2:1;d.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},e.prototype.onMediaAttaching=function(a){if(a=this.media=a.media){var c=this.mediaSource=new b;this.onmso=this.onMediaSourceOpen.bind(this);this.onmse=this.onMediaSourceEnded.bind(this);this.onmsc=this.onMediaSourceClose.bind(this);c.addEventListener("sourceopen",this.onmso);c.addEventListener("sourceended",this.onmse);c.addEventListener("sourceclose",this.onmsc);a.src=window.URL.createObjectURL(c);this._objectUrl=a.src}},e.prototype.onMediaDetaching=function(){d.logger.log("media source detaching");var a=this.mediaSource;if(a){if("open"===a.readyState)try{a.endOfStream()}catch(E){d.logger.warn("onMediaDetaching:"+E.message+" while calling endOfStream")}a.removeEventListener("sourceopen",this.onmso);a.removeEventListener("sourceended",this.onmse);a.removeEventListener("sourceclose",this.onmsc);this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):d.logger.warn("media.src was changed by a third party - skip cleanup"));this._objectUrl=this.media=this.mediaSource=null;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.onmso=this.onmse=this.onmsc=null;this.hls.trigger(l["default"].MEDIA_DETACHED)},e.prototype.onMediaSourceOpen=function(){d.logger.log("media source opened");this.hls.trigger(l["default"].MEDIA_ATTACHED,{media:this.media});var a=this.mediaSource;a&&a.removeEventListener("sourceopen",this.onmso);this.checkPendingTracks()},e.prototype.checkPendingTracks=function(){var a=this.bufferCodecEventsExpected,b=this.pendingTracks,c=Object.keys(b).length;(c&&!a||2===c)&&(this.createSourceBuffers(b),this.pendingTracks={},this.doAppending())},e.prototype.onMediaSourceClose=function(){d.logger.log("media source closed")},e.prototype.onMediaSourceEnded=function(){d.logger.log("media source ended")},e.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var a=this.sourceBuffer.audio;d.logger.warn("change mpeg audio timestamp offset from "+a.timestampOffset+" to "+this.audioTimestampOffset);a.timestampOffset=this.audioTimestampOffset;delete this.audioTimestampOffset}this._needsFlush&&this.doFlush();this._needsEos&&this.checkEos();this.appending=!1;var b=this.parent,a=this.segments.reduce(function(a,c){return c.parent===b?a+1:a},0),c={},e=this.sourceBuffer,g;for(g in e)c[g]=e[g].buffered;this.hls.trigger(l["default"].BUFFER_APPENDED,{parent:b,pending:a,timeRanges:c});this._needsFlush||this.doAppending();this.updateMediaElementDuration();0===a&&this.flushLiveBackBuffer()},e.prototype.onSBUpdateError=function(b){d.logger.error("sourceBuffer error:",b);this.hls.trigger(l["default"].ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferReset=function(){var a=this.sourceBuffer,b;for(b in a){var c=a[b];try{this.mediaSource.removeSourceBuffer(c),c.removeEventListener("updateend",this.onsbue),c.removeEventListener("error",this.onsbe)}catch(v){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0},e.prototype.onBufferCodecs=function(a){var b=this;if(!Object.keys(this.sourceBuffer).length){Object.keys(a).forEach(function(c){b.pendingTracks[c]=a[c]});var c=this.mediaSource;this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0);c&&"open"===c.readyState&&this.checkPendingTracks()}},e.prototype.createSourceBuffers=function(b){var c=this.sourceBuffer,e=this.mediaSource,g;for(g in b)if(!c[g]){var f=b[g],h=f.levelCodec||f.codec,r=f.container+";codecs\x3d"+h;d.logger.log("creating sourceBuffer("+r+")");try{var m=c[g]=e.addSourceBuffer(r);m.addEventListener("updateend",this.onsbue);m.addEventListener("error",this.onsbe);this.tracks[g]={codec:h,container:f.container};f.buffer=m}catch(aa){d.logger.error("error while trying to add sourceBuffer:"+aa.message),this.hls.trigger(l["default"].ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:aa,mimeType:r})}}this.hls.trigger(l["default"].BUFFER_CREATED,{tracks:b})},e.prototype.onBufferAppending=function(a){this._needsFlush||(this.segments?this.segments.push(a):this.segments=[a],this.doAppending())},e.prototype.onBufferAppendFail=function(b){d.logger.error("sourceBuffer error:",b.event);this.hls.trigger(l["default"].ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferEos=function(a){var b=this.sourceBuffer;a=a.type;for(var c in b)a&&c!==a||b[c].ended||(b[c].ended=!0,d.logger.log(c+" sourceBuffer now EOS"));this.checkEos()},e.prototype.checkEos=function(){var a=this.sourceBuffer,b=this.mediaSource;if(b&&"open"===b.readyState){for(var c in a){var e=a[c];if(!e.ended)return;if(e.updating)return void(this._needsEos=!0)}d.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{b.endOfStream()}catch(D){d.logger.warn("exception while calling mediaSource.endOfStream()")}}this._needsEos=!1},e.prototype.onBufferFlushing=function(a){this.flushRange.push({start:a.startOffset,end:a.endOffset,type:a.type});this.flushBufferCounter=0;this.doFlush()},e.prototype.flushLiveBackBuffer=function(){if(this._live){var a=this.hls.config.liveBackBufferLength;if(isFinite(a)&&!(0>a))for(var b=this.media.currentTime,c=this.sourceBuffer,d=Object.keys(c),a=b-Math.max(a,this._levelTargetDuration),b=d.length-1;0<=b;b--){var e=d[b],g=c[e].buffered;0<g.length&&a>g.start(0)&&this.removeBufferRange(e,c[e],0,a)}}},e.prototype.onLevelUpdated=function(a){a=a.details;0<a.fragments.length&&(this._levelDuration=a.totalduration+a.fragments[0].start,this._levelTargetDuration=a.averagetargetduration||a.targetduration||10,this._live=a.live,this.updateMediaElementDuration())},e.prototype.updateMediaElementDuration=function(){var a,b=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(a in this.sourceBuffer)if(!0===this.sourceBuffer[a].updating)return;a=this.media.duration;null===this._msDuration&&(this._msDuration=this.mediaSource.duration);!0===this._live&&!0===b.liveDurationInfinity?(d.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>a||!p.isFinite(a))&&(d.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},e.prototype.doFlush=function(){for(;this.flushRange.length;){var a=this.flushRange[0];if(!this.flushBuffer(a.start,a.end,a.type))return void(this._needsFlush=!0);this.flushRange.shift();this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var a=0,b=this.sourceBuffer;try{for(var c in b)a+=b[c].buffered.length}catch(v){d.logger.error("error while accessing sourceBuffer.buffered")}this.appended=a;this.hls.trigger(l["default"].BUFFER_FLUSHED)}},e.prototype.doAppending=function(){var b=this.hls,c=this.segments,e=this.sourceBuffer;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void d.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending&&c&&c.length){var g=c.shift();try{var f=e[g.type];f?f.updating?c.unshift(g):(f.ended=!1,this.parent=g.parent,f.appendBuffer(g.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(B){d.logger.error("error while trying to append buffer:"+B.message),c.unshift(g),c={type:a.ErrorTypes.MEDIA_ERROR,parent:g.parent},22!==B.code?(this.appendError?this.appendError++:this.appendError=1,c.details=a.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>b.config.appendErrorMaxRetry?(d.logger.log("fail "+b.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],c.fatal=!0):c.fatal=!1):(this.segments=[],c.details=a.ErrorDetails.BUFFER_FULL_ERROR,c.fatal=!1),b.trigger(l["default"].ERROR,c)}}}},e.prototype.flushBuffer=function(a,b,c){var e,g=this.sourceBuffer;if(Object.keys(g).length){if(d.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+a+"/"+b),this.flushBufferCounter<this.appended)for(var f in g){if(!c||f===c){if((e=g[f]).ended=!1,e.updating)return d.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(f,e,a,b))return this.flushBufferCounter++,!1}}else d.logger.warn("abort flushing too many retries");d.logger.log("buffer flushed")}return!0},e.prototype.removeBufferRange=function(a,b,c,e){try{for(var g=0;g<b.buffered.length;g++){var f=b.buffered.start(g),h=b.buffered.end(g),l=Math.max(f,c),r=Math.min(h,e);if(.5<Math.min(r,h)-l)return d.logger.log("sb remove "+a+" ["+l+","+r+"], of ["+f+","+h+"], pos:"+this.media.currentTime),b.remove(l,r),!0}}catch(Q){d.logger.warn("removeBufferRange failed",Q)}return!1},e}(f["default"]);n["default"]=c}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/cap-level-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,a){d.__proto__=a}||function(d,a){for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b])},function(d,a){function b(){this.constructor=d}m(d,a);d.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=function(d){function a(a){a=d.call(this,a,l["default"].FPS_DROP_LEVEL_CAPPING,l["default"].MEDIA_ATTACHING,l["default"].MANIFEST_PARSED,l["default"].BUFFER_CODECS,l["default"].MEDIA_DETACHING)||this;return a.autoLevelCapping=p.POSITIVE_INFINITY,a.firstLevel=null,a.levels=[],a.media=null,a.restrictedLevels=[],a.timer=null,a}return h(a,d),a.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},a.prototype.onFpsDropLevelCapping=function(b){a.isLevelAllowed(b.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(b.droppedLevel)},a.prototype.onMediaAttaching=function(a){this.media=a.media instanceof window.HTMLVideoElement?a.media:null},a.prototype.onManifestParsed=function(a){var b=this.hls;this.restrictedLevels=[];this.levels=a.levels;this.firstLevel=a.firstLevel;b.config.capLevelToPlayerSize&&a.video&&this._startCapping()},a.prototype.onBufferCodecs=function(a){this.hls.config.capLevelToPlayerSize&&a.video&&this._startCapping()},a.prototype.onLevelsUpdated=function(a){this.levels=a.levels},a.prototype.onMediaDetaching=function(){this._stopCapping()},a.prototype.detectPlayerSize=function(){if(this.media){var a=this.levels?this.levels.length:0;if(a){var c=this.hls;c.autoLevelCapping=this.getMaxLevel(a-1);c.autoLevelCapping>this.autoLevelCapping&&c.streamController.nextLevelSwitch();this.autoLevelCapping=c.autoLevelCapping}}},a.prototype.getMaxLevel=function(b){var c=this;if(!this.levels)return-1;var d=this.levels.filter(function(d,e){return a.isLevelAllowed(e,c.restrictedLevels)&&e<=b});return a.getMaxLevelByMediaSize(d,this.mediaWidth,this.mediaHeight)},a.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=p.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1E3),this.detectPlayerSize())},a.prototype._stopCapping=function(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=p.POSITIVE_INFINITY;this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(a.prototype,"mediaWidth",{get:function(){var b,c=this.media;return c&&(b=c.width||c.clientWidth||c.offsetWidth,b*=a.contentScaleFactor),b},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mediaHeight",{get:function(){var b,c=this.media;return c&&(b=c.height||c.clientHeight||c.offsetHeight,b*=a.contentScaleFactor),b},enumerable:!0,configurable:!0}),Object.defineProperty(a,"contentScaleFactor",{get:function(){var a=1;try{a=window.devicePixelRatio}catch(c){}return a},enumerable:!0,configurable:!0}),a.isLevelAllowed=function(a,c){return void 0===c&&(c=[]),-1===c.indexOf(a)},a.getMaxLevelByMediaSize=function(a,c,d){if(!a||a&&!a.length)return-1;for(var b,e,f=a.length-1,h=0;h<a.length;h+=1){var l=a[h];if((l.width>=c||l.height>=d)&&(b=l,!(e=a[h+1])||b.width!==e.width||b.height!==e.height)){f=h;break}}return f},a}(q("./src/event-handler.js")["default"]);n["default"]=f}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/eme-controller.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}x(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});p=q("./src/event-handler.js");var h=q("./src/events.js"),l=q("./src/errors.js"),f=q("./src/utils/logger.js"),d=window.XMLHttpRequest;q=function(a){function b(b){var c=a.call(this,b,h["default"].MEDIA_ATTACHED,h["default"].MANIFEST_PARSED)||this;return c._widevineLicenseUrl=b.config.widevineLicenseUrl,c._licenseXhrSetup=b.config.licenseXhrSetup,c._emeEnabled=b.config.emeEnabled,c._requestMediaKeySystemAccess=b.config.requestMediaKeySystemAccessFunc,c._mediaKeysList=[],c._media=null,c._hasSetMediaKeys=!1,c._isMediaEncrypted=!1,c._requestLicenseFailureCount=0,c}return m(b,a),b.prototype.getLicenseServerUrl=function(a){var b;switch(a){case "com.widevine.alpha":b=this._widevineLicenseUrl;break;default:b=null}return b||(f.logger.error('No license server URL configured for key-system "'+a+'"'),this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),b},b.prototype._attemptKeySystemAccess=function(a,b,d){var c=this;(b=function(a,b,c){switch(a){case "com.widevine.alpha":return d={videoCapabilities:[]},c.forEach(function(a){d.videoCapabilities.push({contentType:'video/mp4; codecs\x3d"'+a+'"'})}),[d];default:throw Error("Unknown key-system: "+a);}var d}(a,0,d))?(f.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(a,b).then(function(b){c._onMediaKeySystemAccessObtained(a,b)})["catch"](function(b){f.logger.error('Failed to obtain key-system "'+a+'" access:',b)})):f.logger.warn("Can not create config for key-system (maybe because platform is not supported):",a)},Object.defineProperty(b.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),b.prototype._onMediaKeySystemAccessObtained=function(a,b){var c=this;f.logger.log('Access for key-system "'+a+'" obtained');var d={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:b,mediaKeySystemDomain:a};this._mediaKeysList.push(d);b.createMediaKeys().then(function(b){d.mediaKeys=b;f.logger.log('Media-keys created for key-system "'+a+'"');c._onMediaKeysCreated()})["catch"](function(a){f.logger.error("Failed to create media-keys:",a)})},b.prototype._onMediaKeysCreated=function(){var a=this;this._mediaKeysList.forEach(function(b){b.mediaKeysSession||(b.mediaKeysSession=b.mediaKeys.createSession(),a._onNewMediaKeySession(b.mediaKeysSession))})},b.prototype._onNewMediaKeySession=function(a){var b=this;f.logger.log("New key-system session "+a.sessionId);a.addEventListener("message",function(c){b._onKeySessionMessage(a,c.message)},!1)},b.prototype._onKeySessionMessage=function(a,b){f.logger.log("Got EME message event, creating license request");this._requestLicense(b,function(b){f.logger.log("Received license data, updating key-session");a.update(b)})},b.prototype._onMediaEncrypted=function(a,b){f.logger.log('Media is encrypted using "'+a+'" init data type');this._isMediaEncrypted=!0;this._mediaEncryptionInitDataType=a;this._mediaEncryptionInitData=b;this._attemptSetMediaKeys();this._generateRequestWithPreferredKeySession()},b.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var a=this._mediaKeysList[0];if(!a||!a.mediaKeys)return f.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});f.logger.log("Setting keys for encrypted media");this._media.setMediaKeys(a.mediaKeys);this._hasSetMediaKeys=!0}},b.prototype._generateRequestWithPreferredKeySession=function(){var a=this,b=this._mediaKeysList[0];if(!b)return f.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(b.mediaKeysSessionInitialized)f.logger.warn("Key-Session already initialized but requested again");else{var d=b.mediaKeysSession;d||(f.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0}));var r=this._mediaEncryptionInitDataType,m=this._mediaEncryptionInitData;f.logger.log('Generating key-session request for "'+r+'" init data type');b.mediaKeysSessionInitialized=!0;d.generateRequest(r,m).then(function(){f.logger.debug("Key-session generation succeeded")})["catch"](function(b){f.logger.error("Error generating key-session request:",b);a.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},b.prototype._createLicenseXhr=function(a,b,g){var c=new d,e=this._licenseXhrSetup;try{if(e)try{e(c,a)}catch(C){c.open("POST",a,!0),e(c,a)}c.readyState||c.open("POST",a,!0)}catch(C){return f.logger.error("Error setting up key-system license XHR",C),void this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return c.responseType="arraybuffer",c.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,c,a,b,g),c},b.prototype._onLicenseRequestReadyStageChange=function(a,b,d,r){switch(a.readyState){case 4:if(200===a.status)this._requestLicenseFailureCount=0,f.logger.log("License request succeeded"),r(a.response);else{if(f.logger.error("License Request XHR failed ("+b+"). Status: "+a.status+" ("+a.statusText+")"),this._requestLicenseFailureCount++,3>=this._requestLicenseFailureCount)return f.logger.warn("Retrying license request, "+(3-this._requestLicenseFailureCount+1)+" attempts left"),void this._requestLicense(d,r);this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},b.prototype._generateLicenseRequestChallenge=function(a,b){var c;return"com.microsoft.playready"===a.mediaKeySystemDomain?f.logger.error("PlayReady is not supported (yet)"):"com.widevine.alpha"===a.mediaKeySystemDomain?c=b:f.logger.error("Unsupported key-system:",a.mediaKeySystemDomain),c},b.prototype._requestLicense=function(a,b){f.logger.log("Requesting content license for key-system");var c=this._mediaKeysList[0];if(!c)return f.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(h["default"].ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});var d=this.getLicenseServerUrl(c.mediaKeySystemDomain),e=this._createLicenseXhr(d,a,b);f.logger.log("Sending license request to URL: "+d);e.send(this._generateLicenseRequestChallenge(c,a))},b.prototype.onMediaAttached=function(a){var b=this;this._emeEnabled&&(this._media=a.media).addEventListener("encrypted",function(a){b._onMediaEncrypted(a.initDataType,a.initData)})},b.prototype.onManifestParsed=function(a){if(this._emeEnabled){var b=a.levels.map(function(a){return a.audioCodec});a=a.levels.map(function(a){return a.videoCodec});this._attemptKeySystemAccess("com.widevine.alpha",b,a)}},b}(p["default"]);n["default"]=q},"./src/controller/fps-controller.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,a){d.__proto__=a}||function(d,a){for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b])},function(d,a){function b(){this.constructor=d}x(d,a);d.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)});Object.defineProperty(n,"__esModule",{value:!0});var h=q("./src/events.js");p=q("./src/event-handler.js");var l=q("./src/utils/logger.js"),f=window.performance;q=function(d){function a(a){return d.call(this,a,h["default"].MEDIA_ATTACHING)||this}return m(a,d),a.prototype.destroy=function(){this.timer&&clearInterval(this.timer);this.isVideoPlaybackQualityAvailable=!1},a.prototype.onMediaAttaching=function(a){var b=this.hls.config;b.capLevelOnFPSDrop&&("function"==typeof(this.video=a.media instanceof window.HTMLVideoElement?a.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),b.fpsDroppedMonitoringPeriod))},a.prototype.checkFPS=function(a,c,d){a=f.now();if(c){if(this.lastTime){var b=d-this.lastDroppedFrames,e=c-this.lastDecodedFrames,m=1E3*b/(a-this.lastTime),C=this.hls;if(C.trigger(h["default"].FPS_DROP,{currentDropped:b,currentDecoded:e,totalDroppedFrames:d}),0<m&&b>C.config.fpsDroppedMonitoringThreshold*e)b=C.currentLevel,l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+b),0<b&&(-1===C.autoLevelCapping||C.autoLevelCapping>=b)&&(--b,C.trigger(h["default"].FPS_DROP_LEVEL_CAPPING,{level:b,droppedLevel:C.currentLevel}),C.autoLevelCapping=b,C.streamController.nextLevelSwitch())}this.lastTime=a;this.lastDroppedFrames=d;this.lastDecodedFrames=c}},a.prototype.checkFPSInterval=function(){var a=this.video;if(a)if(this.isVideoPlaybackQualityAvailable){var c=a.getVideoPlaybackQuality();this.checkFPS(a,c.totalVideoFrames,c.droppedVideoFrames)}else this.checkFPS(a,a.webkitDecodedFrameCount,a.webkitDroppedFrameCount)},a}(p["default"]);n["default"]=q},"./src/controller/fragment-finders.js":function(p,n,q){(function(p){function m(f,d,a){void 0===f&&(f=0);void 0===d&&(d=0);d=Math.min(d,a.duration+(a.deltaPTS?a.deltaPTS:0));return a.start+a.duration-d<=f?1:a.start-d>f&&a.start?-1:0}function h(f,d,a){return a.endProgramDateTime-1E3*Math.min(d,a.duration+(a.deltaPTS?a.deltaPTS:0))>f}Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/utils/binary-search.js");n.findFragmentByPDT=function(f,d,a){if(!Array.isArray(f)||!f.length||!p.isFinite(d)||d<f[0].programDateTime||d>=f[f.length-1].endProgramDateTime)return null;a=a||0;for(var b=0;b<f.length;++b){var c=f[b];if(h(d,a,c))return c}return null};n.findFragmentByPTS=function(f,d,a,b){void 0===a&&(a=0);void 0===b&&(b=0);return(f=f?d[f.sn-d[0].sn+1]:null)&&!m(a,b,f)?f:l["default"].search(d,m.bind(null,a,b))};n.fragmentWithinToleranceTest=m;n.pdtWithinToleranceTest=h}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/fragment-tracker.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/event-handler.js"),f=q("./src/events.js");n.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var d=function(a){function b(b){var c=a.call(this,b,f["default"].BUFFER_APPENDED,f["default"].FRAG_BUFFERED,f["default"].FRAG_LOADED)||this;return c.bufferPadding=.2,c.fragments=Object.create(null),c.timeRanges=Object.create(null),c.config=b.config,c}return h(b,a),b.prototype.destroy=function(){this.config=this.timeRanges=this.fragments=null;l["default"].prototype.destroy.call(this);a.prototype.destroy.call(this)},b.prototype.getBufferedFrag=function(a,b){var c=this.fragments,d=Object.keys(c).filter(function(d){d=c[d];if(d.body.type!==b||!d.buffered)return!1;d=d.body;return d.startPTS<=a&&a<=d.endPTS});if(0===d.length)return null;d=d.pop();return c[d].body},b.prototype.detectEvictedFragments=function(a,b){var c,d,e=this;Object.keys(this.fragments).forEach(function(g){g=e.fragments[g];if(!0===g.buffered){var f=g.range[a];if(f)for(c=f.time,f=0;f<c.length;f++)if(d=c[f],!1===e.isTimeBuffered(d.startPTS,d.endPTS,b)){e.removeFragment(g.body);break}}})},b.prototype.detectPartialFragments=function(a){var b=this,c=this.getFragmentKey(a),d=this.fragments[c];d&&(d.buffered=!0,Object.keys(this.timeRanges).forEach(function(c){a.hasElementaryStream(c)&&(d.range[c]=b.getBufferedTimes(a.startPTS,a.endPTS,b.timeRanges[c]))}))},b.prototype.getBufferedTimes=function(a,b,d){for(var c,e,g=[],f=!1,h=0;h<d.length;h++){if(c=d.start(h)-this.bufferPadding,e=d.end(h)+this.bufferPadding,c<=a&&b<=e){g.push({startPTS:Math.max(a,d.start(h)),endPTS:Math.min(b,d.end(h))});break}if(a<e&&c<b)g.push({startPTS:Math.max(a,d.start(h)),endPTS:Math.min(b,d.end(h))}),f=!0;else if(b<=c)break}return{time:g,partial:f}},b.prototype.getFragmentKey=function(a){return a.type+"_"+a.level+"_"+a.urlId+"_"+a.sn},b.prototype.getPartialFragment=function(a){var b,c,d,f=this,h=null,l=0;return Object.keys(this.fragments).forEach(function(e){e=f.fragments[e];f.isPartial(e)&&(c=e.body.startPTS-f.bufferPadding,d=e.body.endPTS+f.bufferPadding,c<=a&&a<=d&&(b=Math.min(a-c,d-a),l<=b&&(h=e.body,l=b)))}),h},b.prototype.getState=function(a){a=this.getFragmentKey(a);a=this.fragments[a];var b=n.FragmentState.NOT_LOADED;return void 0!==a&&(b=a.buffered?!0===this.isPartial(a)?n.FragmentState.PARTIAL:n.FragmentState.OK:n.FragmentState.APPENDING),b},b.prototype.isPartial=function(a){return!0===a.buffered&&(void 0!==a.range.video&&!0===a.range.video.partial||void 0!==a.range.audio&&!0===a.range.audio.partial)},b.prototype.isTimeBuffered=function(a,b,d){for(var c,e,g=0;g<d.length;g++){if(c=d.start(g)-this.bufferPadding,e=d.end(g)+this.bufferPadding,c<=a&&b<=e)return!0;if(b<=c)break}return!1},b.prototype.onFragLoaded=function(a){a=a.frag;p.isFinite(a.sn)&&!a.bitrateTest&&(this.fragments[this.getFragmentKey(a)]={body:a,range:Object.create(null),buffered:!1})},b.prototype.onBufferAppended=function(a){var b=this;this.timeRanges=a.timeRanges;Object.keys(this.timeRanges).forEach(function(a){b.detectEvictedFragments(a,b.timeRanges[a])})},b.prototype.onFragBuffered=function(a){this.detectPartialFragments(a.frag)},b.prototype.hasFragment=function(a){a=this.getFragmentKey(a);return void 0!==this.fragments[a]},b.prototype.removeFragment=function(a){a=this.getFragmentKey(a);delete this.fragments[a]},b.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},b}(l["default"]);n.FragmentTracker=d}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/gap-controller.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/utils/buffer-helper.js"),m=q("./src/errors.js"),h=q("./src/events.js"),l=q("./src/utils/logger.js");p=function(){function f(d,a,b,c){this.config=d;this.media=a;this.fragmentTracker=b;this.hls=c;this.stallReported=!1}return f.prototype.poll=function(d,a){var b=this.config,c=this.media,e=c.currentTime,g=window.performance.now();if(e!==d)return this.stallReported&&(l.logger.warn("playback not stuck anymore @"+e+", after "+Math.round(g-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(c.ended||!c.buffered.length||2<c.readyState||c.seeking&&x.BufferHelper.isBuffered(c,e))){var f=g-this.stalled,b=x.BufferHelper.bufferInfo(c,e,b.maxBufferHole);this.stalled?(1E3<=f&&this._reportStall(b.len),this._tryFixBufferStall(b,f)):this.stalled=g}},f.prototype._tryFixBufferStall=function(d,a){var b=this.config,c=this.fragmentTracker.getPartialFragment(this.media.currentTime);c&&this._trySkipBufferHole(c);.5<d.len&&a>1E3*b.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},f.prototype._reportStall=function(d){var a=this.hls,b=this.media;this.stallReported||(this.stallReported=!0,l.logger.warn("Playback stalling at @"+b.currentTime+" due to low buffer"),a.trigger(h["default"].ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:d}))},f.prototype._trySkipBufferHole=function(d){for(var a=this.hls,b=this.media,c=b.currentTime,e=0,g=0;g<b.buffered.length;g++){var f=b.buffered.start(g);if(e<=c&&c<f)return b.currentTime=Math.max(f,b.currentTime+.1),l.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+b.currentTime),this.stalled=null,void a.trigger(h["default"].ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+b.currentTime,frag:d});e=b.buffered.end(g)}},f.prototype._tryNudgeBuffer=function(){var d=this.config,a=this.hls,b=this.media,c=b.currentTime,e=(this.nudgeRetry||0)+1;(this.nudgeRetry=e)<d.nudgeMaxRetry?(d=c+e*d.nudgeOffset,l.logger.log("adjust currentTime from "+c+" to "+d),b.currentTime=d,a.trigger(h["default"].ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})):(l.logger.error("still stuck in high buffer @"+c+" after "+d.nudgeMaxRetry+", raise fatal error"),a.trigger(h["default"].ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0}))},f}();n["default"]=p},"./src/controller/id3-track-controller.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}x(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var h=q("./src/events.js"),l=q("./src/event-handler.js"),f=q("./src/demux/id3.js"),d=q("./src/utils/texttrack-utils.js");p=function(a){function b(b){b=a.call(this,b,h["default"].MEDIA_ATTACHED,h["default"].MEDIA_DETACHING,h["default"].FRAG_PARSING_METADATA)||this;return b.id3Track=void 0,b.media=void 0,b}return m(b,a),b.prototype.destroy=function(){l["default"].prototype.destroy.call(this)},b.prototype.onMediaAttached=function(a){this.media=a.media;this.media},b.prototype.onMediaDetaching=function(){d.clearCurrentCues(this.id3Track);this.media=this.id3Track=void 0},b.prototype.getID3Track=function(a){for(var b=0;b<a.length;b++){var c=a[b];if("metadata"===c.kind&&"id3"===c.label)return d.sendAddTrackEvent(c,this.media),c}return this.media.addTextTrack("metadata","id3")},b.prototype.onFragParsingMetadata=function(a){var b=a.frag;a=a.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var c=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,d=0;d<a.length;d++){var h=f["default"].getID3Frames(a[d].data);if(h){var l=a[d].pts,m=d<a.length-1?a[d+1].pts:b.endPTS;l===m&&(m+=1E-4);for(var D=0;D<h.length;D++){var B=h[D];if(!f["default"].isTimeStampFrame(B)){var n=new c(l,m,"");n.value=B;this.id3Track.addCue(n)}}}}},b}(l["default"]);n["default"]=p},"./src/controller/level-controller.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}x(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var h,l=q("./src/events.js");p=q("./src/event-handler.js");var f=q("./src/utils/logger.js"),d=q("./src/errors.js"),a=q("./src/utils/codecs.js"),b=q("./src/controller/level-helper.js"),c=window.performance;q=function(e){function g(a){a=e.call(this,a,l["default"].MANIFEST_LOADED,l["default"].LEVEL_LOADED,l["default"].AUDIO_TRACK_SWITCHED,l["default"].FRAG_LOADED,l["default"].ERROR)||this;return a.canload=!1,a.currentLevelIndex=null,a.manualLevelIndex=-1,a.timer=null,h=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),a}return m(g,e),g.prototype.onHandlerDestroying=function(){this.clearTimer();this.manualLevelIndex=-1},g.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},g.prototype.startLoad=function(){var a=this._levels;this.canload=!0;this.levelRetryCount=0;a&&a.forEach(function(a){a.loadError=0;var b=a.details;b&&b.live&&(a.details=void 0)});null!==this.timer&&this.loadLevel()},g.prototype.stopLoad=function(){this.canload=!1},g.prototype.onManifestLoaded=function(c){var e,g=[],m=[],r={},B=null,n=!1,q=!1;if(c.levels.forEach(function(a){var c=a.attrs;a.loadError=0;a.fragmentError=!1;n=n||!!a.videoCodec;q=q||!!a.audioCodec;h&&a.audioCodec&&-1!==a.audioCodec.indexOf("mp4a.40.34")&&(a.audioCodec=void 0);(B=r[a.bitrate])?B.url.push(a.url):(a.url=[a.url],a.urlId=0,r[a.bitrate]=a,g.push(a));c&&(c.AUDIO&&(q=!0,b.addGroupId(B||a,"audio",c.AUDIO)),c.SUBTITLES&&b.addGroupId(B||a,"text",c.SUBTITLES))}),n&&q&&(g=g.filter(function(a){return!!a.videoCodec})),g=g.filter(function(b){var c=b.audioCodec;b=b.videoCodec;return(!c||a.isCodecSupportedInMp4(c,"audio"))&&(!b||a.isCodecSupportedInMp4(b,"video"))}),c.audioTracks&&(m=c.audioTracks.filter(function(b){return!b.audioCodec||a.isCodecSupportedInMp4(b.audioCodec,"audio")})).forEach(function(a,b){a.id=b}),0<g.length){e=g[0].bitrate;g.sort(function(a,b){return a.bitrate-b.bitrate});this._levels=g;for(var p=0;p<g.length;p++)if(g[p].bitrate===e){this._firstLevel=p;f.logger.log("manifest loaded,"+g.length+" level(s) found, first bitrate:"+e);break}this.hls.trigger(l["default"].MANIFEST_PARSED,{levels:g,audioTracks:m,firstLevel:this._firstLevel,stats:c.stats,audio:q,video:n,altAudio:m.some(function(a){return!!a.url})})}else this.hls.trigger(l["default"].ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(g.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(a){var b=this._levels;b&&(a=Math.min(a,b.length-1),this.currentLevelIndex===a&&b[a].details||this.setLevelInternal(a))},enumerable:!0,configurable:!0}),g.prototype.setLevelInternal=function(a){var b=this._levels,c=this.hls;if(0<=a&&a<b.length){if(this.clearTimer(),this.currentLevelIndex!==a){f.logger.log("switching to level "+a);var e=b[this.currentLevelIndex=a];e.level=a;c.trigger(l["default"].LEVEL_SWITCHING,e)}b=b[a];e=b.details;if(!e||e.live)e=b.urlId,c.trigger(l["default"].LEVEL_LOADING,{url:b.url[e],level:a,id:e})}else c.trigger(l["default"].ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.LEVEL_SWITCH_ERROR,level:a,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(g.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(a){this.manualLevelIndex=a;void 0===this._startLevel&&(this._startLevel=a);-1!==a&&(this.level=a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(a){this._firstLevel=a},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"startLevel",{get:function(){if(void 0!==this._startLevel)return this._startLevel;var a=this.hls.config.startLevel;return void 0!==a?a:this._firstLevel},set:function(a){this._startLevel=a},enumerable:!0,configurable:!0}),g.prototype.onError=function(a){if(a.fatal)a.type===d.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var b,c=!1,e=!1;switch(a.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:b=a.frag.level;e=!0;break;case d.ErrorDetails.LEVEL_LOAD_ERROR:case d.ErrorDetails.LEVEL_LOAD_TIMEOUT:b=a.context.level;c=!0;break;case d.ErrorDetails.REMUX_ALLOC_ERROR:b=a.level,c=!0}void 0!==b&&this.recoverLevel(a,b,c,e)}},g.prototype.recoverLevel=function(a,b,c,d){var e,g,h,l=this;g=this.hls.config;var m=a.details,r=this._levels[b];if(r.loadError++,r.fragmentError=d,c){if(!(this.levelRetryCount+1<=g.levelLoadingMaxRetry))return f.logger.error("level controller, cannot recover from "+m+" error"),this.currentLevelIndex=null,this.clearTimer(),void(a.fatal=!0);g=Math.min(Math.pow(2,this.levelRetryCount)*g.levelLoadingRetryDelay,g.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return l.loadLevel()},g);a.levelRetry=!0;this.levelRetryCount++;f.logger.warn("level controller, "+m+", retry in "+g+" ms, current retry count is "+this.levelRetryCount)}(c||d)&&(1<(e=r.url.length)&&r.loadError<e?(r.urlId=(r.urlId+1)%e,r.details=void 0,f.logger.warn("level controller, "+m+" for level "+b+": switching to redundant URL-id "+r.urlId)):-1===this.manualLevelIndex?(h=0===b?this._levels.length-1:b-1,f.logger.warn("level controller, "+m+": switch to "+h),this.hls.nextAutoLevel=this.currentLevelIndex=h):d&&(f.logger.warn("level controller, "+m+": reload a fragment"),this.currentLevelIndex=null))},g.prototype.onFragLoaded=function(a){a=a.frag;void 0!==a&&"main"===a.type&&(a=this._levels[a.level],void 0!==a&&(a.fragmentError=!1,a.loadError=0,this.levelRetryCount=0))},g.prototype.onLevelLoaded=function(a){var b=this,d=a.level;if(d===this.currentLevelIndex){var e=this._levels[d];e.fragmentError||(e.loadError=0,this.levelRetryCount=0);d=a.details;if(d.live){var g=1E3*(d.averagetargetduration?d.averagetargetduration:d.targetduration),h=g;(e=e.details)&&d.endSN===e.endSN&&(h/=2,f.logger.log("same live playlist, reload twice faster"));h-=c.now()-a.stats.trequest;h=Math.max(g/2,Math.round(h));f.logger.log("live playlist, reload in "+Math.round(h)+" ms");this.timer=setTimeout(function(){return b.loadLevel()},h)}else this.clearTimer()}},g.prototype.onAudioTrackSwitched=function(a){var b=this.hls.audioTracks[a.id].groupId;if((a=this.hls.levels[this.currentLevelIndex])&&a.audioGroupIds){var c=a.audioGroupIds.findIndex(function(a){return a===b});c!==a.urlId&&(a.urlId=c,this.startLoad())}},g.prototype.loadLevel=function(){if(f.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var a=this._levels[this.currentLevelIndex];if("object"==typeof a&&0<a.url.length){var b=this.currentLevelIndex,c=a.urlId,a=a.url[c];f.logger.log("Attempt loading level index "+b+" with URL-id "+c);this.hls.trigger(l["default"].LEVEL_LOADING,{url:a,level:b,id:c})}}},Object.defineProperty(g.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(a){this.level=a;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=a)},enumerable:!0,configurable:!0}),g}(p["default"]);n["default"]=q},"./src/controller/level-helper.js":function(p,n,q){(function(p){function m(f,d,a){var b=f[d];f=f[a];var c=f.startPTS;p.isFinite(c)?d<a?(b.duration=c-b.start,0>b.duration&&l.logger.warn("negative duration computed for frag "+b.sn+",level "+b.level+", there should be some duration drift between playlist and fragment!")):(f.duration=b.start-c,0>f.duration&&l.logger.warn("negative duration computed for frag "+f.sn+",level "+f.level+", there should be some duration drift between playlist and fragment!")):f.start=d<a?b.start+b.duration:Math.max(b.start-f.duration,0)}function h(f,d,a,b,c,e){var g=a;if(p.isFinite(d.startPTS)){var h=Math.abs(d.startPTS-a);p.isFinite(d.deltaPTS)?d.deltaPTS=Math.max(h,d.deltaPTS):d.deltaPTS=h;g=Math.max(a,d.startPTS);a=Math.min(a,d.startPTS);b=Math.max(b,d.endPTS);c=Math.min(c,d.startDTS);e=Math.max(e,d.endDTS)}h=a-d.start;d.start=d.startPTS=a;d.maxStartPTS=g;d.endPTS=b;d.startDTS=c;d.endDTS=e;d.duration=b-a;a=d.sn;if(!f||a<f.startSN||a>f.endSN)return 0;a-=f.startSN;(b=f.fragments)[a]=d;for(d=a;0<d;d--)m(b,d,d-1);for(d=a;d<b.length-1;d++)m(b,d,d+1);return f.PTSKnown=!0,h}Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/utils/logger.js");n.addGroupId=function(f,d,a){switch(d){case "audio":f.audioGroupIds||(f.audioGroupIds=[]);f.audioGroupIds.push(a);break;case "text":f.textGroupIds||(f.textGroupIds=[]),f.textGroupIds.push(a)}};n.updatePTS=m;n.updateFragPTSDTS=h;n.mergeDetails=function(f,d){var a,b=Math.max(f.startSN,d.startSN)-d.startSN,c=Math.min(f.endSN,d.endSN)-d.startSN,e=d.startSN-f.startSN,g=f.fragments,m=d.fragments,n=0;if(d.initSegment&&f.initSegment&&(d.initSegment=f.initSegment),c<b)d.PTSKnown=!1;else{for(;b<=c;b++){var C=g[e+b],v=m[b];v&&C&&(n=C.cc-v.cc,p.isFinite(C.startPTS)&&(v.start=v.startPTS=C.startPTS,v.endPTS=C.endPTS,v.duration=C.duration,v.backtracked=C.backtracked,v.dropped=C.dropped,a=v))}if(n)for(l.logger.log("discontinuity sliding from playlist, take drift into account"),b=0;b<m.length;b++)m[b].cc+=n;if(a)h(d,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS);else if(0<=e&&e<g.length)for(a=g[e].start,b=0;b<m.length;b++)m[b].start+=a;d.PTSKnown=f.PTSKnown}}}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/stream-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/utils/binary-search.js"),f=q("./src/utils/buffer-helper.js"),d=q("./src/demux/demuxer.js"),a=q("./src/events.js"),b=q("./src/controller/fragment-tracker.js"),c=q("./src/loader/fragment.js"),e=q("./src/loader/playlist-loader.js"),g=q("./src/controller/level-helper.js"),r=q("./src/utils/time-ranges.js"),E=q("./src/errors.js"),C=q("./src/utils/logger.js"),v=q("./src/utils/discontinuities.js"),D=q("./src/controller/fragment-finders.js"),B=q("./src/controller/gap-controller.js"),F=q("./src/controller/base-stream-controller.js"),x=function(m){function n(b,c){var d=m.call(this,b,a["default"].MEDIA_ATTACHED,a["default"].MEDIA_DETACHING,a["default"].MANIFEST_LOADING,a["default"].MANIFEST_PARSED,a["default"].LEVEL_LOADED,a["default"].KEY_LOADED,a["default"].FRAG_LOADED,a["default"].FRAG_LOAD_EMERGENCY_ABORTED,a["default"].FRAG_PARSING_INIT_SEGMENT,a["default"].FRAG_PARSING_DATA,a["default"].FRAG_PARSED,a["default"].ERROR,a["default"].AUDIO_TRACK_SWITCHING,a["default"].AUDIO_TRACK_SWITCHED,a["default"].BUFFER_CREATED,a["default"].BUFFER_APPENDED,a["default"].BUFFER_FLUSHED)||this;return d.fragmentTracker=c,d.config=b.config,d.audioCodecSwap=!1,d._state=F.State.STOPPED,d.stallReported=!1,d.gapController=null,d}return h(n,m),n.prototype.onHandlerDestroying=function(){this.stopLoad();m.prototype.onHandlerDestroying.call(this)},n.prototype.onHandlerDestroyed=function(){this.state=F.State.STOPPED;this.fragmentTracker=null;m.prototype.onHandlerDestroyed.call(this)},n.prototype.startLoad=function(a){if(this.levels){var b=this.lastCurrentTime,c=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var d=c.startLevel;-1===d&&(d=0,this.bitrateTest=!0);this.level=c.nextLoadLevel=d;this.loadedmetadata=!1}0<b&&-1===a&&(C.logger.log("override startPosition with lastCurrentTime @"+b.toFixed(3)),a=b);this.state=F.State.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a;this.tick()}else this.forceStartLoad=!0,this.state=F.State.STOPPED},n.prototype.stopLoad=function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragmentTracker.removeFragment(a),this.fragCurrent=null);this.fragPrevious=null;this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);this.clearInterval();this.state=F.State.STOPPED;this.forceStartLoad=!1},n.prototype.doTick=function(){switch(this.state){case F.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case F.State.IDLE:this._doTickIdle();break;case F.State.WAITING_LEVEL:var a=this.levels[this.level];a&&a.details&&(this.state=F.State.IDLE);break;case F.State.FRAG_LOADING_WAITING_RETRY:var a=window.performance.now(),b=this.retryDate;(!b||b<=a||this.media&&this.media.seeking)&&(C.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=F.State.IDLE)}this._checkBuffer();this._checkFragmentChanged()},n.prototype._doTickIdle=function(){var b=this.hls,c=b.config,d=this.media;if(void 0!==this.levelLastLoaded&&(d||!this.startFragRequested&&c.startFragPrefetch)){var e;e=this.loadedmetadata?d.currentTime:this.nextLoadPosition;var g=b.nextLoadLevel,h=this.levels[g];if(h){var l;l=(l=h.bitrate)?Math.max(8*c.maxBufferSize/l,c.maxBufferLength):c.maxBufferLength;l=Math.min(l,c.maxMaxBufferLength);c=f.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:d,e,c.maxBufferHole);d=c.len;if(!(l<=d))if(C.logger.trace("buffer length of "+d.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=b.nextLoadLevel=g,b=h.details,!b||b.live&&this.levelLastLoaded!==g)this.state=F.State.WAITING_LEVEL;else{if(this._streamEnded(c,b))return e={},this.altAudio&&(e.type="video"),this.hls.trigger(a["default"].BUFFER_EOS,e),void(this.state=F.State.ENDED);this._fetchPayloadOrEos(e,c,b)}}}},n.prototype._fetchPayloadOrEos=function(a,b,c){var d=this.fragPrevious,e=this.level,g=c.fragments,f=g.length;if(0!==f){var h,l=g[0].start,m=g[f-1].start+g[f-1].duration;b=b.end;if(c.initSegment&&!c.initSegment.data)h=c.initSegment;else if(c.live){h=this.config.initialLiveManifestSize;if(f<h)return void C.logger.warn("Can not start playback of a level, reason: not enough fragments "+f+" \x3c "+h);if(null===(h=this._ensureFragmentAtLivePoint(c,b,l,m,d,g,f)))return}else b<l&&(h=g[0]);h||(h=this._findFragment(l,d,f,g,b,m,c));h&&(h.encrypted?(C.logger.log("Loading key for "+h.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+e),this._loadKey(h)):(C.logger.log("Loading "+h.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+e+", currentTime:"+a.toFixed(3)+",bufferEnd:"+b.toFixed(3)),this._loadFragment(h)))}},n.prototype._ensureFragmentAtLivePoint=function(a,b,c,d,e,g,f){var h,m=this.hls.config,r=this.media;b<Math.max(c-m.maxFragLookUpTolerance,d-(void 0!==m.liveMaxLatencyDuration?m.liveMaxLatencyDuration:m.liveMaxLatencyDurationCount*a.targetduration))&&(c=this.liveSyncPosition=this.computeLivePosition(c,a),C.logger.log("buffer end: "+b.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),b=c,r&&r.readyState&&r.duration>c&&(r.currentTime=c),this.nextLoadPosition=c);if(a.PTSKnown&&d<b&&r&&r.readyState)return null;this.startFragRequested&&!a.PTSKnown&&(e&&(a.hasProgramDateTime?(C.logger.log("live playlist, switching playlist, load frag with same PDT: "+e.programDateTime),h=D.findFragmentByPDT(g,e.endProgramDateTime,m.maxFragLookUpTolerance)):(b=e.sn+1,b>=a.startSN&&b<=a.endSN&&(a=g[b-a.startSN],e.cc===a.cc&&(h=a,C.logger.log("live playlist, switching playlist, load frag with next SN: "+h.sn))),h||(h=l["default"].search(g,function(a){return e.cc-a.cc}))&&C.logger.log("live playlist, switching playlist, load frag with same CC: "+h.sn))),h||(h=g[Math.min(f-1,Math.round(f/2))],C.logger.log("live playlist, switching playlist, unknown, load middle frag : "+h.sn)));return h},n.prototype._findFragment=function(a,b,c,d,e,g,f){a=this.hls.config;if(c=e<g?D.findFragmentByPTS(b,d,e,e>g-a.maxFragLookUpTolerance?0:a.maxFragLookUpTolerance):d[c-1]){e=c.sn-f.startSN;var h=b&&c.level===b.level;g=d[e-1];d=d[e+1];b&&c.sn===b.sn&&(h&&!c.backtracked?c.sn<f.endSN?(f=b.deltaPTS)&&f>a.maxBufferHole&&b.dropped&&e?(c=g,C.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(c=d,C.logger.log("SN just loaded, load next one: "+c.sn,c)):c=null:c.backtracked&&(d&&d.backtracked?(C.logger.warn("Already backtracked from fragment "+d.sn+", will not backtrack to fragment "+c.sn+". Loading fragment "+d.sn),c=d):(C.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),c.dropped=0,g?(c=g).backtracked=!0:e&&(c=null))))}return c},n.prototype._loadKey=function(b){this.state=F.State.KEY_LOADING;this.hls.trigger(a["default"].KEY_LOADING,{frag:b})},n.prototype._loadFragment=function(c){var e=this.fragmentTracker.getState(c);this.fragCurrent=c;this.startFragRequested=!0;p.isFinite(c.sn)&&!c.bitrateTest&&(this.nextLoadPosition=c.start+c.duration);c.backtracked||e===b.FragmentState.NOT_LOADED||e===b.FragmentState.PARTIAL?(c.autoLevel=this.hls.autoLevelEnabled,c.bitrateTest=this.bitrateTest,this.hls.trigger(a["default"].FRAG_LOADING,{frag:c}),this.demuxer||(this.demuxer=new d["default"](this.hls,"main")),this.state=F.State.FRAG_LOADING):e===b.FragmentState.APPENDING&&this._reduceMaxBufferLength(c.duration)&&this.fragmentTracker.removeFragment(c)},Object.defineProperty(n.prototype,"state",{get:function(){return this._state},set:function(b){if(this.state!==b){var c=this.state;this._state=b;C.logger.log("main stream:"+c+"-\x3e"+b);this.hls.trigger(a["default"].STREAM_STATE_TRANSITION,{previousState:c,nextState:b})}},enumerable:!0,configurable:!0}),n.prototype.getBufferedFrag=function(a){return this.fragmentTracker.getBufferedFrag(a,e["default"].LevelType.MAIN)},Object.defineProperty(n.prototype,"currentLevel",{get:function(){var a=this.media;return a&&(a=this.getBufferedFrag(a.currentTime))?a.level:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextBufferedFrag",{get:function(){var a=this.media;return a?this.followingBufferedFrag(this.getBufferedFrag(a.currentTime)):null},enumerable:!0,configurable:!0}),n.prototype.followingBufferedFrag=function(a){return a?this.getBufferedFrag(a.endPTS+.5):null},Object.defineProperty(n.prototype,"nextLevel",{get:function(){var a=this.nextBufferedFrag;return a?a.level:-1},enumerable:!0,configurable:!0}),n.prototype._checkFragmentChanged=function(){var b,c,d=this.media;d&&d.readyState&&!1===d.seeking&&((c=d.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=c),f.BufferHelper.isBuffered(d,c)?b=this.getBufferedFrag(c):f.BufferHelper.isBuffered(d,c+.1)&&(b=this.getBufferedFrag(c+.1)),b)&&b!==this.fragPlaying&&(this.hls.trigger(a["default"].FRAG_CHANGED,{frag:b}),c=b.level,this.fragPlaying&&this.fragPlaying.level===c||this.hls.trigger(a["default"].LEVEL_SWITCHED,{level:c}),this.fragPlaying=b)},n.prototype.immediateLevelSwitch=function(){if(C.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var a=this.media,b=void 0;a?(b=a.paused,a.pause()):b=!0;this.previouslyPaused=b}(a=this.fragCurrent)&&a.loader&&a.loader.abort();this.fragCurrent=null;this.flushMainBuffer(0,p.POSITIVE_INFINITY)},n.prototype.immediateLevelSwitchEnd=function(){var a=this.media;a&&a.buffered.length&&(this.immediateSwitch=!1,f.BufferHelper.isBuffered(a,a.currentTime)&&(a.currentTime-=1E-4),this.previouslyPaused||a.play())},n.prototype.nextLevelSwitch=function(){var a=this.media;if(a&&a.readyState){var b,c=void 0;if((b=this.getBufferedFrag(a.currentTime))&&1<b.startPTS&&this.flushMainBuffer(0,b.startPTS-1),a.paused)b=0;else{b=this.levels[this.hls.nextLoadLevel];var d=this.fragLastKbps;b=d&&this.fragCurrent?this.fragCurrent.duration*b.bitrate/(1E3*d)+1:0}(c=this.getBufferedFrag(a.currentTime+b))&&(c=this.followingBufferedFrag(c))&&((a=this.fragCurrent)&&a.loader&&a.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(c.maxStartPTS,p.POSITIVE_INFINITY))}},n.prototype.flushMainBuffer=function(b,c){this.state=F.State.BUFFER_FLUSHING;var d={startOffset:b,endOffset:c};this.altAudio&&(d.type="video");this.hls.trigger(a["default"].BUFFER_FLUSHING,d)},n.prototype.onMediaAttached=function(a){a=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);a.addEventListener("seeking",this.onvseeking);a.addEventListener("seeked",this.onvseeked);a.addEventListener("ended",this.onvended);var b=this.config;this.levels&&b.autoStartLoad&&this.hls.startLoad(b.startPosition);this.gapController=new B["default"](b,a,this.fragmentTracker,this.hls)},n.prototype.onMediaDetaching=function(){var a=this.media;a&&a.ended&&(C.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var b=this.levels;b&&b.forEach(function(a){a.details&&a.details.fragments.forEach(function(a){a.backtracked=void 0})});a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("seeked",this.onvseeked),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.stopLoad()},n.prototype.onMediaSeeked=function(){var a=this.media,a=a?a.currentTime:void 0;p.isFinite(a)&&C.logger.log("media seeked to "+a.toFixed(3));this.tick()},n.prototype.onManifestLoading=function(){C.logger.log("trigger BUFFER_RESET");this.hls.trigger(a["default"].BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=!1;this.startPosition=this.lastCurrentTime=0},n.prototype.onManifestParsed=function(a){var b,c=!1,d=!1;a.levels.forEach(function(a){(b=a.audioCodec)&&(-1!==b.indexOf("mp4a.40.2")&&(c=!0),-1!==b.indexOf("mp4a.40.5")&&(d=!0))});(this.audioCodecSwitch=c&&d)&&C.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=a.levels;this.startFragRequested=!1;a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)},n.prototype.onLevelLoaded=function(b){var c=b.details,d=b.level,e=this.levels[this.levelLastLoaded],f=this.levels[d];b=c.totalduration;var h=0;if(C.logger.log("level "+d+" loaded ["+c.startSN+","+c.endSN+"],duration:"+b),c.live){var l=f.details;l&&0<c.fragments.length?(g.mergeDetails(l,c),h=c.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(h,l),c.PTSKnown&&p.isFinite(h)?C.logger.log("live playlist sliding:"+h.toFixed(3)):(C.logger.log("live playlist - outdated PTS, unknown sliding"),v.alignStream(this.fragPrevious,e,c))):(C.logger.log("live playlist - first load, unknown sliding"),c.PTSKnown=!1,v.alignStream(this.fragPrevious,e,c))}else c.PTSKnown=!1;if(f.details=c,this.levelLastLoaded=d,this.hls.trigger(a["default"].LEVEL_UPDATED,{details:c,level:d}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime)d=c.startTimeOffset,p.isFinite(d)?(0>d&&(C.logger.log("negative start time offset "+d+", count from end of last fragment"),d=h+b+d),C.logger.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):c.live?(this.startPosition=this.computeLivePosition(h,c),C.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition;this.nextLoadPosition=this.startPosition}this.state===F.State.WAITING_LEVEL&&(this.state=F.State.IDLE);this.tick()},n.prototype.onKeyLoaded=function(){this.state===F.State.KEY_LOADING&&(this.state=F.State.IDLE,this.tick())},n.prototype.onFragLoaded=function(b){var c=this.fragCurrent,e=this.hls,g=this.levels,f=this.media,h=b.frag;if(this.state===F.State.FRAG_LOADING&&c&&"main"===h.type&&h.level===c.level&&h.sn===c.sn){var l=b.stats,g=g[c.level],m=g.details;(this.bitrateTest=!1,this.stats=l,C.logger.log("Loaded "+c.sn+" of ["+m.startSN+" ,"+m.endSN+"],level "+c.level),h.bitrateTest&&e.nextLoadLevel)?(this.state=F.State.IDLE,this.startFragRequested=!1,l.tparsed=l.tbuffered=window.performance.now(),e.trigger(a["default"].FRAG_BUFFERED,{stats:l,frag:c,id:"main"}),this.tick()):"initSegment"===h.sn?(this.state=F.State.IDLE,l.tparsed=l.tbuffered=window.performance.now(),m.initSegment.data=b.payload,e.trigger(a["default"].FRAG_BUFFERED,{stats:l,frag:c,id:"main"}),this.tick()):(C.logger.log("Parsing "+c.sn+" of ["+m.startSN+" ,"+m.endSN+"],level "+c.level+", cc "+c.cc),this.state=F.State.PARSING,this.pendingBuffering=!0,this.appended=!1,h.bitrateTest&&(h.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:h})),e=!(f&&f.seeking)&&(m.PTSKnown||!m.live),f=m.initSegment?m.initSegment.data:[],h=this._getAudioCodec(g),(this.demuxer=this.demuxer||new d["default"](this.hls,"main")).push(b.payload,f,h,g.videoCodec,c,m.totalduration,e))}this.fragLoadError=0},n.prototype.onFragParsingInitSegment=function(b){var c=this.fragCurrent,d=b.frag;if(c&&"main"===b.id&&d.sn===c.sn&&d.level===c.level&&this.state===F.State.PARSING){var c=b.tracks,d=void 0,e;if(c.audio&&this.altAudio&&delete c.audio,e=c.audio){var g=this.levels[this.level].audioCodec,f=navigator.userAgent.toLowerCase();g&&this.audioCodecSwap&&(C.logger.log("swapping playlist audio codec"),g=-1!==g.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");this.audioCodecSwitch&&1!==e.metadata.channelCount&&-1===f.indexOf("firefox")&&(g="mp4a.40.5");-1!==f.indexOf("android")&&"audio/mpeg"!==e.container&&(g="mp4a.40.2",C.logger.log("Android: force audio codec to "+g));e.levelCodec=g;e.id=b.id}for(d in(e=c.video)&&(e.levelCodec=this.levels[this.level].videoCodec,e.id=b.id),this.hls.trigger(a["default"].BUFFER_CODECS,c),c)e=c[d],C.logger.log("main track:"+d+",container:"+e.container+",codecs[level/parsed]\x3d["+e.levelCodec+"/"+e.codec+"]"),(b=e.initSegment)&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(a["default"].BUFFER_APPENDING,{type:d,data:b,parent:"main",content:"initSegment"}));this.tick()}},n.prototype.onFragParsingData=function(b){var d=this,e=this.fragCurrent,f=b.frag;if(e&&"main"===b.id&&f.sn===e.sn&&f.level===e.level&&("audio"!==b.type||!this.altAudio)&&this.state===F.State.PARSING){f=this.levels[this.level];if(p.isFinite(b.endPTS)||(b.endPTS=b.startPTS+e.duration,b.endDTS=b.startDTS+e.duration),!0===b.hasAudio&&e.addElementaryStream(c["default"].ElementaryStreamTypes.AUDIO),!0===b.hasVideo&&e.addElementaryStream(c["default"].ElementaryStreamTypes.VIDEO),C.logger.log("Parsed "+b.type+",PTS:["+b.startPTS.toFixed(3)+","+b.endPTS.toFixed(3)+"],DTS:["+b.startDTS.toFixed(3)+"/"+b.endDTS.toFixed(3)+"],nb:"+b.nb+",dropped:"+(b.dropped||0)),"video"===b.type)if(e.dropped=b.dropped,e.dropped)if(e.backtracked)C.logger.warn("Already backtracked on this fragment, appending with the gap",e.sn);else{var h=f.details;if(!h||e.sn!==h.startSN)return C.logger.warn("missing video frame(s), backtracking fragment",e.sn),this.fragmentTracker.removeFragment(e),e.backtracked=!0,this.nextLoadPosition=b.startPTS,this.state=F.State.IDLE,this.fragPrevious=e,void this.tick();C.logger.warn("missing video frame(s) on first frag, appending with gap",e.sn)}else e.backtracked=!1;var e=g.updateFragPTSDTS(f.details,e,b.startPTS,b.endPTS,b.startDTS,b.endDTS),l=this.hls;l.trigger(a["default"].LEVEL_PTS_UPDATED,{details:f.details,level:this.level,drift:e,type:b.type,start:b.startPTS,end:b.endPTS});[b.data1,b.data2].forEach(function(c){c&&c.length&&d.state===F.State.PARSING&&(d.appended=!0,d.pendingBuffering=!0,l.trigger(a["default"].BUFFER_APPENDING,{type:b.type,data:c,parent:"main",content:"data"}))});this.tick()}},n.prototype.onFragParsed=function(a){var b=this.fragCurrent,c=a.frag;b&&"main"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===F.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=F.State.PARSED,this._checkAppendedParsed())},n.prototype.onAudioTrackSwitching=function(b){var c=b.id;b.url||(this.mediaBuffer!==this.media&&(C.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,b=this.fragCurrent,b.loader&&(C.logger.log("switching to main audio track, cancel main fragment load"),b.loader.abort()),this.fragPrevious=this.fragCurrent=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=F.State.IDLE),b=this.hls,b.trigger(a["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:p.POSITIVE_INFINITY,type:"audio"}),b.trigger(a["default"].AUDIO_TRACK_SWITCHED,{id:c}),this.altAudio=!1)},n.prototype.onAudioTrackSwitched=function(a){if(a=!!this.hls.audioTracks[a.id].url){var b=this.videoBuffer;b&&this.mediaBuffer!==b&&(C.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=b)}this.altAudio=a;this.tick()},n.prototype.onBufferCreated=function(a){var b,c;a=a.tracks;var d=!1,e;for(e in a){var g=a[e];"main"===g.id?(b=g,"video"===(c=e)&&(this.videoBuffer=a[e].buffer)):d=!0}this.mediaBuffer=d&&b?(C.logger.log("alternate track found, use "+c+".buffered to schedule main fragment loading"),b.buffer):this.media},n.prototype.onBufferAppended=function(a){if("main"===a.parent){var b=this.state;b!==F.State.PARSING&&b!==F.State.PARSED||(this.pendingBuffering=0<a.pending,this._checkAppendedParsed())}},n.prototype._checkAppendedParsed=function(){if(!(this.state!==F.State.PARSED||this.appended&&this.pendingBuffering)){var b=this.fragCurrent;if(b){C.logger.log("main buffered : "+r["default"].toString((this.mediaBuffer?this.mediaBuffer:this.media).buffered));this.fragPrevious=b;var c=this.stats;c.tbuffered=window.performance.now();this.fragLastKbps=Math.round(8*c.total/(c.tbuffered-c.tfirst));this.hls.trigger(a["default"].FRAG_BUFFERED,{stats:c,frag:b,id:"main"});this.state=F.State.IDLE}this.tick()}},n.prototype.onError=function(a){var b=a.frag||this.fragCurrent;if(!b||"main"===b.type)switch(b=!!this.media&&f.BufferHelper.isBuffered(this.media,this.media.currentTime)&&f.BufferHelper.isBuffered(this.media,this.media.currentTime+.5),a.details){case E.ErrorDetails.FRAG_LOAD_ERROR:case E.ErrorDetails.FRAG_LOAD_TIMEOUT:case E.ErrorDetails.KEY_LOAD_ERROR:case E.ErrorDetails.KEY_LOAD_TIMEOUT:a.fatal||(this.fragLoadError+1<=this.config.fragLoadingMaxRetry?(a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout),C.logger.warn("mediaController: frag loading failed, retry in "+a+" ms"),this.retryDate=window.performance.now()+a,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=F.State.FRAG_LOADING_WAITING_RETRY):(C.logger.error("mediaController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=F.State.ERROR));break;case E.ErrorDetails.LEVEL_LOAD_ERROR:case E.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==F.State.ERROR&&(a.fatal?(this.state=F.State.ERROR,C.logger.warn("streamController: "+a.details+",switch to "+this.state+" state ...")):a.levelRetry||this.state!==F.State.WAITING_LEVEL||(this.state=F.State.IDLE));break;case E.ErrorDetails.BUFFER_FULL_ERROR:"main"!==a.parent||this.state!==F.State.PARSING&&this.state!==F.State.PARSED||(b?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=F.State.IDLE):(C.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,p.POSITIVE_INFINITY)))}},n.prototype._reduceMaxBufferLength=function(a){var b=this.config;return b.maxMaxBufferLength>=a&&(b.maxMaxBufferLength/=2,C.logger.warn("main:reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0)},n.prototype._checkBuffer=function(){var a=this.media;a&&0!==a.readyState&&(a=(this.mediaBuffer?this.mediaBuffer:a).buffered,!this.loadedmetadata&&a.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,a))},n.prototype.onFragLoadEmergencyAborted=function(){this.state=F.State.IDLE;this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tick()},n.prototype.onBufferFlushed=function(){var a=this.mediaBuffer?this.mediaBuffer:this.media;a&&this.fragmentTracker.detectEvictedFragments(c["default"].ElementaryStreamTypes.VIDEO,a.buffered);this.state=F.State.IDLE;this.fragPrevious=null},n.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},n.prototype.computeLivePosition=function(a,b){return a+Math.max(0,b.totalduration-(void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*b.targetduration))},n.prototype._seekToStartPos=function(){var a=this.media,b=a.currentTime,c=a.seeking?b:this.startPosition;b!==c&&(C.logger.log("target start position not buffered, seek to buffered.start(0) "+c+" from current time "+b+" "),a.currentTime=c)},n.prototype._getAudioCodec=function(a){a=this.config.defaultAudioCodec||a.audioCodec;return this.audioCodecSwap&&(C.logger.log("swapping playlist audio codec"),a&&(a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),a},Object.defineProperty(n.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(a){this._liveSyncPosition=a},enumerable:!0,configurable:!0}),n}(F["default"]);n["default"]=x}).call(this,q("./src/polyfills/number.js").Number)},"./src/controller/subtitle-stream-controller.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}x(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var h=q("./src/events.js"),l=q("./src/utils/logger.js"),f=q("./src/crypt/decrypter.js");p=q("./src/task-loop.js");var d=q("./src/utils/buffer-helper.js"),a=q("./src/controller/fragment-finders.js"),b=q("./src/controller/fragment-tracker.js"),c=window.performance;n.SubtitleStreamControllerState={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"};var e=n.SubtitleStreamControllerState;q=function(g){function r(a,b){var c=g.call(this,a,h["default"].MEDIA_ATTACHED,h["default"].MEDIA_DETACHING,h["default"].ERROR,h["default"].KEY_LOADED,h["default"].FRAG_LOADED,h["default"].SUBTITLE_TRACKS_UPDATED,h["default"].SUBTITLE_TRACK_SWITCH,h["default"].SUBTITLE_TRACK_LOADED,h["default"].SUBTITLE_FRAG_PROCESSED)||this;return c.fragmentTracker=b,c.config=a.config,c.state=e.STOPPED,c.tracks=[],c.tracksBuffered=[],c.currentTrackId=-1,c.decrypter=new f["default"](a,a.config),c}return m(r,g),r.prototype.onHandlerDestroyed=function(){this.fragmentTracker=null;this.state=e.STOPPED;g.prototype.onHandlerDestroyed.call(this)},r.prototype.onSubtitleFragProcessed=function(a){if(this.state=e.IDLE,a.success){var b=this.tracksBuffered[this.currentTrackId];a=a.frag;if(this.fragPrevious=a,b){for(var c,d=0;d<b.length;d++)if(a.start>=b[d].start&&a.start<=b[d].end){c=b[d];break}c?c.end=a.start+a.duration:b.push({start:a.start,end:a.start+a.duration})}}},r.prototype.onMediaAttached=function(a){this.media=a.media;this.state=e.IDLE},r.prototype.onMediaDetaching=function(){this.media=null;this.state=e.STOPPED},r.prototype.onError=function(a){(a=a.frag)&&"subtitle"===a.type&&(this.state=e.IDLE)},r.prototype.onSubtitleTracksUpdated=function(a){var b=this;l.logger.log("subtitle tracks updated");this.tracksBuffered=[];this.tracks=a.subtitleTracks;this.tracks.forEach(function(a){b.tracksBuffered[a.id]=[]})},r.prototype.onSubtitleTrackSwitch=function(a){(this.currentTrackId=a.id,this.tracks&&-1!==this.currentTrackId)?(a=this.tracks[this.currentTrackId])&&a.details&&this.setInterval(500):this.clearInterval()},r.prototype.onSubtitleTrackLoaded=function(a){var b=a.id;a=a.details;this.tracks?(this.tracks[b]&&(l.logger.log("Updating subtitle track details"),this.tracks[b].details=a),this.setInterval(500)):l.logger.warn("Can not update subtitle details, no tracks found")},r.prototype.onKeyLoaded=function(){this.state===e.KEY_LOADING&&(this.state=e.IDLE)},r.prototype.onFragLoaded=function(a){var b=this.fragCurrent,d=a.frag.decryptdata,g=a.frag,f=this.hls;if(this.state===e.FRAG_LOADING&&b&&"subtitle"===a.frag.type&&b.sn===a.frag.sn&&0<a.payload.byteLength&&d&&d.key&&"AES-128"===d.method){var l=c.now();this.decrypter.decrypt(a.payload,d.key.buffer,d.iv.buffer,function(a){var b=c.now();f.trigger(h["default"].FRAG_DECRYPTED,{frag:g,payload:a,stats:{tstart:l,tdecrypt:b}})})}},r.prototype.doTick=function(){if(this.media)switch(this.state){case e.IDLE:var c=this.tracks,g=this.currentTrackId;if(c&&c[g]&&c[g].details){var c=c[g].details,f=this.config,m=f.maxBufferHole,r=Math.min(f.maxBufferLength,f.maxMaxBufferLength),f=f.maxFragLookUpTolerance,m=d.BufferHelper.bufferedInfo(this._getBuffered(),this.media.currentTime,m),n=m.end,q=c.fragments,p=q.length,p=q[p-1].start+q[p-1].duration,x=void 0;m.len<r&&n<p?x=a.findFragmentByPTS(this.fragPrevious,q,n,f):c.hasProgramDateTime&&this.fragPrevious&&(x=a.findFragmentByPDT(q,this.fragPrevious.endProgramDateTime,f));x&&x.encrypted?(l.logger.log("Loading key for "+x.sn),this.state=e.KEY_LOADING,this.hls.trigger(h["default"].KEY_LOADING,{frag:x})):x&&this.fragmentTracker.getState(x)===b.FragmentState.NOT_LOADED&&(x.trackId=g,this.fragCurrent=x,this.state=e.FRAG_LOADING,this.hls.trigger(h["default"].FRAG_LOADING,{frag:x}))}}else this.state=e.IDLE},r.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},r}(p["default"]);n.SubtitleStreamController=q},"./src/controller/subtitle-track-controller.js":function(p,n,q){function x(a){for(var b=[],c=0;c<a.length;c++)"subtitles"===a[c].kind&&b.push(a[c]);return b}var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=q("./src/event-handler.js"),d=q("./src/utils/logger.js");p=function(a){function b(b){b=a.call(this,b,l["default"].MEDIA_ATTACHED,l["default"].MEDIA_DETACHING,l["default"].MANIFEST_LOADING,l["default"].MANIFEST_LOADED,l["default"].SUBTITLE_TRACK_LOADED)||this;return b.tracks=[],b.trackId=-1,b.media=null,b.subtitleDisplay=!0,b}return h(b,a),b.prototype._onTextTracksChanged=function(){if(this.media){for(var a=-1,b=x(this.media.textTracks),d=0;d<b.length;d++)if("hidden"===b[d].mode)a=d;else if("showing"===b[d].mode){a=d;break}this.subtitleTrack=a}},b.prototype.destroy=function(){f["default"].prototype.destroy.call(this)},b.prototype.onMediaAttached=function(a){var b=this;(this.media=a.media)&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){b.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},b.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},b.prototype.onManifestLoading=function(){this.tracks=[];this.trackId=-1},b.prototype.onManifestLoaded=function(a){var b=this;this.tracks=a=a.subtitles||[];this.trackId=-1;this.hls.trigger(l["default"].SUBTITLE_TRACKS_UPDATED,{subtitleTracks:a});a.forEach(function(a){a["default"]&&(b.media?b.subtitleTrack=a.id:b.queuedDefaultTrack=a.id)})},b.prototype.onTick=function(){var a=this.trackId,b=this.tracks[a];if(b){var g=b.details;g&&!g.live||(d.logger.log("(re)loading playlist for subtitle track "+a),this.hls.trigger(l["default"].SUBTITLE_TRACK_LOADING,{url:b.url,id:a}))}},b.prototype.onSubtitleTrackLoaded=function(a){var b=this;a.id<this.tracks.length&&(d.logger.log("subtitle track "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.timer&&(this.timer=setInterval(function(){b.onTick()},1E3*a.details.targetduration,this)),!a.details.live&&this.timer&&this._stopTimer())},Object.defineProperty(b.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(a){this.trackId!==a&&(this._toggleTrackModes(a),this.setSubtitleTrackInternal(a))},enumerable:!0,configurable:!0}),b.prototype.setSubtitleTrackInternal=function(a){var b=this.hls,c=this.tracks;if(!("number"!=typeof a||-1>a||a>=c.length)&&(this._stopTimer(),this.trackId=a,d.logger.log("switching to subtitle track "+a),b.trigger(l["default"].SUBTITLE_TRACK_SWITCH,{id:a}),-1!==a)){var c=c[a],f=c.details;f&&!f.live||(d.logger.log("(re)loading playlist for subtitle track "+a),b.trigger(l["default"].SUBTITLE_TRACK_LOADING,{url:c.url,id:a}))}},b.prototype._stopTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=null)},b.prototype._toggleTrackModes=function(a){var b=this.media,c=this.subtitleDisplay,d=this.trackId;b&&(b=x(b.textTracks),-1===a?[].slice.call(b).forEach(function(a){a.mode="disabled"}):(d=b[d])&&(d.mode="disabled"),(a=b[a])&&(a.mode=c?"showing":"hidden"))},b}(f["default"]);n["default"]=p},"./src/controller/timeline-controller.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=q("./src/event-handler.js"),d=q("./src/utils/cea-608-parser.js"),a=q("./src/utils/output-filter.js"),b=q("./src/utils/webvtt-parser.js"),c=q("./src/utils/logger.js"),e=q("./src/utils/texttrack-utils.js"),g=function(g){function m(b){var c=g.call(this,b,l["default"].MEDIA_ATTACHING,l["default"].MEDIA_DETACHING,l["default"].FRAG_PARSING_USERDATA,l["default"].FRAG_DECRYPTED,l["default"].MANIFEST_LOADING,l["default"].MANIFEST_LOADED,l["default"].FRAG_LOADED,l["default"].LEVEL_SWITCHING,l["default"].INIT_PTS_FOUND)||this;if(c.hls=b,c.config=b.config,c.enabled=!0,c.Cues=b.config.cueHandler,c.textTracks=[],c.tracks=[],c.unparsedVttFrags=[],c.initPTS=[],c.cueRanges=[],c.captionsTracks={},c.captionsProperties={textTrack1:{label:c.config.captionsTextTrack1Label,languageCode:c.config.captionsTextTrack1LanguageCode},textTrack2:{label:c.config.captionsTextTrack2Label,languageCode:c.config.captionsTextTrack2LanguageCode}},c.config.enableCEA708Captions){b=new a["default"](c,"textTrack1");var e=new a["default"](c,"textTrack2");c.cea608Parser=new d["default"](0,b,e)}return c}return h(m,g),m.prototype.addCues=function(a,b,c,d){for(var e,g,f,h,l=this.cueRanges,m=!1,r=l.length;r--;){var n=l[r],v=(e=n[0],g=n[1],f=b,h=c,Math.min(g,h)-Math.max(e,f));if(0<=v&&(n[0]=Math.min(n[0],b),n[1]=Math.max(n[1],c),m=!0,.5<v/(c-b)))return}m||l.push([b,c]);this.Cues.newCue(this.captionsTracks[a],b,c,d)},m.prototype.onInitPtsFound=function(a){var b=this;if("main"===a.id&&(this.initPTS[a.frag.cc]=a.initPTS),this.unparsedVttFrags.length)a=this.unparsedVttFrags,this.unparsedVttFrags=[],a.forEach(function(a){b.onFragLoaded(a)})},m.prototype.getExistingTrack=function(a){var b=this.media;if(b)for(var c=0;c<b.textTracks.length;c++){var d=b.textTracks[c];if(d[a])return d}return null},m.prototype.createCaptionsTrack=function(a){var b=this.captionsProperties[a],c=b.label,d=b.languageCode,b=this.captionsTracks;if(!b[a]){var g=this.getExistingTrack(a);g?(b[a]=g,e.clearCurrentCues(b[a]),e.sendAddTrackEvent(b[a],this.media)):(c=this.createTextTrack("captions",c,d))&&(c[a]=!0,b[a]=c)}},m.prototype.createTextTrack=function(a,b,c){var d=this.media;if(d)return d.addTextTrack(a,b,c)},m.prototype.destroy=function(){f["default"].prototype.destroy.call(this)},m.prototype.onMediaAttaching=function(a){this.media=a.media;this._cleanTracks()},m.prototype.onMediaDetaching=function(){var a=this.captionsTracks;Object.keys(a).forEach(function(b){e.clearCurrentCues(a[b]);delete a[b]})},m.prototype.onManifestLoading=function(){this.prevCC=this.lastSn=-1;this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,"new":!1}};this._cleanTracks()},m.prototype._cleanTracks=function(){var a=this.media;if(a&&(a=a.textTracks))for(var b=0;b<a.length;b++)e.clearCurrentCues(a[b])},m.prototype.onManifestLoaded=function(a){var b=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=a.subtitles||[];var c=this.media?this.media.textTracks:[];this.tracks.forEach(function(a,d){var e;if(d<c.length){var g=[].slice.call(c).find(function(b){return d=a,(c=b)&&c.label===d.name&&!(c.textTrack1||c.textTrack2);var c,d});g&&(e=g)}e||(e=b.createTextTrack("subtitles",a.name,a.lang));a["default"]?e.mode=b.hls.subtitleDisplay?"showing":"hidden":e.mode="disabled";b.textTracks.push(e)})}},m.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},m.prototype.onFragLoaded=function(a){var b=a.frag,c=a.payload;if("main"===b.type)b=b.sn,b!==this.lastSn+1&&(c=this.cea608Parser)&&c.reset(),this.lastSn=b;else if("subtitle"===b.type)if(c.byteLength){if(!p.isFinite(this.initPTS[b.cc]))return this.unparsedVttFrags.push(a),void(this.initPTS.length&&this.hls.trigger(l["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b}));a=b.decryptdata;null!=a&&null!=a.key&&"AES-128"===a.method||this._parseVTTs(b,c)}else this.hls.trigger(l["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b})},m.prototype._parseVTTs=function(a,d){var e=this.vttCCs;e[a.cc]||(e[a.cc]={start:a.start,prevCC:this.prevCC,"new":!0},this.prevCC=a.cc);var g=this.textTracks,f=this.hls;b["default"].parse(d,this.initPTS[a.cc],e,a.cc,function(b){var c=g[a.trackId];"disabled"!==c.mode?(b.forEach(function(a){if(!c.cues.getCueById(a.id))try{c.addCue(a)}catch(ba){var b=new window.TextTrackCue(a.startTime,a.endTime,a.text);b.id=a.id;c.addCue(b)}}),f.trigger(l["default"].SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})):f.trigger(l["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a})},function(b){c.logger.log("Failed to parse VTT cue: "+b);f.trigger(l["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a})})},m.prototype.onFragDecrypted=function(a){var b=a.payload,c=a.frag;if("subtitle"===c.type){if(!p.isFinite(this.initPTS[c.cc]))return void this.unparsedVttFrags.push(a);this._parseVTTs(c,b)}},m.prototype.onFragParsingUserdata=function(a){if(this.enabled&&this.config.enableCEA708Captions)for(var b=0;b<a.samples.length;b++){var c=this.extractCea608Data(a.samples[b].bytes);this.cea608Parser.addData(a.samples[b].pts,c)}},m.prototype.extractCea608Data=function(a){for(var b,c,d,e=31&a[0],g=2,f=[],h=0;h<e;h++)b=a[g++],c=127&a[g++],d=127&a[g++],0===c&&0===d||0!=(4&b)&&0===(3&b)&&(f.push(c),f.push(d));return f},m}(f["default"]);n["default"]=g}).call(this,q("./src/polyfills/number.js").Number)},"./src/crypt/aes-crypto.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(m,h){this.subtle=m;this.aesIV=h}return n.prototype.decrypt=function(m,h){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},h,m)},n}();n["default"]=p},"./src/crypt/aes-decryptor.js":function(p,n,q){function x(m){var h=m.byteLength,l=h&&(new DataView(m)).getUint8(h-1);return l?m.slice(0,h-l):m}Object.defineProperty(n,"__esModule",{value:!0});n.removePadding=x;p=function(){function m(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}return m.prototype.uint8ArrayToUint32Array_=function(h){h=new DataView(h);for(var l=new Uint32Array(4),f=0;4>f;f++)l[f]=h.getUint32(4*f);return l},m.prototype.initTable=function(){var h=this.sBox,l=this.invSBox,f=this.subMix,d=f[0],a=f[1],b=f[2],f=f[3],c=this.invSubMix,e=c[0],g=c[1],m=c[2],c=c[3],n=new Uint32Array(256),q=0,v=0,D;for(D=0;256>D;D++)n[D]=128>D?D<<1:D<<1^283;for(D=0;256>D;D++){var B=v^v<<1^v<<2^v<<3^v<<4,B=B>>>8^255&B^99,p=n[l[h[q]=B]=q],x=n[p],t=n[x],u=257*n[B]^16843008*B;d[q]=u<<24|u>>>8;a[q]=u<<16|u>>>16;b[q]=u<<8|u>>>24;f[q]=u;u=16843009*t^65537*x^257*p^16843008*q;e[B]=u<<24|u>>>8;g[B]=u<<16|u>>>16;m[B]=u<<8|u>>>24;c[B]=u;q?(q=p^n[n[n[t^p]]],v^=n[n[v]]):q=v=1}},m.prototype.expandKey=function(h){h=this.uint8ArrayToUint32Array_(h);for(var l=!0,f=0;f<h.length&&l;)l=h[f]===this.key[f],f++;if(!l){this.key=h;var d=this.keySize=h.length;if(4!==d&&6!==d&&8!==d)throw Error("Invalid aes key size\x3d"+d);var a,b,c,l=this.ksRows=4*(d+6+1),f=this.keySchedule=new Uint32Array(l),e=this.invKeySchedule=new Uint32Array(l),g=this.sBox,m=this.rcon;a=this.invSubMix;var n=a[0],q=a[1],v=a[2],D=a[3];for(a=0;a<l;a++)a<d?b=f[a]=h[a]:(c=b,0==a%d?(c=g[(c=c<<8|c>>>24)>>>24]<<24|g[c>>>16&255]<<16|g[c>>>8&255]<<8|g[255&c],c^=m[a/d|0]<<24):6<d&&4==a%d&&(c=g[c>>>24]<<24|g[c>>>16&255]<<16|g[c>>>8&255]<<8|g[255&c]),f[a]=b=(f[a-d]^c)>>>0);for(b=0;b<l;b++)a=l-b,c=3&b?f[a]:f[a-4],e[b]=4>b||4>=a?c:n[g[c>>>24]]^q[g[c>>>16&255]]^v[g[c>>>8&255]]^D[g[255&c]],e[b]>>>=0}},m.prototype.networkToHostOrderSwap=function(h){return h<<24|(65280&h)<<8|(16711680&h)>>8|h>>>24},m.prototype.decrypt=function(h,l,f,d){var a,b,c,e,g,m,n,q,v,D,B,p,t=this.keySize+6,u=this.invKeySchedule,A=this.invSBox,y=this.invSubMix,ba=y[0],T=y[1],W=y[2],y=y[3],J=this.uint8ArrayToUint32Array_(f);f=J[0];for(var V=J[1],ca=J[2],J=J[3],X=new Int32Array(h),da=new Int32Array(X.length),U=this.networkToHostOrderSwap;l<X.length;){n=U(X[l]);q=U(X[l+1]);v=U(X[l+2]);D=U(X[l+3]);e=n^u[0];g=D^u[1];m=v^u[2];c=q^u[3];B=4;for(p=1;p<t;p++)h=ba[e>>>24]^T[g>>16&255]^W[m>>8&255]^y[255&c]^u[B],a=ba[g>>>24]^T[m>>16&255]^W[c>>8&255]^y[255&e]^u[B+1],b=ba[m>>>24]^T[c>>16&255]^W[e>>8&255]^y[255&g]^u[B+2],c=ba[c>>>24]^T[e>>16&255]^W[g>>8&255]^y[255&m]^u[B+3],e=h,g=a,m=b,B+=4;h=A[e>>>24]<<24^A[g>>16&255]<<16^A[m>>8&255]<<8^A[255&c]^u[B];a=A[g>>>24]<<24^A[m>>16&255]<<16^A[c>>8&255]<<8^A[255&e]^u[B+1];b=A[m>>>24]<<24^A[c>>16&255]<<16^A[e>>8&255]<<8^A[255&g]^u[B+2];c=A[c>>>24]<<24^A[e>>16&255]<<16^A[g>>8&255]<<8^A[255&m]^u[B+3];da[l]=U(h^f);da[l+1]=U(c^V);da[l+2]=U(b^ca);da[l+3]=U(a^J);f=n;V=q;ca=v;J=D;l+=4}return d?x(da.buffer):da.buffer},m.prototype.destroy=function(){this.rcon=this.invKeySchedule=this.keySchedule=this.invSubMix=this.subMix=this.invSBox=this.sBox=this.ksRows=this.keySize=this.key=void 0},m}();n["default"]=p},"./src/crypt/decrypter.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/crypt/aes-crypto.js"),m=q("./src/crypt/fast-aes-key.js"),h=q("./src/crypt/aes-decryptor.js"),l=q("./src/errors.js"),f=q("./src/utils/logger.js"),d=q("./src/events.js"),a=q("./src/utils/get-self-scope.js").getSelfScope();p=function(){function b(b,d,g){g=(void 0===g?{}:g).removePKCS7Padding;if(this.logEnabled=!0,this.observer=b,this.config=d,this.removePKCS7Padding=void 0===g||g)try{var c=a.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch(E){}this.disableWebCrypto=!this.subtle}return b.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},b.prototype.decrypt=function(a,b,d,l){var c=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(f.logger.log("JS AES decrypt"),this.logEnabled=!1);var e=this.decryptor;e||(this.decryptor=e=new h["default"]);e.expandKey(b);l(e.decrypt(a,0,d,this.removePKCS7Padding))}else{this.logEnabled&&(f.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var g=this.subtle;this.key!==b&&(this.key=b,this.fastAesKey=new m["default"](g,b));this.fastAesKey.expandKey().then(function(e){(new x["default"](g,d)).decrypt(a,e)["catch"](function(e){c.onWebCryptoError(e,a,b,d,l)}).then(function(a){l(a)})})["catch"](function(e){c.onWebCryptoError(e,a,b,d,l)})}},b.prototype.onWebCryptoError=function(a,b,g,h,m){this.config.enableSoftwareAES?(f.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(b,g,h,m)):(f.logger.error("decrypting error : "+a.message),this.observer.trigger(d["default"].ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:a.message}))},b.prototype.destroy=function(){var a=this.decryptor;a&&(a.destroy(),this.decryptor=void 0)},b}();n["default"]=p},"./src/crypt/fast-aes-key.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(m,h){this.subtle=m;this.key=h}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}();n["default"]=p},"./src/demux/aacdemuxer.js":function(p,n,q){(function(p){Object.defineProperty(n,"__esModule",{value:!0});var m=q("./src/demux/adts.js"),h=q("./src/utils/logger.js"),l=q("./src/demux/id3.js"),f=function(){function d(a,b,c){this.observer=a;this.config=c;this.remuxer=b}return d.prototype.resetInitSegment=function(a,b,c,d){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:b,duration:d,inputTimeScale:9E4}},d.prototype.resetTimeStamp=function(){},d.probe=function(a){if(!a)return!1;for(var b=(l["default"].getID3Data(a,0)||[]).length,c=a.length;b<c;b++)if(m.probe(a,b))return h.logger.log("ADTS sync word found !"),!0;return!1},d.prototype.append=function(a,b,c,d){for(var e=this._audioTrack,f=l["default"].getID3Data(a,0)||[],n=l["default"].getTimeStamp(f),n=p.isFinite(n)?90*n:9E4*b,q=0,v=n,D=a.length,B=f.length,F=[{pts:v,dts:v,data:f}];B<D-1;)if(m.isHeader(a,B)&&B+5<D){m.initTrackConfig(e,this.observer,a,B,e.manifestCodec);v=m.appendFrame(e,a,B,n,q);if(!v){h.logger.log("Unable to parse AAC frame");break}B+=v.length;v=v.sample.pts;q++}else l["default"].isHeader(a,B)?(f=l["default"].getID3Data(a,B),F.push({pts:v,dts:v,data:f}),B+=f.length):B++;this.remuxer.remux(e,{samples:[]},{samples:F,inputTimeScale:9E4},{samples:[]},b,c,d)},d.prototype.destroy=function(){},d}();n["default"]=f}).call(this,q("./src/polyfills/number.js").Number)},"./src/demux/adts.js":function(p,n,q){function x(c,e,g,f){var h,l,m,r,n,q=navigator.userAgent.toLowerCase(),p=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350];if(h=1+((192&e[g+2])>>>6),l=(60&e[g+2])>>>2,!(p.length-1<l))return r=(1&e[g+2])<<2,r|=(192&e[g+3])>>>6,d.logger.log("manifest codec:"+f+",ADTS data:type:"+h+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+r),m=/firefox/i.test(q)?6<=l?(h=5,n=Array(4),l-3):(h=2,n=Array(2),l):-1!==q.indexOf("android")?(h=2,n=Array(2),l):(h=5,n=Array(4),f&&(-1!==f.indexOf("mp4a.40.29")||-1!==f.indexOf("mp4a.40.5"))||!f&&6<=l?l-3:((f&&-1!==f.indexOf("mp4a.40.2")&&(6<=l&&1===r||/vivaldi/i.test(q))||!f&&1===r)&&(h=2,n=Array(2)),l)),n[0]=h<<3,n[0]|=(14&l)>>1,n[1]|=(1&l)<<7,n[1]|=r<<3,5===h&&(n[1]|=(14&m)>>1,n[2]=(1&m)<<7,n[2]|=8,n[3]=0),{config:n,samplerate:p[l],channelCount:r,codec:"mp4a.40."+h,manifestCodec:f};c.trigger(b["default"].ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}function m(a,b){return 255===a[b]&&240==(246&a[b+1])}function h(a,b){return 1&a[b+1]?7:9}function l(a,b){return(3&a[b+3])<<11|a[b+4]<<3|(224&a[b+5])>>>5}function f(a,b,d,f,m){var c,e,g=a.length;if(c=h(a,b),e=l(a,b),0<(e-=c)&&b+c+e<=g)return{headerLength:c,frameLength:e,stamp:d+f*m}}Object.defineProperty(n,"__esModule",{value:!0});var d=q("./src/utils/logger.js"),a=q("./src/errors.js"),b=q("./src/events.js");n.getAudioConfig=x;n.isHeaderPattern=m;n.getHeaderLength=h;n.getFullFrameLength=l;n.isHeader=function(a,b){return!!(b+1<a.length&&m(a,b))};n.probe=function(a,b){if(b+1<a.length&&m(a,b)){var c=h(a,b);b+5<a.length&&(c=l(a,b));c=b+c;if(c===a.length||c+1<a.length&&m(a,c))return!0}return!1};n.initTrackConfig=function(a,b,g,f,h){a.samplerate||(b=x(b,g,f,h),a.config=b.config,a.samplerate=b.samplerate,a.channelCount=b.channelCount,a.codec=b.codec,a.manifestCodec=b.manifestCodec,d.logger.log("parsed codec:"+a.codec+",rate:"+b.samplerate+",nb channel:"+b.channelCount))};n.getFrameDuration=function(a){return 9216E4/a};n.parseFrameHeader=f;n.appendFrame=function(a,b,d,h,l){var c=f(b,d,h,l,9216E4/a.samplerate);if(c)return l=c.stamp,h=c.headerLength,c=c.frameLength,b={unit:b.subarray(d+h,d+h+c),pts:l,dts:l},a.samples.push(b),a.len+=c,{sample:b,length:c+h}}},"./src/demux/demuxer-inline.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x,m=q("./src/events.js"),h=q("./src/errors.js"),l=q("./src/crypt/decrypter.js"),f=q("./src/demux/aacdemuxer.js"),d=q("./src/demux/mp4demuxer.js"),a=q("./src/demux/tsdemuxer.js"),b=q("./src/demux/mp3demuxer.js"),c=q("./src/remux/mp4-remuxer.js"),e=q("./src/remux/passthrough-remuxer.js");p=q("./src/utils/get-self-scope.js");q=q("./src/utils/logger.js");p=p.getSelfScope();try{x=p.performance.now.bind(p.performance)}catch(g){q.logger.debug("Unable to use Performance API on this environment"),x=p.Date.now}q=function(){function g(a,b,c,d){this.observer=a;this.typeSupported=b;this.config=c;this.vendor=d}return g.prototype.destroy=function(){var a=this.demuxer;a&&a.destroy()},g.prototype.push=function(a,b,c,d,e,g,f,h,n,q,p,t){var r=this;if(0<a.byteLength&&null!=b&&null!=b.key&&"AES-128"===b.method){var v=this.decrypter;null==v&&(v=this.decrypter=new l["default"](this.observer,this.config));var B=x();v.decrypt(a,b.key.buffer,b.iv.buffer,function(a){var l=x();r.observer.trigger(m["default"].FRAG_DECRYPTED,{stats:{tstart:B,tdecrypt:l}});r.pushDecrypted(new Uint8Array(a),b,new Uint8Array(c),d,e,g,f,h,n,q,p,t)})}else this.pushDecrypted(new Uint8Array(a),b,new Uint8Array(c),d,e,g,f,h,n,q,p,t)},g.prototype.pushDecrypted=function(g,l,n,v,q,B,p,x,t,u,A,y){var r=this.demuxer;if(!r||(p||x)&&!this.probe(g)){for(var D=this.observer,F=this.typeSupported,C=this.config,E=[{demux:a["default"],remux:c["default"]},{demux:d["default"],remux:e["default"]},{demux:f["default"],remux:c["default"]},{demux:b["default"],remux:c["default"]}],H=0,S=E.length;H<S;H++){var Q=E[H],aa=Q.demux.probe;if(aa(g)){r=this.remuxer=new Q.remux(D,C,F,this.vendor);r=new Q.demux(D,r,C,F);this.probe=aa;break}}if(!r)return void D.trigger(m["default"].ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=r}D=this.remuxer;(p||x)&&(r.resetInitSegment(n,v,q,u),D.resetInitSegment());p&&(r.resetTimeStamp(y),D.resetTimeStamp(y));"function"==typeof r.setDecryptData&&r.setDecryptData(l);r.append(g,B,t,A)},g}();n["default"]=q},"./src/demux/demuxer-worker.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/demux/demuxer-inline.js"),m=q("./src/events.js"),h=q("./src/utils/logger.js"),l=q("./node_modules/node-libs-browser/node_modules/events/events.js");n["default"]=function(f){var d=new l.EventEmitter;d.trigger=function(a){for(var b=[],e=1;e<arguments.length;e++)b[e-1]=arguments[e];d.emit.apply(d,[a,a].concat(b))};d.off=function(a){for(var b=[],e=1;e<arguments.length;e++)b[e-1]=arguments[e];d.removeListener.apply(d,[a].concat(b))};var a=function(a,c){f.postMessage({event:a,data:c})};f.addEventListener("message",function(b){b=b.data;switch(b.cmd){case "init":var c=JSON.parse(b.config);f.demuxer=new x["default"](d,b.typeSupported,c,b.vendor);h.enableLogs(c.debug);a("init",null);break;case "demux":f.demuxer.push(b.data,b.decryptdata,b.initSegment,b.audioCodec,b.videoCodec,b.timeOffset,b.discontinuity,b.trackSwitch,b.contiguous,b.duration,b.accurateTimeOffset,b.defaultInitPTS)}});d.on(m["default"].FRAG_DECRYPTED,a);d.on(m["default"].FRAG_PARSING_INIT_SEGMENT,a);d.on(m["default"].FRAG_PARSED,a);d.on(m["default"].ERROR,a);d.on(m["default"].FRAG_PARSING_METADATA,a);d.on(m["default"].FRAG_PARSING_USERDATA,a);d.on(m["default"].INIT_PTS_FOUND,a);d.on(m["default"].FRAG_PARSING_DATA,function(a,c){var b=[],d={event:a,data:c};c.data1&&(d.data1=c.data1.buffer,b.push(c.data1.buffer),delete c.data1);c.data2&&(d.data2=c.data2.buffer,b.push(c.data2.buffer),delete c.data2);f.postMessage(d,b)})}},"./src/demux/demuxer.js":function(p,n,q){(function(p){Object.defineProperty(n,"__esModule",{value:!0});var m=q("./node_modules/webworkify-webpack/index.js"),h=q("./src/events.js"),l=q("./src/demux/demuxer-inline.js"),f=q("./src/utils/logger.js"),d=q("./src/errors.js"),a=q("./src/utils/mediasource-helper.js"),b=q("./src/utils/get-self-scope.js"),c=q("./src/observer.js"),e=b.getSelfScope(),g=a.getMediaSource(),a=function(){function a(a,b){var r=this;this.hls=a;this.id=b;var n=this.observer=new c.Observer,B=a.config,p=function(b,c){(c=c||{}).frag=r.frag;c.id=r.id;a.trigger(b,c)};n.on(h["default"].FRAG_DECRYPTED,p);n.on(h["default"].FRAG_PARSING_INIT_SEGMENT,p);n.on(h["default"].FRAG_PARSING_DATA,p);n.on(h["default"].FRAG_PARSED,p);n.on(h["default"].ERROR,p);n.on(h["default"].FRAG_PARSING_METADATA,p);n.on(h["default"].FRAG_PARSING_USERDATA,p);n.on(h["default"].INIT_PTS_FOUND,p);var p={mp4:g.isTypeSupported("video/mp4"),mpeg:g.isTypeSupported("audio/mpeg"),mp3:g.isTypeSupported('audio/mp4; codecs\x3d"mp3"')},q=navigator.vendor;if(B.enableWorker&&"undefined"!=typeof Worker){f.logger.log("demuxing in webworker");var x=void 0;try{x=this.w=m("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),x.addEventListener("message",this.onwmsg),x.onerror=function(b){a.trigger(h["default"].ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:b.message+" ("+b.filename+":"+b.lineno+")"}})},x.postMessage({cmd:"init",typeSupported:p,vendor:q,id:b,config:JSON.stringify(B)})}catch(Q){f.logger.warn("Error in worker:",Q),f.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),x&&e.URL.revokeObjectURL(x.objectURL),this.demuxer=new l["default"](n,p,B,q),this.w=void 0}}else this.demuxer=new l["default"](n,p,B,q)}return a.prototype.destroy=function(){var a=this.w;a?(a.removeEventListener("message",this.onwmsg),a.terminate(),this.w=null):(a=this.demuxer)&&(a.destroy(),this.demuxer=null);(a=this.observer)&&(a.removeAllListeners(),this.observer=null)},a.prototype.push=function(a,b,c,d,e,g,h,l){var m=this.w,r=p.isFinite(e.startPTS)?e.startPTS:e.start,n=e.decryptdata,v=this.frag,q=!(v&&e.cc===v.cc),B=!(v&&e.level===v.level),v=v&&e.sn===v.sn+1,v=!B&&v;(q&&f.logger.log(this.id+":discontinuity detected"),B&&f.logger.log(this.id+":switch detected"),this.frag=e,m)?m.postMessage({cmd:"demux",data:a,decryptdata:n,initSegment:b,audioCodec:c,videoCodec:d,timeOffset:r,discontinuity:q,trackSwitch:B,contiguous:v,duration:g,accurateTimeOffset:h,defaultInitPTS:l},a instanceof ArrayBuffer?[a]:[]):(e=this.demuxer)&&e.push(a,n,b,c,d,r,q,B,v,g,h,l)},a.prototype.onWorkerMessage=function(a){a=a.data;var b=this.hls;switch(a.event){case "init":e.URL.revokeObjectURL(this.w.objectURL);break;case h["default"].FRAG_PARSING_DATA:a.data.data1=new Uint8Array(a.data1),a.data2&&(a.data.data2=new Uint8Array(a.data2));default:a.data=a.data||{},a.data.frag=this.frag,a.data.id=this.id,b.trigger(a.event,a.data)}},a}();n["default"]=a}).call(this,q("./src/polyfills/number.js").Number)},"./src/demux/exp-golomb.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/utils/logger.js");p=function(){function m(h){this.data=h;this.bytesAvailable=h.byteLength;this.bitsAvailable=this.word=0}return m.prototype.loadWord=function(){var h=this.data,l=this.bytesAvailable,f=h.byteLength-l,d=new Uint8Array(4),l=Math.min(4,l);if(0===l)throw Error("no bytes available");d.set(h.subarray(f,f+l));this.word=(new DataView(d.buffer)).getUint32(0);this.bitsAvailable=8*l;this.bytesAvailable-=l},m.prototype.skipBits=function(h){var l;this.bitsAvailable>h||(h-=this.bitsAvailable,h-=(l=h>>3)>>3,this.bytesAvailable-=l,this.loadWord());this.word<<=h;this.bitsAvailable-=h},m.prototype.readBits=function(h){var l=Math.min(this.bitsAvailable,h),f=this.word>>>32-l;return 32<h&&x.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=l,0<this.bitsAvailable?this.word<<=l:0<this.bytesAvailable&&this.loadWord(),0<(l=h-l)&&this.bitsAvailable?f<<l|this.readBits(l):f},m.prototype.skipLZ=function(){var h;for(h=0;h<this.bitsAvailable;++h)if(0!=(this.word&2147483648>>>h))return this.word<<=h,this.bitsAvailable-=h,h;return this.loadWord(),h+this.skipLZ()},m.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},m.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},m.prototype.readUEG=function(){var h=this.skipLZ();return this.readBits(h+1)-1},m.prototype.readEG=function(){var h=this.readUEG();return 1&h?1+h>>>1:-1*(h>>>1)},m.prototype.readBoolean=function(){return 1===this.readBits(1)},m.prototype.readUByte=function(){return this.readBits(8)},m.prototype.readUShort=function(){return this.readBits(16)},m.prototype.readUInt=function(){return this.readBits(32)},m.prototype.skipScalingList=function(h){var l,f=8,d=8;for(l=0;l<h;l++)0!==d&&(d=(f+this.readEG()+256)%256),f=0===d?f:d},m.prototype.readSPS=function(){var h,l,f,d,a,b,c=0,e=0,g=0,m=0,n=this.readUByte.bind(this);a=this.readBits.bind(this);var p=this.readUEG.bind(this),v=this.readBoolean.bind(this),q=this.skipBits.bind(this);f=this.skipEG.bind(this);d=this.skipUEG.bind(this);l=this.skipScalingList.bind(this);if(n(),h=n(),a(5),q(3),n(),d(),100===h||110===h||122===h||244===h||44===h||83===h||86===h||118===h||128===h)if(h=p(),3===h&&q(1),d(),d(),q(1),v())for(b=3!==h?8:12,h=0;h<b;h++)v()&&l(6>h?16:64);d();l=p();if(0===l)p();else if(1===l)for(q(1),f(),f(),l=p(),h=0;h<l;h++)f();d();q(1);f=p();d=p();0===(a=a(1))&&q(1);q(1);v()&&(c=p(),e=p(),g=p(),m=p());p=[1,1];if(v()&&v())switch(n()){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[n()<<8|n(),n()<<8|n()]}return{width:Math.ceil(16*(f+1)-2*c-2*e),height:(2-a)*(d+1)*16-(a?2:4)*(g+m),pixelRatio:p}},m.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},m}();n["default"]=p},"./src/demux/id3.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(){}return n.isHeader=function(m,h){return h+10<=m.length&&73===m[h]&&68===m[h+1]&&51===m[h+2]&&255>m[h+3]&&255>m[h+4]&&128>m[h+6]&&128>m[h+7]&&128>m[h+8]&&128>m[h+9]},n.isFooter=function(m,h){return h+10<=m.length&&51===m[h]&&68===m[h+1]&&73===m[h+2]&&255>m[h+3]&&255>m[h+4]&&128>m[h+6]&&128>m[h+7]&&128>m[h+8]&&128>m[h+9]},n.getID3Data=function(m,h){for(var l=h,f=0;n.isHeader(m,h);)f+=10,f+=n._readSize(m,h+6),n.isFooter(m,h+10)&&(f+=10),h+=f;if(0<f)return m.subarray(l,l+f)},n._readSize=function(m,h){var l=0;return l=(127&m[h])<<21,l|=(127&m[h+1])<<14,l|=(127&m[h+2])<<7,l|127&m[h+3]},n.getTimeStamp=function(m){m=n.getID3Frames(m);for(var h=0;h<m.length;h++){var l=m[h];if(n.isTimeStampFrame(l))return n._readTimeStamp(l)}},n.isTimeStampFrame=function(m){return m&&"PRIV"===m.key&&"com.apple.streaming.transportStreamTimestamp"===m.info},n._getFrameData=function(m){var h=String.fromCharCode(m[0],m[1],m[2],m[3]),l=n._readSize(m,4);return{type:h,size:l,data:m.subarray(10,10+l)}},n.getID3Frames=function(m){for(var h=0,l=[];n.isHeader(m,h);){for(var f=n._readSize(m,h+6),f=(h+=10)+f;h+8<f;){var d=n._getFrameData(m.subarray(h)),a=n._decodeFrame(d);a&&l.push(a);h+=d.size+10}n.isFooter(m,h)&&(h+=10)}return l},n._decodeFrame=function(m){return"PRIV"===m.type?n._decodePrivFrame(m):"T"===m.type[0]?n._decodeTextFrame(m):"W"===m.type[0]?n._decodeURLFrame(m):void 0},n._readTimeStamp=function(m){if(8===m.data.byteLength){var h=new Uint8Array(m.data);m=1&h[3];h=(h[4]<<23)+(h[5]<<15)+(h[6]<<7)+h[7];return h/=45,m&&(h+=4.772185884E7),Math.round(h)}},n._decodePrivFrame=function(m){if(!(2>m.size)){var h=n._utf8ArrayToStr(m.data,!0),l=new Uint8Array(m.data.subarray(h.length+1));return{key:m.type,info:h,data:l.buffer}}},n._decodeTextFrame=function(m){if(!(2>m.size)){if("TXXX"===m.type){var h=1,l=n._utf8ArrayToStr(m.data.subarray(h)),h=h+(l.length+1),h=n._utf8ArrayToStr(m.data.subarray(h));return{key:m.type,info:l,data:h}}l=n._utf8ArrayToStr(m.data.subarray(1));return{key:m.type,data:l}}},n._decodeURLFrame=function(m){if("WXXX"===m.type){if(2>m.size)return;var h=1,l=n._utf8ArrayToStr(m.data.subarray(h)),h=h+(l.length+1),h=n._utf8ArrayToStr(m.data.subarray(h));return{key:m.type,info:l,data:h}}l=n._utf8ArrayToStr(m.data);return{key:m.type,data:l}},n._utf8ArrayToStr=function(m,h){void 0===h&&(h=!1);for(var l,f,d,a=m.length,b="",c=0;c<a&&(0!==(l=m[c++])||!h);)if(0!==l&&3!==l)switch(l>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(l);break;case 12:case 13:f=m[c++];b+=String.fromCharCode((31&l)<<6|63&f);break;case 14:f=m[c++],d=m[c++],b+=String.fromCharCode((15&l)<<12|(63&f)<<6|(63&d)<<0)}return b},n}();n.utf8ArrayToStr=p._utf8ArrayToStr;n["default"]=p},"./src/demux/mp3demuxer.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/demux/id3.js"),m=q("./src/utils/logger.js"),h=q("./src/demux/mpegaudio.js");p=function(){function l(f,d,a){this.observer=f;this.config=a;this.remuxer=d}return l.prototype.resetInitSegment=function(f,d,a,b){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:d,duration:b,inputTimeScale:9E4}},l.prototype.resetTimeStamp=function(){},l.probe=function(f){var d,a;if((d=x["default"].getID3Data(f,0))&&void 0!==x["default"].getTimeStamp(d))for(d=d.length,a=Math.min(f.length-1,d+100);d<a;d++)if(h["default"].probe(f,d))return m.logger.log("MPEG Audio sync word found !"),!0;return!1},l.prototype.append=function(f,d,a,b){for(var c=x["default"].getID3Data(f,0),e=x["default"].getTimeStamp(c),e=e?90*e:9E4*d,g=c.length,l=f.length,m=0,n=0,p=this._audioTrack,q=[{pts:e,dts:e,data:c}];g<l;)if(h["default"].isHeader(f,g)){n=h["default"].appendFrame(p,f,g,e,m);if(!n)break;g+=n.length;n=n.sample.pts;m++}else x["default"].isHeader(f,g)?(c=x["default"].getID3Data(f,g),q.push({pts:n,dts:n,data:c}),g+=c.length):g++;this.remuxer.remux(p,{samples:[]},{samples:q,inputTimeScale:9E4},{samples:[]},d,a,b)},l.prototype.destroy=function(){},l}();n["default"]=p},"./src/demux/mp4demuxer.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/utils/logger.js"),m=q("./src/events.js"),h=Math.pow(2,32)-1;p=function(){function l(f,d){this.observer=f;this.remuxer=d}return l.prototype.resetTimeStamp=function(f){this.initPTS=f},l.prototype.resetInitSegment=function(f,d,a,b){if(f&&f.byteLength){var c=this.initData=l.parseInitSegment(f);null==d&&(d="mp4a.40.5");null==a&&(a="avc1.42e01e");var e={};c.audio&&c.video?e.audiovideo={container:"video/mp4",codec:d+","+a,initSegment:b?f:null}:(c.audio&&(e.audio={container:"audio/mp4",codec:d,initSegment:b?f:null}),c.video&&(e.video={container:"video/mp4",codec:a,initSegment:b?f:null}));this.observer.trigger(m["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:e})}else d&&(this.audioCodec=d),a&&(this.videoCodec=a)},l.probe=function(f){return 0<l.findBox({data:f,start:0,end:Math.min(f.length,16384)},["moof"]).length},l.bin2str=function(f){return String.fromCharCode.apply(null,f)},l.readUint16=function(f,d){f.data&&(d+=f.start,f=f.data);var a=f[d]<<8|f[d+1];return 0>a?65536+a:a},l.readUint32=function(f,d){f.data&&(d+=f.start,f=f.data);var a=f[d]<<24|f[d+1]<<16|f[d+2]<<8|f[d+3];return 0>a?4294967296+a:a},l.writeUint32=function(f,d,a){f.data&&(d+=f.start,f=f.data);f[d]=a>>24;f[d+1]=a>>16&255;f[d+2]=a>>8&255;f[d+3]=255&a},l.findBox=function(f,d){var a,b,c,e,g,h=[];if(f.data?(a=f.start,c=f.end,f=f.data):(a=0,c=f.byteLength),!d.length)return null;for(;a<c;)g=1<(b=l.readUint32(f,a))?a+b:c,l.bin2str(f.subarray(a+4,a+8))===d[0]&&(1===d.length?h.push({data:f,start:a+8,end:g}):(e=l.findBox({data:f,start:a+8,end:g},d.slice(1))).length&&(h=h.concat(e))),a=g;return h},l.parseSegmentIndex=function(f){var d=l.findBox(f,["moov"])[0],d=d?d.end:null,a,b=l.findBox(f,["sidx"]);if(!b||!b[0])return null;f=[];var c=(b=b[0]).data[0],e=l.readUint32(b,a=0===c?8:16);a=a+4+(0===c?8:16)+2;var g=b.end+0,h=l.readUint16(b,a);a+=2;for(var m=0;m<h;m++){var n=l.readUint32(b,a),p=2147483647&n;if(1===(2147483648&n)>>>31)return;n=l.readUint32(b,a+=4);a+=4;f.push({referenceSize:p,subsegmentDuration:n,info:{duration:n/e,start:g,end:g+p-1}});g+=p;a+=4}return{earliestPresentationTime:0,timescale:e,version:c,referencesCount:h,references:f,moovEndOffset:d}},l.parseInitSegment=function(f){var d=[];return l.findBox(f,["moov","trak"]).forEach(function(a){var b=l.findBox(a,["tkhd"])[0];if(b){var c=b.data[b.start],b=l.readUint32(b,0===c?12:20),e=l.findBox(a,["mdia","mdhd"])[0];e&&(c=e.data[e.start],c=l.readUint32(e,0===c?12:20),e=l.findBox(a,["mdia","hdlr"])[0])&&(e={soun:"audio",vide:"video"}[l.bin2str(e.data.subarray(e.start+8,e.start+12))])&&(a=l.findBox(a,["mdia","minf","stbl","stsd"]),a.length&&(a=a[0],a=l.bin2str(a.data.subarray(a.start+12,a.start+16)),x.logger.log("MP4Demuxer:"+e+":"+a+" found")),d[b]={timescale:c,type:e},d[e]={timescale:c,id:b})}}),d},l.getStartDTS=function(f,d){var a,b,c;return a=l.findBox(d,["moof","traf"]),b=[].concat.apply([],a.map(function(a){return l.findBox(a,["tfhd"]).map(function(b){var c,d;return c=l.readUint32(b,4),d=f[c].timescale||9E4,l.findBox(a,["tfdt"]).map(function(a){var b,c;return b=a.data[a.start],c=l.readUint32(a,4),1===b&&(c*=Math.pow(2,32),c+=l.readUint32(a,8)),c})[0]/d})})),c=Math.min.apply(null,b),isFinite(c)?c:0},l.offsetStartDTS=function(f,d,a){l.findBox(d,["moof","traf"]).map(function(b){return l.findBox(b,["tfhd"]).map(function(c){c=l.readUint32(c,4);var d=f[c].timescale||9E4;l.findBox(b,["tfdt"]).map(function(b){var c=b.data[b.start],e=l.readUint32(b,4);0===c?l.writeUint32(b,4,e-a*d):(e*=Math.pow(2,32),e+=l.readUint32(b,8),e-=a*d,e=Math.max(e,0),c=Math.floor(e%(h+1)),l.writeUint32(b,4,Math.floor(e/(h+1))),l.writeUint32(b,8,c))})})})},l.prototype.append=function(f,d,a,b){var c=this.initData;c||(this.resetInitSegment(f,this.audioCodec,this.videoCodec,!1),c=this.initData);var e=this.initPTS;void 0===e&&(this.initPTS=e=l.getStartDTS(c,f)-d,this.observer.trigger(m["default"].INIT_PTS_FOUND,{initPTS:e}));l.offsetStartDTS(c,f,e);d=l.getStartDTS(c,f);this.remuxer.remux(c.audio,c.video,null,null,d,a,b,f)},l.prototype.destroy=function(){},l}();n["default"]=p},"./src/demux/mpegaudio.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48E3,32E3,22050,24E3,16E3,11025,12E3,8E3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(m,h,l,f,d){if(!(l+24>h.length)){var a=this.parseHeader(h,l);if(a&&l+a.frameLength<=h.length)return f+=9E4*a.samplesPerFrame/a.sampleRate*d,h={unit:h.subarray(l,l+a.frameLength),pts:f,dts:f},m.config=[],m.channelCount=a.channelCount,m.samplerate=a.sampleRate,m.samples.push(h),m.len+=a.frameLength,{sample:h,length:a.frameLength}}},parseHeader:function(m,h){var l=m[h+1]>>3&3,f=m[h+1]>>1&3,d=m[h+2]>>4&15,a=m[h+2]>>2&3,b=m[h+2]>>1&1;if(1!==l&&0!==d&&15!==d&&3!==a){var a=x.SamplingRateMap[3*(3===l?0:2===l?1:2)+a],c=x.SamplesCoefficients[l][f],e=x.BytesInSlot[f],g=8*c*e;return{sampleRate:a,channelCount:3==m[h+3]>>6?1:2,frameLength:parseInt(1E3*c*x.BitratesMap[14*(3===l?3-f:3===f?3:4)+d-1]/a+b,10)*e,samplesPerFrame:g}}},isHeaderPattern:function(m,h){return 255===m[h]&&224==(224&m[h+1])&&0!=(6&m[h+1])},isHeader:function(m,h){return!!(h+1<m.length&&this.isHeaderPattern(m,h))},probe:function(m,h){if(h+1<m.length&&this.isHeaderPattern(m,h)){var l=this.parseHeader(m,h),f=4;l&&l.frameLength&&(f=l.frameLength);l=h+f;if(l===m.length||l+1<m.length&&this.isHeaderPattern(m,l))return!0}return!1}};n["default"]=x},"./src/demux/sample-aes.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/crypt/decrypter.js");p=function(){function m(h,l,f,d){this.decryptdata=f;this.discardEPB=d;this.decrypter=new x["default"](h,l,{removePKCS7Padding:!1})}return m.prototype.decryptBuffer=function(h,l){this.decrypter.decrypt(h,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,l)},m.prototype.decryptAacSample=function(h,l,f,d){var a=h[l].unit,b=a.subarray(16,a.length-a.length%16),b=b.buffer.slice(b.byteOffset,b.byteOffset+b.length),c=this;this.decryptBuffer(b,function(b){b=new Uint8Array(b);a.set(b,16);d||c.decryptAacSamples(h,l+1,f)})},m.prototype.decryptAacSamples=function(h,l,f){for(;;l++){if(l>=h.length)return void f();if(!(32>h[l].unit.length)){var d=this.decrypter.isSync();if(this.decryptAacSample(h,l,f,d),!d)break}}},m.prototype.getAvcEncryptedData=function(h){for(var l=new Int8Array(16*Math.floor((h.length-48)/160)+16),f=0,d=32;d<=h.length-16;d+=160,f+=16)l.set(h.subarray(d,d+16),f);return l},m.prototype.getAvcDecryptedUnit=function(h,l){l=new Uint8Array(l);for(var f=0,d=32;d<=h.length-16;d+=160,f+=16)h.set(l.subarray(f,f+16),d);return h},m.prototype.decryptAvcSample=function(h,l,f,d,a,b){var c=this.discardEPB(a.data),e=this.getAvcEncryptedData(c),g=this;this.decryptBuffer(e.buffer,function(e){a.data=g.getAvcDecryptedUnit(c,e);b||g.decryptAvcSamples(h,l,f+1,d)})},m.prototype.decryptAvcSamples=function(h,l,f,d){for(;;l++,f=0){if(l>=h.length)return void d();for(var a=h[l].units;!(f>=a.length);f++){var b=a[f];if(!(48>=b.length||1!==b.type&&5!==b.type)){var c=this.decrypter.isSync();if(this.decryptAvcSample(h,l,f,d,b,c),!c)return}}}},m}();n["default"]=p},"./src/demux/tsdemuxer.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/demux/adts.js"),m=q("./src/demux/mpegaudio.js"),h=q("./src/events.js"),l=q("./src/demux/exp-golomb.js"),f=q("./src/demux/sample-aes.js"),d=q("./src/utils/logger.js"),a=q("./src/errors.js"),b={video:1,audio:2,id3:3,text:4};p=function(){function c(a,b,c,d){this.observer=a;this.config=c;this.typeSupported=d;this.remuxer=b;this.sampleAes=null}return c.prototype.setDecryptData=function(a){null!=a&&null!=a.key&&"SAMPLE-AES"===a.method?this.sampleAes=new f["default"](this.observer,this.config,a,this.discardEPB):this.sampleAes=null},c.probe=function(a){a=c._syncOffset(a);return!(0>a)&&(a&&d.logger.warn("MPEG2-TS detected but first sync word found @ offset "+a+", junk ahead ?"),!0)},c._syncOffset=function(a){for(var b=Math.min(1E3,a.length-564),c=0;c<b;){if(71===a[c]&&71===a[c+188]&&71===a[c+376])return c;c++}return-1},c.createTrack=function(a,c){return{container:"video"===a||"audio"===a?"video/mp2t":void 0,type:a,id:b[a],pid:-1,inputTimeScale:9E4,sequenceNumber:0,samples:[],len:0,dropped:"video"===a?0:void 0,isAAC:"audio"===a||void 0,duration:"audio"===a?c:void 0}},c.prototype.resetInitSegment=function(a,b,d,f){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=c.createTrack("video",f);this._audioTrack=c.createTrack("audio",f);this._id3Track=c.createTrack("id3",f);this._txtTrack=c.createTrack("text",f);this.avcSample=this.aacLastPTS=this.aacOverFlow=null;this.audioCodec=b;this.videoCodec=d;this._duration=f},c.prototype.resetTimeStamp=function(){},c.prototype.append=function(b,g,f,l){var e,m,n,r,p,q=b.length,x=!1;this.contiguous=f;var t=this.pmtParsed,u=this._avcTrack,E=this._audioTrack,A=this._id3Track,y=u.pid,J=E.pid,V=A.pid,ca=this._pmtId,X=u.pesData,da=E.pesData,U=A.pesData,ia=this._parsePAT,na=this._parsePMT,sa=this._parsePES,Ea=this._parseAVCPES.bind(this),Qa=this._parseAACPES.bind(this),Ra=this._parseMPEGPES.bind(this),bb=this._parseID3PES.bind(this),ga=c._syncOffset(b),q=q-(q+ga)%188;for(e=ga;e<q;e+=188)if(71===b[e]){if(m=!!(64&b[e+1]),n=((31&b[e+1])<<8)+b[e+2],1<(48&b[e+3])>>4){if((r=e+5+b[e+4])===e+188)continue}else r=e+4;switch(n){case y:m&&(X&&(p=sa(X))&&void 0!==p.pts&&Ea(p,!1),X={data:[],size:0});X&&(X.data.push(b.subarray(r,e+188)),X.size+=e+188-r);break;case J:m&&(da&&(p=sa(da))&&void 0!==p.pts&&(E.isAAC?Qa(p):Ra(p)),da={data:[],size:0});da&&(da.data.push(b.subarray(r,e+188)),da.size+=e+188-r);break;case V:m&&(U&&(p=sa(U))&&void 0!==p.pts&&bb(p),U={data:[],size:0});U&&(U.data.push(b.subarray(r,e+188)),U.size+=e+188-r);break;case 0:m&&(r+=b[r]+1);ca=this._pmtId=ia(b,r);break;case ca:m&&(r+=b[r]+1);m=na(b,r,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(y=m.avc)&&(u.pid=y);0<(J=m.audio)&&(E.pid=J,E.isAAC=m.isAAC);0<(V=m.id3)&&(A.pid=V);x&&!t&&(d.logger.log("reparse from beginning"),x=!1,e=ga-188);t=this.pmtParsed=!0;break;case 17:case 8191:break;default:x=!0}}else this.observer.trigger(h["default"].ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});X&&(p=sa(X))&&void 0!==p.pts?(Ea(p,!0),u.pesData=null):u.pesData=X;da&&(p=sa(da))&&void 0!==p.pts?(E.isAAC?Qa(p):Ra(p),E.pesData=null):(da&&da.size&&d.logger.log("last AAC PES packet truncated,might overlap between fragments"),E.pesData=da);U&&(p=sa(U))&&void 0!==p.pts?(bb(p),A.pesData=null):A.pesData=U;null==this.sampleAes?this.remuxer.remux(E,u,A,this._txtTrack,g,f,l):this.decryptAndRemux(E,u,A,this._txtTrack,g,f,l)},c.prototype.decryptAndRemux=function(a,b,c,d,f,h,l){if(a.samples&&a.isAAC){var e=this;this.sampleAes.decryptAacSamples(a.samples,0,function(){e.decryptAndRemuxAvc(a,b,c,d,f,h,l)})}else this.decryptAndRemuxAvc(a,b,c,d,f,h,l)},c.prototype.decryptAndRemuxAvc=function(a,b,c,d,f,h,l){if(b.samples){var e=this;this.sampleAes.decryptAvcSamples(b.samples,0,0,function(){e.remuxer.remux(a,b,c,d,f,h,l)})}else this.remuxer.remux(a,b,c,d,f,h,l)},c.prototype.destroy=function(){this._initPTS=this._initDTS=void 0;this._duration=0},c.prototype._parsePAT=function(a,b){return(31&a[b+10])<<8|a[b+11]},c.prototype._parsePMT=function(a,b,c,f){var e,g,h={audio:-1,avc:-1,id3:-1,isAAC:!0};e=b+3+((15&a[b+1])<<8|a[b+2])-4;for(b+=12+((15&a[b+10])<<8|a[b+11]);b<e;){switch(g=(31&a[b+1])<<8|a[b+2],a[b]){case 207:if(!f){d.logger.log("unkown stream type:"+a[b]);break}case 15:-1===h.audio&&(h.audio=g);break;case 21:-1===h.id3&&(h.id3=g);break;case 219:if(!f){d.logger.log("unkown stream type:"+a[b]);break}case 27:-1===h.avc&&(h.avc=g);break;case 3:case 4:c?-1===h.audio&&(h.audio=g,h.isAAC=!1):d.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:d.logger.warn("HEVC stream type found, not supported for now");break;default:d.logger.log("unkown stream type:"+a[b])}b+=5+((15&a[b+3])<<8|a[b+4])}return h},c.prototype._parsePES=function(a){var b,c,e,f,h,l,m=0,n=a.data;if(!a||0===a.size)return null;for(;19>n[0].length&&1<n.length;)l=new Uint8Array(n[0].length+n[1].length),l.set(n[0]),l.set(n[1],n[0].length),n[0]=l,n.splice(1,1);if(1!==((b=n[0])[0]<<16)+(b[1]<<8)+b[2]||(e=(b[4]<<8)+b[5])&&e>a.size-6)return null;192&(c=b[7])&&(4294967295<(f=536870912*(14&b[9])+4194304*(255&b[10])+16384*(254&b[11])+128*(255&b[12])+(254&b[13])/2)&&(f-=8589934592),64&c?(4294967295<(h=536870912*(14&b[14])+4194304*(255&b[15])+16384*(254&b[16])+128*(255&b[17])+(254&b[18])/2)&&(h-=8589934592),54E5<f-h&&(d.logger.warn(Math.round((f-h)/9E4)+"s delta between PTS and DTS, align them"),f=h)):h=f);l=(c=b[8])+9;a.size-=l;a=new Uint8Array(a.size);for(var p=0,q=n.length;p<q;p++){var x=(b=n[p]).byteLength;if(l){if(x<l){l-=x;continue}b=b.subarray(l);x-=l;l=0}a.set(b,m);m+=x}return e&&(e-=c+3),{data:a,pts:f,dts:h,len:e}},c.prototype.pushAccesUnit=function(a,b){if(a.units.length&&a.frame){var c=b.samples,e=c.length;!this.config.forceKeyFrameOnDiscontinuity||!0===a.key||b.sps&&(e||this.contiguous)?(a.id=e,c.push(a)):b.dropped++}a.debug.length&&d.logger.log(a.pts+"/"+a.dts+":"+a.debug)},c.prototype._parseAVCPES=function(a,b){var c,d,e,f=this,g=this._avcTrack,h=this._parseAVCNALu(a.data),m=this.avcSample,n=!1,p=this.pushAccesUnit.bind(this),q=function(a,b,c,d){return{key:a,pts:b,dts:c,units:[],debug:d}};a.data=null;m&&h.length&&!g.audFound&&(p(m,g),m=this.avcSample=q(!1,a.pts,a.dts,""));h.forEach(function(b){switch(b.type){case 1:d=!0;m||(m=f.avcSample=q(!0,a.pts,a.dts,""));m.frame=!0;var h=b.data;n&&4<h.length&&(h=(new l["default"](h)).readSliceType(),2!==h&&4!==h&&7!==h&&9!==h||(m.key=!0));break;case 5:d=!0;m||(m=f.avcSample=q(!0,a.pts,a.dts,""));m.key=!0;m.frame=!0;break;case 6:d=!0;(c=new l["default"](f.discardEPB(b.data))).readUByte();for(var r,B,h=!1,v=0;!h&&1<c.bytesAvailable;){for(r=0;r+=v=c.readUByte(),255===v;);for(B=0;B+=v=c.readUByte(),255===v;);if(4===r&&0!==c.bytesAvailable){if((h=!0,181===c.readUByte())&&49===c.readUShort()&&1195456820===c.readUInt()&&3===c.readUByte()){B=c.readUByte();r=31&B;B=[B,c.readUByte()];for(e=0;e<r;e++)B.push(c.readUByte()),B.push(c.readUByte()),B.push(c.readUByte());f._insertSampleInOrder(f._txtTrack.samples,{type:3,pts:a.pts,bytes:B})}}else if(B<c.bytesAvailable)for(e=0;e<B;e++)c.readUByte()}break;case 7:if(n=d=!0,!g.sps){h=(c=new l["default"](b.data)).readSPS();g.width=h.width;g.height=h.height;g.pixelRatio=h.pixelRatio;g.sps=[b.data];g.duration=f._duration;h=b.data.subarray(1,4);v="avc1.";for(e=0;3>e;e++)r=h[e].toString(16),2>r.length&&(r="0"+r),v+=r;g.codec=v}break;case 8:d=!0;g.pps||(g.pps=[b.data]);break;case 9:d=!1;g.audFound=!0;m&&p(m,g);m=f.avcSample=q(!1,a.pts,a.dts,"");break;case 12:d=!1;break;default:d=!1,m&&(m.debug+="unknown NAL "+b.type+" ")}m&&d&&m.units.push(b)});b&&m&&(p(m,g),this.avcSample=null)},c.prototype._insertSampleInOrder=function(a,b){var c=a.length;if(0<c)if(b.pts>=a[c-1].pts)a.push(b);else for(--c;0<=c;c--){if(b.pts<a[c].pts){a.splice(c,0,b);break}}else a.push(b)},c.prototype._getLastNalUnit=function(){var a,b=this.avcSample;b&&0!==b.units.length||(b=this._avcTrack.samples,b=b[b.length-1]);b&&(a=b.units,a=a[a.length-1]);return a},c.prototype._parseAVCNALu=function(a){var b,c,d,e=0,f=a.byteLength,h=this._avcTrack,l=h.naluState||0,m=l,n=[],p=-1;for(-1===l&&(d=31&a[p=0],l=0,e=1);e<f;)if(b=a[e++],l)if(1!==l)if(b)if(1===b){var q,x;if(0<=p)c={data:a.subarray(p,e-l-1),type:d},n.push(c);else if(q=this._getLastNalUnit())if(m&&e<=4-m&&q.state&&(q.data=q.data.subarray(0,q.data.byteLength-m)),0<(b=e-l-1))(x=new Uint8Array(q.data.byteLength+b)).set(q.data,0),x.set(a.subarray(0,b),q.data.byteLength),q.data=x;l=e<f?(d=31&a[p=e],0):-1}else l=0;else l=3;else l=b?0:2;else l=b?0:1;(0<=p&&0<=l&&(c={data:a.subarray(p,f),type:d,state:l},n.push(c)),0===n.length)&&(q=this._getLastNalUnit())&&((x=new Uint8Array(q.data.byteLength+a.byteLength)).set(q.data,0),x.set(a,q.data.byteLength),q.data=x);return h.naluState=l,n},c.prototype.discardEPB=function(a){var b,c;b=a.byteLength;for(var d=[],e=1;e<b-2;)0===a[e]&&0===a[e+1]&&3===a[e+2]?(d.push(e+2),e+=2):e++;if(0===d.length)return a;b-=d.length;c=new Uint8Array(b);for(var f=0,e=0;e<b;f++,e++)f===d[0]&&(f++,d.shift()),c[e]=a[f];return c},c.prototype._parseAACPES=function(b){var c,e,f,l,m,n=this._audioTrack,p=b.data;b=b.pts;var q=this.aacOverFlow,t=this.aacLastPTS;q&&(f=new Uint8Array(q.byteLength+p.byteLength),f.set(q,0),f.set(p,q.byteLength),p=f);f=0;for(m=p.length;f<m-1&&!x.isHeader(p,f);f++);if(f&&(c=e=void 0,c=f<m-1?(e="AAC PES did not start with ADTS header,offset:"+f,!1):(e="no ADTS header found in AAC PES",!0),d.logger.warn("parsing error:"+e),this.observer.trigger(h["default"].ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:c,reason:e}),c))return;if(x.initTrackConfig(n,this.observer,p,f,this.audioCodec),e=0,c=x.getFrameDuration(n.samplerate),q&&t)q=t+c,1<Math.abs(q-b)&&(d.logger.log("AAC: align PTS for overlapping frames by "+Math.round((q-b)/90)),b=q);for(;f<m;)if(x.isHeader(p,f)&&f+5<m){q=x.appendFrame(n,p,f,b,e);if(!q)break;f+=q.length;l=q.sample.pts;e++}else f++;this.aacOverFlow=q=f<m?p.subarray(f,m):null;this.aacLastPTS=l},c.prototype._parseMPEGPES=function(a){var b=a.data,c=b.length,d=0,e=0;for(a=a.pts;e<c;)if(m["default"].isHeader(b,e)){var f=m["default"].appendFrame(this._audioTrack,b,e,a,d);if(!f)break;e+=f.length;d++}else e++},c.prototype._parseID3PES=function(a){this._id3Track.samples.push(a)},c}();n["default"]=p},"./src/errors.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"};n.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},"./src/event-handler.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/utils/logger.js"),m=q("./src/errors.js"),h=q("./src/events.js"),l={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0};p=function(){function f(d){for(var a=[],b=1;b<arguments.length;b++)a[b-1]=arguments[b];this.hls=d;this.onEvent=this.onEvent.bind(this);this.handledEvents=a;this.useGenericHandler=!0;this.registerListeners()}return f.prototype.destroy=function(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()},f.prototype.onHandlerDestroying=function(){},f.prototype.onHandlerDestroyed=function(){},f.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},f.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(d){if(l[d])throw Error("Forbidden event-name: "+d);this.hls.on(d,this.onEvent)},this)},f.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(d){this.hls.off(d,this.onEvent)},this)},f.prototype.onEvent=function(d,a){this.onEventGeneric(d,a)},f.prototype.onEventGeneric=function(d,a){try{var b="on"+d.replace("hls","");if("function"!=typeof this[b])throw Error("Event "+d+" has no generic handler in this "+this.constructor.name+" class (tried "+b+")");this[b].bind(this,a).call()}catch(c){x.logger.error("An internal error happened while handling event "+d+'. Error message: "'+c.message+'". Here is a stacktrace:',c),this.hls.trigger(h["default"].ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:d,err:c})}},f}();n["default"]=p},"./src/events.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n["default"]={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},"./src/hls.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}x(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var h=q("./node_modules/url-toolkit/src/url-toolkit.js"),l=q("./src/errors.js"),f=q("./src/loader/playlist-loader.js"),d=q("./src/loader/fragment-loader.js"),a=q("./src/loader/key-loader.js"),b=q("./src/controller/fragment-tracker.js"),c=q("./src/controller/stream-controller.js"),e=q("./src/controller/level-controller.js"),g=q("./src/controller/id3-track-controller.js"),r=q("./src/is-supported.js"),t=q("./src/utils/logger.js"),u=q("./src/config.js"),v=q("./src/events.js");p=function(n){function p(h){void 0===h&&(h={});var l=n.call(this)||this,m=p.DefaultConfig;if((h.liveSyncDurationCount||h.liveMaxLatencyDurationCount)&&(h.liveSyncDuration||h.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var r in m)r in h||(h[r]=m[r]);if(void 0!==h.liveMaxLatencyDurationCount&&h.liveMaxLatencyDurationCount<=h.liveSyncDurationCount)throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==h.liveMaxLatencyDuration&&(h.liveMaxLatencyDuration<=h.liveSyncDuration||void 0===h.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');t.enableLogs(h.debug);l.config=h;l._autoLevelCapping=-1;var q=l.abrController=new h.abrController(l),v=new h.bufferController(l),B=new h.capLevelController(l),D=new h.fpsController(l),x=new f["default"](l),u=new d["default"](l),F=new a["default"](l),A=new g["default"](l);r=l.levelController=new e["default"](l);var m=new b.FragmentTracker(l),C=[r,l.streamController=new c["default"](l,m)];(r=h.audioStreamController)&&C.push(new r(l,m));l.networkControllers=C;q=[x,u,F,q,v,B,D,A,m];if(r=h.audioTrackController)r=new r(l),l.audioTrackController=r,q.push(r);if(r=h.subtitleTrackController)r=new r(l),l.subtitleTrackController=r,q.push(r);if(r=h.emeController)v=new r(l),l.emeController=v,q.push(v);return(r=h.subtitleStreamController)&&q.push(new r(l,m)),(r=h.timelineController)&&q.push(new r(l)),l.coreComponents=q,l}return m(p,n),Object.defineProperty(p,"version",{get:function(){return"0.12.2"},enumerable:!0,configurable:!0}),p.isSupported=function(){return r.isSupported()},Object.defineProperty(p,"Events",{get:function(){return v["default"]},enumerable:!0,configurable:!0}),Object.defineProperty(p,"ErrorTypes",{get:function(){return l.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(p,"ErrorDetails",{get:function(){return l.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(p,"DefaultConfig",{get:function(){return p.defaultConfig?p.defaultConfig:u.hlsDefaultConfig},set:function(a){p.defaultConfig=a},enumerable:!0,configurable:!0}),p.prototype.destroy=function(){t.logger.log("destroy");this.trigger(v["default"].DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(a){a.destroy()});this.url=null;this.removeAllListeners();this._autoLevelCapping=-1},p.prototype.attachMedia=function(a){t.logger.log("attachMedia");this.media=a;this.trigger(v["default"].MEDIA_ATTACHING,{media:a})},p.prototype.detachMedia=function(){t.logger.log("detachMedia");this.trigger(v["default"].MEDIA_DETACHING);this.media=null},p.prototype.loadSource=function(a){a=h.buildAbsoluteURL(window.location.href,a,{alwaysNormalize:!0});t.logger.log("loadSource:"+a);this.url=a;this.trigger(v["default"].MANIFEST_LOADING,{url:a})},p.prototype.startLoad=function(a){void 0===a&&(a=-1);t.logger.log("startLoad("+a+")");this.networkControllers.forEach(function(b){b.startLoad(a)})},p.prototype.stopLoad=function(){t.logger.log("stopLoad");this.networkControllers.forEach(function(a){a.stopLoad()})},p.prototype.swapAudioCodec=function(){t.logger.log("swapAudioCodec");this.streamController.swapAudioCodec()},p.prototype.recoverMediaError=function(){t.logger.log("recoverMediaError");var a=this.media;this.detachMedia();this.attachMedia(a)},Object.defineProperty(p.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(a){t.logger.log("set currentLevel:"+a);this.loadLevel=a;this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(a){t.logger.log("set nextLevel:"+a);this.levelController.manualLevel=a;this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(a){t.logger.log("set loadLevel:"+a);this.levelController.manualLevel=a},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(a){this.levelController.nextLoadLevel=a},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(a){t.logger.log("set firstLevel:"+a);this.levelController.firstLevel=a},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(a){t.logger.log("set startLevel:"+a);-1!==a&&(a=Math.max(a,this.minAutoLevel));this.levelController.startLevel=a},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(a){t.logger.log("set autoLevelCapping:"+a);this._autoLevelCapping=a},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"minAutoLevel",{get:function(){for(var a=this.levels,b=this.config.minAutoBitrate,c=a?a.length:0,d=0;d<c;d++)if(b<(a[d].realBitrate?Math.max(a[d].realBitrate,a[d].bitrate):a[d].bitrate))return d;return 0},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"maxAutoLevel",{get:function(){var a=this.levels,b=this.autoLevelCapping;return-1===b&&a&&a.length?a.length-1:b},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(a){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,a)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"audioTracks",{get:function(){var a=this.audioTrackController;return a?a.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"audioTrack",{get:function(){var a=this.audioTrackController;return a?a.audioTrack:-1},set:function(a){var b=this.audioTrackController;b&&(b.audioTrack=a)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"subtitleTracks",{get:function(){var a=this.subtitleTrackController;return a?a.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"subtitleTrack",{get:function(){var a=this.subtitleTrackController;return a?a.subtitleTrack:-1},set:function(a){var b=this.subtitleTrackController;b&&(b.subtitleTrack=a)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"subtitleDisplay",{get:function(){var a=this.subtitleTrackController;return!!a&&a.subtitleDisplay},set:function(a){var b=this.subtitleTrackController;b&&(b.subtitleDisplay=a)},enumerable:!0,configurable:!0}),p}(q("./src/observer.js").Observer);n["default"]=p},"./src/is-supported.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./src/utils/mediasource-helper.js");n.isSupported=function(){var m=x.getMediaSource(),h=window.SourceBuffer||window.WebKitSourceBuffer,m=m&&"function"==typeof m.isTypeSupported&&m.isTypeSupported('video/mp4; codecs\x3d"avc1.42E01E,mp4a.40.2"'),h=!h||h.prototype&&"function"==typeof h.prototype.appendBuffer&&"function"==typeof h.prototype.remove;return!!m&&!!h}},"./src/loader/fragment-loader.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])},function(a,c){function b(){this.constructor=a}m(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=q("./src/event-handler.js"),d=q("./src/errors.js"),a=q("./src/utils/logger.js"),f=function(b){function c(a){a=b.call(this,a,l["default"].FRAG_LOADING)||this;return a.loaders={},a}return h(c,b),c.prototype.destroy=function(){var a=this.loaders,c;for(c in a){var d=a[c];d&&d.destroy()}this.loaders={};b.prototype.destroy.call(this)},c.prototype.onFragLoading=function(b){var c=b.frag,d=c.type,e=this.loaders,f=this.hls.config,h=f.fLoader,l=f.loader;c.loaded=0;(b=e[d])&&(a.logger.warn("abort previous fragment loader for type: "+d),b.abort());b=e[d]=c.loader=f.fLoader?new h(f):new l(f);d={url:c.url,frag:c,responseType:"arraybuffer",progressData:!1};e=c.byteRangeStartOffset;c=c.byteRangeEndOffset;p.isFinite(e)&&p.isFinite(c)&&(d.rangeStart=e,d.rangeEnd=c);f={timeout:f.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:f.fragLoadingMaxRetryTimeout};c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};b.load(d,f,c)},c.prototype.loadsuccess=function(a,b,c,d){void 0===d&&(d=null);a=a.data;c=c.frag;c.loader=void 0;this.loaders[c.type]=void 0;this.hls.trigger(l["default"].FRAG_LOADED,{payload:a,frag:c,stats:b,networkDetails:d})},c.prototype.loaderror=function(a,b,c){void 0===c&&(c=null);var e=b.frag,f=e.loader;f&&f.abort();this.loaders[e.type]=void 0;this.hls.trigger(l["default"].ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:b.frag,response:a,networkDetails:c})},c.prototype.loadtimeout=function(a,b,c){void 0===c&&(c=null);a=b.frag;var e=a.loader;e&&e.abort();this.loaders[a.type]=void 0;this.hls.trigger(l["default"].ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:b.frag,networkDetails:c})},c.prototype.loadprogress=function(a,b,c,d){void 0===d&&(d=null);b=b.frag;b.loaded=a.loaded;this.hls.trigger(l["default"].FRAG_LOAD_PROGRESS,{frag:b,stats:a,networkDetails:d})},c}(f["default"]);n["default"]=f}).call(this,q("./src/polyfills/number.js").Number)},"./src/loader/fragment.js":function(p,n,q){(function(p){Object.defineProperty(n,"__esModule",{value:!0});var m=q("./node_modules/url-toolkit/src/url-toolkit.js"),h=q("./src/loader/level-key.js"),l=function(){function f(){var d;this._decryptdata=this._byteRange=this._url=null;this.tagList=[];this.rawProgramDateTime=this.programDateTime=null;this._elementaryStreams=((d={})[f.ElementaryStreamTypes.AUDIO]=!1,d[f.ElementaryStreamTypes.VIDEO]=!1,d)}return Object.defineProperty(f,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=m.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(d){this._url=d},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var d=[];if(this.rawByteRange){var a=this.rawByteRange.split("@",2);d[0]=1===a.length?this.lastByteRangeEndOffset||0:parseInt(a[1]);d[1]=parseInt(a[0])+d[0];this._byteRange=d}return d},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"endProgramDateTime",{get:function(){if(!p.isFinite(this.programDateTime))return null;var d=p.isFinite(this.duration)?this.duration:0;return this.programDateTime+1E3*d},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),f.prototype.addElementaryStream=function(d){this._elementaryStreams[d]=!0},f.prototype.hasElementaryStream=function(d){return!0===this._elementaryStreams[d]},f.prototype.createInitializationVector=function(d){for(var a=new Uint8Array(16),b=12;16>b;b++)a[b]=d>>8*(15-b)&255;return a},f.prototype.fragmentDecryptdataFromLevelkey=function(d,a){var b=d;return d&&d.method&&d.uri&&!d.iv&&((b=new h["default"]).method=d.method,b.baseuri=d.baseuri,b.reluri=d.reluri,b.iv=this.createInitializationVector(a)),b},f}();n["default"]=l}).call(this,q("./src/polyfills/number.js").Number)},"./src/loader/key-loader.js":function(p,n,q){var x,m=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}x(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var h=q("./src/events.js"),l=q("./src/event-handler.js"),f=q("./src/errors.js"),d=q("./src/utils/logger.js");p=function(a){function b(b){b=a.call(this,b,h["default"].KEY_LOADING)||this;return b.loaders={},b.decryptkey=null,b.decrypturl=null,b}return m(b,a),b.prototype.destroy=function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy()}this.loaders={};l["default"].prototype.destroy.call(this)},b.prototype.onKeyLoading=function(a){a=a.frag;var b=a.type,c=this.loaders[b],f=a.decryptdata,l=f.uri;l!==this.decrypturl||null===this.decryptkey?(f=this.hls.config,c&&(d.logger.warn("abort previous key loader for type:"+b),c.abort()),a.loader=this.loaders[b]=new f.loader(f),this.decrypturl=l,this.decryptkey=null,b={url:l,frag:a,responseType:"arraybuffer"},c={timeout:f.fragLoadingTimeOut,maxRetry:0,retryDelay:f.fragLoadingRetryDelay,maxRetryDelay:f.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},a.loader.load(b,c,l)):this.decryptkey&&(f.key=this.decryptkey,this.hls.trigger(h["default"].KEY_LOADED,{frag:a}))},b.prototype.loadsuccess=function(a,b,d){b=d.frag;this.decryptkey=b.decryptdata.key=new Uint8Array(a.data);b.loader=void 0;this.loaders[b.type]=void 0;this.hls.trigger(h["default"].KEY_LOADED,{frag:b})},b.prototype.loaderror=function(a,b){var c=b.frag,d=c.loader;d&&d.abort();this.loaders[b.type]=void 0;this.hls.trigger(h["default"].ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:c,response:a})},b.prototype.loadtimeout=function(a,b){var c=b.frag,d=c.loader;d&&d.abort();this.loaders[b.type]=void 0;this.hls.trigger(h["default"].ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:c})},b}(l["default"]);n["default"]=p},"./src/loader/level-key.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var x=q("./node_modules/url-toolkit/src/url-toolkit.js");p=function(){function m(){this._uri=this.iv=this.key=this.method=null}return Object.defineProperty(m.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=x.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),m}();n["default"]=p},"./src/loader/level.js":function(p,n,q){(function(p){Object.defineProperty(n,"__esModule",{value:!0});var m=function(){function h(h){this.endSN=this.endCC=0;this.fragments=[];this.initSegment=null;this.live=!0;this.needSidxRanges=!1;this.startSN=this.startCC=0;this.startTimeOffset=null;this.totalduration=this.targetduration=0;this.type=null;this.url=h;this.version=null}return Object.defineProperty(h.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!p.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),h}();n["default"]=m}).call(this,q("./src/polyfills/number.js").Number)},"./src/loader/m3u8-parser.js":function(p,n,q){(function(p){function m(a,b){a.rawProgramDateTime?a.programDateTime=Date.parse(a.rawProgramDateTime):b&&b.programDateTime&&(a.programDateTime=b.endProgramDateTime);p.isFinite(a.programDateTime)||(a.programDateTime=null,a.rawProgramDateTime=null)}Object.defineProperty(n,"__esModule",{value:!0});var h=q("./node_modules/url-toolkit/src/url-toolkit.js"),l=q("./src/loader/fragment.js"),f=q("./src/loader/level.js"),d=q("./src/loader/level-key.js"),a=q("./src/utils/attr-list.js"),b=q("./src/utils/logger.js"),c=q("./src/utils/codecs.js"),e=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,g=/#EXT-X-MEDIA:(.*)/g,r=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),t=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,x=/\.(mp4|m4s|m4v|m4a)$/i,v=function(){function n(){}return n.findGroup=function(a,b){if(!a)return null;for(var c=null,d=0;d<a.length;d++){var e=a[d];e.id===b&&(c=e)}return c},n.convertAVC1ToAVCOTI=function(a){var b,c=a.split(".");return 2<c.length?(b=c.shift()+".",b+=parseInt(c.shift()).toString(16),b+=("000"+parseInt(c.shift()).toString(16)).substr(-4)):b=a,b},n.resolve=function(a,b){return h.buildAbsoluteURL(b,a,{alwaysNormalize:!0})},n.parseMasterPlaylist=function(b,d){function f(a,b){["video","audio"].forEach(function(d){var e=a.filter(function(a){return c.isCodecType(a,d)});if(e.length){var f=e.filter(function(a){return 0===a.lastIndexOf("avc1",0)||0===a.lastIndexOf("mp4a",0)});b[d+"Codec"]=0<f.length?f[0]:e[0];a=a.filter(function(a){return-1===e.indexOf(a)})}});b.unknownCodecs=a}var g,h=[];for(e.lastIndex=0;null!=(g=e.exec(b));){var l={},m=l.attrs=new a["default"](g[1]);l.url=n.resolve(g[2],d);(g=m.decimalResolution("RESOLUTION"))&&(l.width=g.width,l.height=g.height);l.bitrate=m.decimalInteger("AVERAGE-BANDWIDTH")||m.decimalInteger("BANDWIDTH");l.name=m.NAME;f([].concat((m.CODECS||"").split(/[ ,]+/)),l);l.videoCodec&&-1!==l.videoCodec.indexOf("avc1")&&(l.videoCodec=n.convertAVC1ToAVCOTI(l.videoCodec));h.push(l)}return h},n.parseMasterPlaylistMedia=function(b,c,d,e){var f;void 0===e&&(e=[]);var h=[],l=0;for(g.lastIndex=0;null!==(f=g.exec(b));){var m={};f=new a["default"](f[1]);if(f.TYPE===d){if(m.groupId=f["GROUP-ID"],m.name=f.NAME,m.type=d,m["default"]="YES"===f.DEFAULT,m.autoselect="YES"===f.AUTOSELECT,m.forced="YES"===f.FORCED,f.URI&&(m.url=n.resolve(f.URI,c)),m.lang=f.LANGUAGE,m.name||(m.name=m.lang),e.length)f=n.findGroup(e,m.groupId),m.audioCodec=f?f.codec:e[0].codec;m.id=l++;h.push(m)}}return h},n.parseLevelPlaylist=function(c,e,g,h,n){var q,v,B=0,D=0,u=new f["default"](e),A=new d["default"],y=0,C=null,F=new l["default"],E=null;for(r.lastIndex=0;null!==(q=r.exec(c));)if(v=q[1])F.duration=parseFloat(v),q=(" "+q[2]).slice(1),F.title=q||null,F.tagList.push(q?["INF",v,q]:["INF",v]);else if(q[3])p.isFinite(F.duration)&&(v=B++,F.type=h,F.start=D,F.levelkey=A,F.sn=v,F.level=g,F.cc=y,F.urlId=n,F.baseurl=e,F.relurl=(" "+q[3]).slice(1),m(F,C),u.fragments.push(F),D+=(C=F).duration,F=new l["default"]);else if(q[4])(F.rawByteRange=(" "+q[4]).slice(1),C)&&(q=C.byteRangeEndOffset)&&(F.lastByteRangeEndOffset=q);else if(q[5])F.rawProgramDateTime=(" "+q[5]).slice(1),F.tagList.push(["PROGRAM-DATE-TIME",F.rawProgramDateTime]),null===E&&(E=u.fragments.length);else{q=q[0].match(t);for(v=1;v<q.length&&void 0===q[v];v++);var S=(" "+q[v+1]).slice(1),aa=(" "+q[v+2]).slice(1);switch(q[v]){case "#":F.tagList.push(aa?[S,aa]:[S]);break;case "PLAYLIST-TYPE":u.type=S.toUpperCase();break;case "MEDIA-SEQUENCE":B=u.startSN=parseInt(S);break;case "TARGETDURATION":u.targetduration=parseFloat(S);break;case "VERSION":u.version=parseInt(S);break;case "EXTM3U":break;case "ENDLIST":u.live=!1;break;case "DIS":y++;F.tagList.push(["DIS"]);break;case "DISCONTINUITY-SEQ":y=parseInt(S);break;case "KEY":S=new a["default"](S);q=S.enumeratedString("METHOD");v=S.URI;S=S.hexadecimalInteger("IV");q&&(A=new d["default"],v&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(q)&&(A.method=q,A.baseuri=e,A.reluri=v,A.key=null,A.iv=S));break;case "START":q=(new a["default"](S)).decimalFloatingPoint("TIME-OFFSET");p.isFinite(q)&&(u.startTimeOffset=q);break;case "MAP":q=new a["default"](S);F.relurl=q.URI;F.rawByteRange=q.BYTERANGE;F.baseurl=e;F.level=g;F.type=h;F.sn="initSegment";u.initSegment=F;(F=new l["default"]).rawProgramDateTime=u.initSegment.rawProgramDateTime;break;default:b.logger.warn("line parsed but not handled: "+q)}}return(F=C)&&!F.relurl&&(u.fragments.pop(),D-=F.duration),u.totalduration=D,u.averagetargetduration=D/u.fragments.length,u.endSN=B-1,u.startCC=u.fragments[0]?u.fragments[0].cc:0,u.endCC=y,!u.initSegment&&u.fragments.length&&u.fragments.every(function(a){return x.test(a.relurl)})&&(b.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(F=new l["default"]).relurl=u.fragments[0].relurl,F.baseurl=e,F.level=g,F.type=h,F.sn="initSegment",u.initSegment=F,u.needSidxRanges=!0),E&&function(a,b){for(var c=a[b],d=b-1;0<=d;d--){var e=a[d];e.programDateTime=c.programDateTime-1E3*e.duration;c=e}}(u.fragments,E),u},n}();n["default"]=v}).call(this,q("./src/polyfills/number.js").Number)},"./src/loader/playlist-loader.js":function(p,n,q){(function(p){var m,h=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},function(a,b){function c(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(n,"__esModule",{value:!0});var l=q("./src/events.js"),f=q("./src/event-handler.js"),d=q("./src/errors.js"),a=q("./src/utils/logger.js"),b=q("./src/demux/mp4demuxer.js"),c=q("./src/loader/m3u8-parser.js"),e=window.performance,g={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},r={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},f=function(f){function m(a){a=f.call(this,a,l["default"].MANIFEST_LOADING,l["default"].LEVEL_LOADING,l["default"].AUDIO_TRACK_LOADING,l["default"].SUBTITLE_TRACK_LOADING)||this;return a.loaders={},a}return h(m,f),Object.defineProperty(m,"ContextType",{get:function(){return g},enumerable:!0,configurable:!0}),Object.defineProperty(m,"LevelType",{get:function(){return r},enumerable:!0,configurable:!0}),m.canHaveQualityLevels=function(a){return a!==g.AUDIO_TRACK&&a!==g.SUBTITLE_TRACK},m.mapContextToLevelType=function(a){switch(a.type){case g.AUDIO_TRACK:return r.AUDIO;case g.SUBTITLE_TRACK:return r.SUBTITLE;default:return r.MAIN}},m.getResponseUrl=function(a,b){var c=a.url;return void 0!==c&&0!==c.indexOf("data:")||(c=b.url),c},m.prototype.createInternalLoader=function(a){var b=this.hls.config,c=b.loader,b=new (b.pLoader||c)(b);return a.loader=b,this.loaders[a.type]=b},m.prototype.getInternalLoader=function(a){return this.loaders[a.type]},m.prototype.resetInternalLoader=function(a){this.loaders[a]&&delete this.loaders[a]},m.prototype.destroyInternalLoaders=function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy();this.resetInternalLoader(a)}},m.prototype.destroy=function(){this.destroyInternalLoaders();f.prototype.destroy.call(this)},m.prototype.onManifestLoading=function(a){this.load(a.url,{type:g.MANIFEST,level:0,id:null})},m.prototype.onLevelLoading=function(a){this.load(a.url,{type:g.LEVEL,level:a.level,id:a.id})},m.prototype.onAudioTrackLoading=function(a){this.load(a.url,{type:g.AUDIO_TRACK,level:null,id:a.id})},m.prototype.onSubtitleTrackLoading=function(a){this.load(a.url,{type:g.SUBTITLE_TRACK,level:null,id:a.id})},m.prototype.load=function(b,c){var d=this.hls.config;a.logger.debug("Loading playlist of type "+c.type+", level: "+c.level+", id: "+c.id);var e,f,h,l,m=this.getInternalLoader(c);if(m){if((e=m.context)&&e.url===b)return a.logger.trace("playlist request ongoing"),!1;a.logger.warn("aborting previous loader for type: "+c.type);m.abort()}switch(c.type){case g.MANIFEST:e=d.manifestLoadingMaxRetry;f=d.manifestLoadingTimeOut;h=d.manifestLoadingRetryDelay;l=d.manifestLoadingMaxRetryTimeout;break;case g.LEVEL:e=0;f=d.levelLoadingTimeOut;break;default:e=d.levelLoadingMaxRetry,f=d.levelLoadingTimeOut,h=d.levelLoadingRetryDelay,l=d.levelLoadingMaxRetryTimeout}m=this.createInternalLoader(c);c.url=b;c.responseType=c.responseType||"";d={timeout:f,maxRetry:e,retryDelay:h,maxRetryDelay:l};h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return a.logger.debug("Calling internal loader delegate for URL: "+b),m.load(c,d,h),!0},m.prototype.loadsuccess=function(a,b,c,d){if(void 0===d&&(d=null),c.isSidxRequest)return this._handleSidxRequest(a,c),void this._handlePlaylistLoaded(a,b,c,d);this.resetInternalLoader(c.type);var f=a.data;b.tload=e.now();0===f.indexOf("#EXTM3U")?0<f.indexOf("#EXTINF:")||0<f.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(a,b,c,d):this._handleMasterPlaylist(a,b,c,d):this._handleManifestParsingError(a,c,"no EXTM3U delimiter",d)},m.prototype.loaderror=function(a,b,c){void 0===c&&(c=null);this._handleNetworkError(b,c,!1,a)},m.prototype.loadtimeout=function(a,b,c){void 0===c&&(c=null);this._handleNetworkError(b,c,!0)},m.prototype._handleMasterPlaylist=function(b,d,e,f){var g=this.hls,h=b.data,n=m.getResponseUrl(b,e),p=c["default"].parseMasterPlaylist(h,n);if(p.length){b=p.map(function(a){return{id:a.attrs.AUDIO,codec:a.audioCodec}});b=c["default"].parseMasterPlaylistMedia(h,n,"AUDIO",b);h=c["default"].parseMasterPlaylistMedia(h,n,"SUBTITLES");if(b.length){var q=!1;b.forEach(function(a){a.url||(q=!0)});!1===q&&p[0].audioCodec&&!p[0].attrs.AUDIO&&(a.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main"}))}g.trigger(l["default"].MANIFEST_LOADED,{levels:p,audioTracks:b,subtitles:h,url:n,stats:d,networkDetails:f})}else this._handleManifestParsingError(b,e,"no level found in manifest",f)},m.prototype._handleTrackOrLevelPlaylist=function(a,b,d,f){var h=this.hls,n=d.id,q=d.level,r=d.type,v=m.getResponseUrl(a,d),B=p.isFinite(n)?n:0,D=p.isFinite(q)?q:B,t=m.mapContextToLevelType(d),B=c["default"].parseLevelPlaylist(a.data,v,D,t,B);(B.tload=b.tload,r===g.MANIFEST)&&h.trigger(l["default"].MANIFEST_LOADED,{levels:[{url:v,details:B}],audioTracks:[],url:v,stats:b,networkDetails:f});(b.tparsed=e.now(),B.needSidxRanges)?this.load(B.initSegment.url,{isSidxRequest:!0,type:r,level:q,levelDetails:B,id:n,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"}):(d.levelDetails=B,this._handlePlaylistLoaded(a,b,d,f))},m.prototype._handleSidxRequest=function(a,c){var d=b["default"].parseSegmentIndex(new Uint8Array(a.data));if(d){var e=c.levelDetails;d.references.forEach(function(a,b){var c=a.info,d=e.fragments[b];0===d.byteRange.length&&(d.rawByteRange=String(1+c.end-c.start)+"@"+String(c.start))});e.initSegment.rawByteRange=String(d.moovEndOffset)+"@0"}},m.prototype._handleManifestParsingError=function(a,b,c,e){this.hls.trigger(l["default"].ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a.url,reason:c,networkDetails:e})},m.prototype._handleNetworkError=function(b,c,e,f){var h;void 0===e&&(e=!1);void 0===f&&(f=null);a.logger.info("A network error occured while loading a "+b.type+"-type playlist");var m=this.getInternalLoader(b);switch(b.type){case g.MANIFEST:h=e?d.ErrorDetails.MANIFEST_LOAD_TIMEOUT:d.ErrorDetails.MANIFEST_LOAD_ERROR;e=!0;break;case g.LEVEL:h=e?d.ErrorDetails.LEVEL_LOAD_TIMEOUT:d.ErrorDetails.LEVEL_LOAD_ERROR;e=!1;break;case g.AUDIO_TRACK:h=e?d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR;e=!1;break;default:e=!1}m&&(m.abort(),this.resetInternalLoader(b.type));b={type:d.ErrorTypes.NETWORK_ERROR,details:h,fatal:e,url:m.url,loader:m,context:b,networkDetails:c};f&&(b.response=f);this.hls.trigger(l["default"].ERROR,b)},m.prototype._handlePlaylistLoaded=function(a,b,c,d){var e=c.type,f=c.level,h=c.id,n=c.levelDetails;if(n.targetduration)if(m.canHaveQualityLevels(c.type))this.hls.trigger(l["default"].LEVEL_LOADED,{details:n,level:f||0,id:h||0,stats:b,networkDetails:d});else switch(e){case g.AUDIO_TRACK:this.hls.trigger(l["default"].AUDIO_TRACK_LOADED,{details:n,id:h,stats:b,networkDetails:d});break;case g.SUBTITLE_TRACK:this.hls.trigger(l["default"].SUBTITLE_TRACK_LOADED,{details:n,id:h,stats:b,networkDetails:d})}else this._handleManifestParsingError(a,c,"invalid target duration",d)},m}(f["default"]);n["default"]=f}).call(this,q("./src/polyfills/number.js").Number)},"./src/observer.js":function(p,n,q){var t,m=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,l){h.__proto__=l}||function(h,l){for(var f in l)l.hasOwnProperty(f)&&(h[f]=l[f])},function(h,l){function f(){this.constructor=h}t(h,l);h.prototype=null===l?Object.create(l):(f.prototype=l.prototype,new f)});Object.defineProperty(n,"__esModule",{value:!0});p=function(h){function l(){return null!==h&&h.apply(this,arguments)||this}return m(l,h),l.prototype.trigger=function(f){for(var d=[],a=1;a<arguments.length;a++)d[a-1]=arguments[a];this.emit.apply(this,[f,f].concat(d))},l}(q("./node_modules/eventemitter3/index.js").EventEmitter);n.Observer=p},"./src/polyfills/number.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=q("./src/utils/get-self-scope.js").getSelfScope().Number;(n.Number=p).isFinite=p.isFinite||function(n){return"number"==typeof n&&isFinite(n)}},"./src/remux/aac-helper.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(){}return n.getSilentFrame=function(m,h){switch(m){case "mp4a.40.2":if(1===h)return new Uint8Array([0,200,0,128,35,128]);if(2===h)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===h)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===h)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===h)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===h)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===h)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===h||3===h)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},n}();n["default"]=p},"./src/remux/mp4-generator.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t=Math.pow(2,32)-1;p=function(){function m(){}return m.init=function(){for(var h in m.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})m.types.hasOwnProperty(h)&&(m.types[h]=[h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)]);h=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var l=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);m.HDLR_TYPES={video:h,audio:l};h=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);l=new Uint8Array([0,0,0,0,0,0,0,0]);m.STTS=m.STSC=m.STCO=l;m.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);m.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);m.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);m.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var l=new Uint8Array([105,115,111,109]),f=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);m.FTYP=m.box(m.types.ftyp,l,d,l,f);m.DINF=m.box(m.types.dinf,m.box(m.types.dref,h))},m.box=function(h){for(var l,f=Array.prototype.slice.call(arguments,1),d=8,a=f.length,b=a;a--;)d+=f[a].byteLength;(l=new Uint8Array(d))[0]=d>>24&255;l[1]=d>>16&255;l[2]=d>>8&255;l[3]=255&d;l.set(h,4);a=0;for(d=8;a<b;a++)l.set(f[a],d),d+=f[a].byteLength;return l},m.hdlr=function(h){return m.box(m.types.hdlr,m.HDLR_TYPES[h])},m.mdat=function(h){return m.box(m.types.mdat,h)},m.mdhd=function(h,l){l*=h;var f=Math.floor(l/(t+1)),d=Math.floor(l%(t+1));return m.box(m.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,255&h,f>>24,f>>16&255,f>>8&255,255&f,d>>24,d>>16&255,d>>8&255,255&d,85,196,0,0]))},m.mdia=function(h){return m.box(m.types.mdia,m.mdhd(h.timescale,h.duration),m.hdlr(h.type),m.minf(h))},m.mfhd=function(h){return m.box(m.types.mfhd,new Uint8Array([0,0,0,0,h>>24,h>>16&255,h>>8&255,255&h]))},m.minf=function(h){return"audio"===h.type?m.box(m.types.minf,m.box(m.types.smhd,m.SMHD),m.DINF,m.stbl(h)):m.box(m.types.minf,m.box(m.types.vmhd,m.VMHD),m.DINF,m.stbl(h))},m.moof=function(h,l,f){return m.box(m.types.moof,m.mfhd(h),m.traf(f,l))},m.moov=function(h){for(var l=h.length,f=[];l--;)f[l]=m.trak(h[l]);return m.box.apply(null,[m.types.moov,m.mvhd(h[0].timescale,h[0].duration)].concat(f).concat(m.mvex(h)))},m.mvex=function(h){for(var l=h.length,f=[];l--;)f[l]=m.trex(h[l]);return m.box.apply(null,[m.types.mvex].concat(f))},m.mvhd=function(h,l){l*=h;var f=Math.floor(l/(t+1)),d=Math.floor(l%(t+1)),f=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,255&h,f>>24,f>>16&255,f>>8&255,255&f,d>>24,d>>16&255,d>>8&255,255&d,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m.box(m.types.mvhd,f)},m.sdtp=function(h){var l,f=h.samples||[],d=new Uint8Array(4+f.length);for(l=0;l<f.length;l++)h=f[l].flags,d[l+4]=h.dependsOn<<4|h.isDependedOn<<2|h.hasRedundancy;return m.box(m.types.sdtp,d)},m.stbl=function(h){return m.box(m.types.stbl,m.stsd(h),m.box(m.types.stts,m.STTS),m.box(m.types.stsc,m.STSC),m.box(m.types.stsz,m.STSZ),m.box(m.types.stco,m.STCO))},m.avc1=function(h){var l,f,d,a=[],b=[];for(l=0;l<h.sps.length;l++)d=(f=h.sps[l]).byteLength,a.push(d>>>8&255),a.push(255&d),a=a.concat(Array.prototype.slice.call(f));for(l=0;l<h.pps.length;l++)d=(f=h.pps[l]).byteLength,b.push(d>>>8&255),b.push(255&d),b=b.concat(Array.prototype.slice.call(f));l=m.box(m.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|h.sps.length].concat(a).concat([h.pps.length]).concat(b)));f=h.width;d=h.height;a=h.pixelRatio[0];h=h.pixelRatio[1];return m.box(m.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,255&f,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,m.box(m.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),m.box(m.types.pasp,new Uint8Array([a>>24,a>>16&255,a>>8&255,255&a,h>>24,h>>16&255,h>>8&255,255&h])))},m.esds=function(h){var l=h.config.length;return new Uint8Array([0,0,0,0,3,23+l,0,1,0,4,15+l,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([l]).concat(h.config).concat([6,1,2]))},m.mp4a=function(h){var l=h.samplerate;return m.box(m.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h.channelCount,0,16,0,0,0,0,l>>8&255,255&l,0,0]),m.box(m.types.esds,m.esds(h)))},m.mp3=function(h){var l=h.samplerate;return m.box(m.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h.channelCount,0,16,0,0,0,0,l>>8&255,255&l,0,0]))},m.stsd=function(h){return"audio"===h.type?h.isAAC||"mp3"!==h.codec?m.box(m.types.stsd,m.STSD,m.mp4a(h)):m.box(m.types.stsd,m.STSD,m.mp3(h)):m.box(m.types.stsd,m.STSD,m.avc1(h))},m.tkhd=function(h){var l=h.id,f=h.duration*h.timescale,d=h.width;h=h.height;var a=Math.floor(f/(t+1)),f=Math.floor(f%(t+1));return m.box(m.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,l>>24&255,l>>16&255,l>>8&255,255&l,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,f>>24,f>>16&255,f>>8&255,255&f,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>8&255,255&d,0,0,h>>8&255,255&h,0,0]))},m.traf=function(h,l){var f=m.sdtp(h),d=h.id,a=Math.floor(l/(t+1)),b=Math.floor(l%(t+1));return m.box(m.types.traf,m.box(m.types.tfhd,new Uint8Array([0,0,0,0,d>>24,d>>16&255,d>>8&255,255&d])),m.box(m.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,b>>24,b>>16&255,b>>8&255,255&b])),m.trun(h,f.length+16+20+8+16+8+8),f)},m.trak=function(h){return h.duration=h.duration||4294967295,m.box(m.types.trak,m.tkhd(h),m.mdia(h))},m.trex=function(h){h=h.id;return m.box(m.types.trex,new Uint8Array([0,0,0,0,h>>24,h>>16&255,h>>8&255,255&h,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},m.trun=function(h,l){var f,d,a,b,c,e=h.samples||[],g=e.length;f=12+16*g;var n=new Uint8Array(f);l+=8+f;n.set([0,0,15,1,g>>>24&255,g>>>16&255,g>>>8&255,255&g,l>>>24&255,l>>>16&255,l>>>8&255,255&l],0);for(f=0;f<g;f++)a=(d=e[f]).duration,b=d.size,c=d.flags,d=d.cts,n.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,b>>>24&255,b>>>16&255,b>>>8&255,255&b,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*f);return m.box(m.types.trun,n)},m.initSegment=function(h){m.types||m.init();var l;h=m.moov(h);return(l=new Uint8Array(m.FTYP.byteLength+h.byteLength)).set(m.FTYP),l.set(h,m.FTYP.byteLength),l},m}();n["default"]=p},"./src/remux/mp4-remuxer.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t=q("./src/remux/aac-helper.js"),m=q("./src/remux/mp4-generator.js"),h=q("./src/events.js"),l=q("./src/errors.js"),f=q("./src/utils/logger.js");p=function(){function d(a,b,c,d){this.observer=a;this.config=b;this.typeSupported=c;a=navigator.userAgent;this.isSafari=d&&-1<d.indexOf("Apple")&&a&&!a.match("CriOS");this.ISGenerated=!1}return d.prototype.destroy=function(){},d.prototype.resetTimeStamp=function(a){this._initPTS=this._initDTS=a},d.prototype.resetInitSegment=function(){this.ISGenerated=!1},d.prototype.remux=function(a,b,c,d,g,l,m){if(this.ISGenerated||this.generateIS(a,b,g),this.ISGenerated){var e=a.samples.length,n=b.samples.length,p=g,q=g;if(e&&n)var r=(a.samples[0].pts-b.samples[0].pts)/b.inputTimeScale,p=p+Math.max(0,r),q=q+Math.max(0,-r);e?(a.timescale||(f.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(a,b,g)),p=this.remuxAudio(a,p,l,m),n&&(n=void 0,p&&(n=p.endPTS-p.startPTS),b.timescale||(f.logger.warn("regenerate InitSegment as video detected"),this.generateIS(a,b,g)),this.remuxVideo(b,q,l,n,m))):n&&(b=this.remuxVideo(b,q,l,0,m))&&a.codec&&this.remuxEmptyAudio(a,p,l,b)}c.samples.length&&this.remuxID3(c,g);d.samples.length&&this.remuxText(d,g);this.observer.trigger(h["default"].FRAG_PARSED)},d.prototype.generateIS=function(a,b,c){var d,g,n=this.observer,p=a.samples,q=b.samples,v=this.typeSupported,t="audio/mp4",B={},u={tracks:B},x=void 0===this._initPTS;if(x&&(d=g=1/0),a.config&&p.length&&(a.timescale=a.samplerate,f.logger.log("audio sampling rate : "+a.samplerate),a.isAAC||(v.mpeg?(t="audio/mpeg",a.codec=""):v.mp3&&(a.codec="mp3")),B.audio={container:t,codec:a.codec,initSegment:!a.isAAC&&v.mpeg?new Uint8Array:m["default"].initSegment([a]),metadata:{channelCount:a.channelCount}},x&&(d=g=p[0].pts-a.inputTimeScale*c)),b.sps&&b.pps&&q.length)a=b.inputTimeScale,b.timescale=a,B.video={container:"video/mp4",codec:b.codec,initSegment:m["default"].initSegment([b]),metadata:{width:b.width,height:b.height}},x&&(d=Math.min(d,q[0].pts-a*c),g=Math.min(g,q[0].dts-a*c),this.observer.trigger(h["default"].INIT_PTS_FOUND,{initPTS:d}));Object.keys(B).length?(n.trigger(h["default"].FRAG_PARSING_INIT_SEGMENT,u),this.ISGenerated=!0,x&&(this._initPTS=d,this._initDTS=g)):n.trigger(h["default"].ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},d.prototype.remuxVideo=function(a,b,c,d,g){var e,n,p,q;p=8;var t=a.timescale,B=a.samples,u=[],x=B.length,y=this._PTSNormalize,A=this._initPTS,H=this.nextAvcDts,ba=this.isSafari;if(0!==x){ba&&(c|=B.length&&H&&(g&&.1>Math.abs(b-H/t)||Math.abs(B[0].pts-H-A)<t/5));c||(H=b*t);B.forEach(function(a){a.pts=y(a.pts-A,H);a.dts=y(a.dts-A,H)});B.sort(function(a,b){var c=a.pts-b.pts;return a.dts-b.dts||c||a.id-b.id});b=B.reduce(function(a,b){return Math.max(Math.min(a,b.pts-b.dts),-18E3)},0);if(0>b){f.logger.warn("PTS \x3c DTS detected in video samples, shifting DTS by "+Math.round(b/90)+" ms to overcome this issue");for(var T=0;T<B.length;T++)B[T].dts+=b}T=B[0];g=Math.max(T.dts,0);b=Math.max(T.pts,0);q=Math.round((g-H)/90);c&&q&&(1<q?f.logger.log("AVC:"+q+" ms hole between fragments detected,filling it"):-1>q&&f.logger.log("AVC:"+-q+" ms overlapping between fragments detected"),g=H,B[0].dts=g,b=Math.max(b-q,H),B[0].pts=b,f.logger.log("Video/PTS/DTS adjusted: "+Math.round(b/90)+"/"+Math.round(g/90)+",delta:"+q+" ms"));T=B[B.length-1];q=Math.max(T.dts,0);c=Math.max(T.pts,0,q);ba&&(e=Math.round((q-g)/(B.length-1)));for(var W=0,J=0,T=0;T<x;T++){for(var V=B[T],ca=V.units,X=ca.length,da=0,U=0;U<X;U++)da+=ca[U].data.length;J+=da;W+=X;V.length=da;V.dts=ba?g+T*e:Math.max(V.dts,g);V.pts=Math.max(V.pts,V.dts)}T=J+4*W+8;try{n=new Uint8Array(T)}catch(na){return void this.observer.trigger(h["default"].ERROR,{type:l.ErrorTypes.MUX_ERROR,details:l.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:T,reason:"fail allocating video mdat "+T})}W=new DataView(n.buffer);W.setUint32(0,T);n.set(m["default"].types.mdat,4);for(T=0;T<x;T++){J=B[T];ca=J.units;V=0;X=void 0;U=0;for(X=ca.length;U<X;U++){var ia=ca[U],da=ia.data,ia=ia.data.byteLength;W.setUint32(p,ia);p+=4;n.set(da,p);p+=ia;V+=4+ia}ba?X=Math.max(0,e*Math.round((J.pts-J.dts)/e)):(T<x-1?e=B[T+1].dts-J.dts:(X=this.config,U=J.dts-B[0<T?T-1:T].dts,X.stretchShortVideoTrack?(ca=(d?b+d*t:this.nextAudioPts)-J.pts,Math.floor(X.maxBufferHole*t)<ca?(0>(e=ca-U)&&(e=U),f.logger.log("It is approximately "+ca/90+" ms to the next segment; using duration "+e/90+" ms for the last video frame.")):e=U):e=U),X=Math.round(J.pts-J.dts));u.push({size:V,duration:e,cts:X,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:J.key?2:1,isNonSync:J.key?0:1}})}this.nextAvcDts=q+e;d=a.dropped;if(a.len=0,a.nbNalu=0,a.dropped=0,u.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome"))p=u[0].flags,p.dependsOn=2,p.isNonSync=0;a.samples=u;p=m["default"].moof(a.sequenceNumber++,g,a);a.samples=[];a={data1:p,data2:n,startPTS:b/t,endPTS:(c+e)/t,startDTS:g/t,endDTS:this.nextAvcDts/t,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:d};return this.observer.trigger(h["default"].FRAG_PARSING_DATA,a),a}},d.prototype.remuxAudio=function(a,b,c,d){var e,n,p,q,v,u,B,x=a.inputTimeScale;v=x/a.timescale;var y=(a.isAAC?1024:1152)*v,A=this._PTSNormalize,Q=this._initPTS,H=!a.isAAC&&this.typeSupported.mpeg,ba=a.samples,T=[],W=this.nextAudioPts;if(c|=ba.length&&W&&(d&&.1>Math.abs(b-W/x)||Math.abs(ba[0].pts-W-Q)<20*y),ba.forEach(function(a){a.pts=a.dts=A(a.pts-Q,b*x)}),0!==(ba=ba.filter(function(a){return 0<=a.pts})).length){if(c||(W=d?b*x:ba[0].pts),a.isAAC)for(var J=this.config.maxAudioFramesDrift,V=0,ca=W;V<ba.length;){var X=ba[V];d=(U=X.pts)-ca;U=Math.abs(1E3*d/x);if(d<=-J*y)f.logger.warn("Dropping 1 audio frame @ "+(ca/x).toFixed(3)+"s due to "+Math.round(U)+" ms overlap."),ba.splice(V,1),a.len-=X.unit.length;else{if(J*y<=d&&1E4>U&&ca)for(U=Math.round(d/y),f.logger.warn("Injecting "+U+" audio frame @ "+(ca/x).toFixed(3)+"s due to "+Math.round(1E3*d/x)+" ms gap."),d=0;d<U;d++){var da=Math.max(ca,0);(p=t["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount))||(f.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),p=X.unit.subarray());ba.splice(V,0,{unit:p,pts:da,dts:da});a.len+=p.length;ca+=y;V++}else Math.abs(d);X.pts=X.dts=ca;ca+=y;V++}}d=0;for(J=ba.length;d<J;d++){var V=ba[d],ca=V.unit,U=V.pts;if(void 0!==B)n.duration=Math.round((U-B)/v);else{V=Math.round(1E3*(U-W)/x);X=0;if(c&&a.isAAC&&V){if(0<V&&1E4>V)X=Math.round((U-W)/y),f.logger.log(V+" ms hole between AAC samples detected,filling it"),0<X&&((p=t["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount))||(p=ca.subarray()),a.len+=X*p.length);else if(-12>V){f.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(W/x).toFixed(3)+"s/"+(U/x).toFixed(3)+"s/"+-V+"ms");a.len-=ca.byteLength;continue}U=W}if(u=U,!(0<a.len))return;n=H?a.len:a.len+8;e=H?0:8;try{q=new Uint8Array(n)}catch(ia){return void this.observer.trigger(h["default"].ERROR,{type:l.ErrorTypes.MUX_ERROR,details:l.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:n,reason:"fail allocating audio mdat "+n})}H||((new DataView(q.buffer)).setUint32(0,n),q.set(m["default"].types.mdat,4));for(V=0;V<X;V++)(p=t["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount))||(f.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),p=ca.subarray()),q.set(p,e),e+=p.byteLength,n={size:p.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(n)}q.set(ca,e);n=ca.byteLength;e+=n;n={size:n,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};T.push(n);B=U}W=0;c=T.length;return(2<=c&&(W=T[c-2].duration,n.duration=W),c)?(this.nextAudioPts=W=B+v*W,a.len=0,a.samples=T,v=H?new Uint8Array:m["default"].moof(a.sequenceNumber++,u/v,a),a.samples=[],a=u/x,u=W/x,q={data1:v,data2:q,startPTS:a,endPTS:u,startDTS:a,endDTS:u,type:"audio",hasAudio:!0,hasVideo:!1,nb:c},this.observer.trigger(h["default"].FRAG_PARSING_DATA,q),q):null}},d.prototype.remuxEmptyAudio=function(a,b,c,d){var e=a.inputTimeScale,h=this.nextAudioPts,h=(void 0!==h?h:d.startDTS*e)+this._initDTS,l=e/(a.samplerate?a.samplerate:e)*1024;d=Math.ceil((d.endDTS*e+this._initDTS-h)/l);e=t["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount);if(f.logger.warn("remux empty Audio"),e){for(var m=[],n=0;n<d;n++){var p=h+n*l;m.push({unit:e,pts:p,dts:p});a.len+=e.length}a.samples=m;this.remuxAudio(a,b,c)}else f.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},d.prototype.remuxID3=function(a){var b,c=a.samples.length,d=a.inputTimeScale,f=this._initPTS,l=this._initDTS;if(c){for(var m=0;m<c;m++)(b=a.samples[m]).pts=(b.pts-f)/d,b.dts=(b.dts-l)/d;this.observer.trigger(h["default"].FRAG_PARSING_METADATA,{samples:a.samples})}a.samples=[]},d.prototype.remuxText=function(a){a.samples.sort(function(a,b){return a.pts-b.pts});var b,c=a.samples.length,d=a.inputTimeScale,f=this._initPTS;if(c){for(var l=0;l<c;l++)(b=a.samples[l]).pts=(b.pts-f)/d;this.observer.trigger(h["default"].FRAG_PARSING_USERDATA,{samples:a.samples})}a.samples=[]},d.prototype._PTSNormalize=function(a,b){var c;if(void 0===b)return a;for(c=b<a?-8589934592:8589934592;4294967296<Math.abs(a-b);)a+=c;return a},d}();n["default"]=p},"./src/remux/passthrough-remuxer.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t=q("./src/events.js");p=function(){function m(h){this.observer=h}return m.prototype.destroy=function(){},m.prototype.resetTimeStamp=function(){},m.prototype.resetInitSegment=function(){},m.prototype.remux=function(h,l,f,d,a,b,c,e){f=this.observer;d="";h&&(d+="audio");l&&(d+="video");f.trigger(t["default"].FRAG_PARSING_DATA,{data1:e,startPTS:a,startDTS:a,type:d,hasAudio:!!h,hasVideo:!!l,nb:1,dropped:0});f.trigger(t["default"].FRAG_PARSED)},m}();n["default"]=p},"./src/task-loop.js":function(p,n,q){var t,m=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,l){h.__proto__=l}||function(h,l){for(var f in l)l.hasOwnProperty(f)&&(h[f]=l[f])},function(h,l){function f(){this.constructor=h}t(h,l);h.prototype=null===l?Object.create(l):(f.prototype=l.prototype,new f)});Object.defineProperty(n,"__esModule",{value:!0});p=function(h){function l(f){for(var d=[],a=1;a<arguments.length;a++)d[a-1]=arguments[a];d=h.apply(this,[f].concat(d))||this;return d._tickInterval=null,d._tickTimer=null,d._tickCallCount=0,d._boundTick=d.tick.bind(d),d}return m(l,h),l.prototype.onHandlerDestroying=function(){this.clearNextTick();this.clearInterval()},l.prototype.hasInterval=function(){return!!this._tickInterval},l.prototype.hasNextTick=function(){return!!this._tickTimer},l.prototype.setInterval=function(f){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,f),!0)},l.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),!(this._tickInterval=null))},l.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),!(this._tickTimer=null))},l.prototype.tick=function(){this._tickCallCount++;1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},l.prototype.doTick=function(){},l}(q("./src/event-handler.js")["default"]);n["default"]=p},"./src/utils/attr-list.js":function(p,n,q){(function(p){Object.defineProperty(n,"__esModule",{value:!0});var m=/^(\d+)x(\d+)$/,h=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,l=function(){function f(d){for(var a in"string"==typeof d&&(d=f.parseAttrList(d)),d)d.hasOwnProperty(a)&&(this[a]=d[a])}return f.prototype.decimalInteger=function(d){d=parseInt(this[d],10);return d>p.MAX_SAFE_INTEGER?1/0:d},f.prototype.hexadecimalInteger=function(d){if(this[d]){d=(this[d]||"0x").slice(2);d=(1&d.length?"0":"")+d;for(var a=new Uint8Array(d.length/2),b=0;b<d.length/2;b++)a[b]=parseInt(d.slice(2*b,2*b+2),16);return a}return null},f.prototype.hexadecimalIntegerAsNumber=function(d){d=parseInt(this[d],16);return d>p.MAX_SAFE_INTEGER?1/0:d},f.prototype.decimalFloatingPoint=function(d){return parseFloat(this[d])},f.prototype.enumeratedString=function(d){return this[d]},f.prototype.decimalResolution=function(d){d=m.exec(this[d]);if(null!==d)return{width:parseInt(d[1],10),height:parseInt(d[2],10)}},f.parseAttrList=function(d){var a,b={};for(h.lastIndex=0;null!==(a=h.exec(d));){var c=a[2];0===c.indexOf('"')&&c.lastIndexOf('"')===c.length-1&&(c=c.slice(1,-1));b[a[1]]=c}return b},f}();n["default"]=l}).call(this,q("./src/polyfills/number.js").Number)},"./src/utils/binary-search.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n["default"]={search:function(n,m){for(var h=0,l=n.length-1,f,d;h<=l;){var a=m(d=n[f=(h+l)/2|0]);if(0<a)h=f+1;else{if(!(0>a))return d;l=f-1}}return null}}},"./src/utils/buffer-helper.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(){}return n.isBuffered=function(m,h){try{if(m)for(var l=m.buffered,f=0;f<l.length;f++)if(h>=l.start(f)&&h<=l.end(f))return!0}catch(d){}return!1},n.bufferInfo=function(m,h,l){try{if(m){var f=m.buffered;m=[];for(var d=void 0,d=0;d<f.length;d++)m.push({start:f.start(d),end:f.end(d)});return this.bufferedInfo(m,h,l)}}catch(a){}return{len:0,start:h,end:h,nextStart:void 0}},n.bufferedInfo=function(m,h,l){var f,d,a,b,c=[];m.sort(function(a,b){return a.start-b.start||b.end-a.end});for(b=0;b<m.length;b++)(f=c.length)?(d=c[f-1].end,m[b].start-d<l?m[b].end>d&&(c[f-1].end=m[b].end):c.push(m[b])):c.push(m[b]);m=b=0;for(f=d=h;b<c.length;b++){var e=c[b].start,g=c[b].end;if(e<=h+l&&h<g)f=e,m=(d=g)-h;else if(h+l<e){a=e;break}}return{len:m,start:f,end:d,nextStart:a}},n}();n.BufferHelper=p},"./src/utils/cea-608-parser.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m=function(a){var b=a;return t.hasOwnProperty(a)&&(b=t[a]),String.fromCharCode(b)},h={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},f={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},a="white green blue cyan red yellow magenta black transparent".split(" "),b={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(a){this.time=a},log:function(a,b){this.verboseFilter[a];this.verboseLevel}},c=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].toString(16));return b},e=function(){function a(a,b,c,d,e){this.foreground=a||"white";this.underline=b||!1;this.italics=c||!1;this.background=d||"black";this.flash=e||!1}return a.prototype.reset=function(){this.foreground="white";this.italics=this.underline=!1;this.background="black";this.flash=!1},a.prototype.setStyles=function(a){for(var b=["foreground","underline","italics","background","flash"],c=0;c<b.length;c++){var d=b[c];a.hasOwnProperty(d)&&(this[d]=a[d])}},a.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},a.prototype.equals=function(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash},a.prototype.copy=function(a){this.foreground=a.foreground;this.underline=a.underline;this.italics=a.italics;this.background=a.background;this.flash=a.flash},a.prototype.toString=function(){return"color\x3d"+this.foreground+", underline\x3d"+this.underline+", italics\x3d"+this.italics+", background\x3d"+this.background+", flash\x3d"+this.flash},a}(),g=function(){function a(a,b,c,d,f,g){this.uchar=a||" ";this.penState=new e(b,c,d,f,g)}return a.prototype.reset=function(){this.uchar=" ";this.penState.reset()},a.prototype.setChar=function(a,b){this.uchar=a;this.penState.copy(b)},a.prototype.setPenState=function(a){this.penState.copy(a)},a.prototype.equals=function(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)},a.prototype.copy=function(a){this.uchar=a.uchar;this.penState.copy(a.penState)},a.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},a}(),r=function(){function a(){this.chars=[];for(var a=0;100>a;a++)this.chars.push(new g);this.pos=0;this.currPenState=new e}return a.prototype.equals=function(a){for(var b=!0,c=0;100>c;c++)if(!this.chars[c].equals(a.chars[c])){b=!1;break}return b},a.prototype.copy=function(a){for(var b=0;100>b;b++)this.chars[b].copy(a.chars[b])},a.prototype.isEmpty=function(){for(var a=!0,b=0;100>b;b++)if(!this.chars[b].isEmpty()){a=!1;break}return a},a.prototype.setCursor=function(a){this.pos!==a&&(this.pos=a);0>this.pos?(b.log("ERROR","Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(b.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},a.prototype.moveCursor=function(a){var b=this.pos+a;if(1<a)for(a=this.pos+1;a<b+1;a++)this.chars[a].setPenState(this.currPenState);this.setCursor(b)},a.prototype.backSpace=function(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)},a.prototype.insertChar=function(a){144<=a&&this.backSpace();var c=m(a);100<=this.pos?b.log("ERROR","Cannot insert "+a.toString(16)+" ("+c+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(c,this.currPenState),this.moveCursor(1))},a.prototype.clearFromPos=function(a){for(;100>a;a++)this.chars[a].reset()},a.prototype.clear=function(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()},a.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},a.prototype.getTextString=function(){for(var a=[],b=!0,c=0;100>c;c++){var d=this.chars[c].uchar;" "!==d&&(b=!1);a.push(d)}return b?"":a.join("")},a.prototype.setPenStyles=function(a){this.currPenState.setStyles(a);this.chars[this.pos].setPenState(this.currPenState)},a}(),u=function(){function a(){this.rows=[];for(var a=0;15>a;a++)this.rows.push(new r);this.currRow=14;this.nrRollUpRows=null;this.reset()}return a.prototype.reset=function(){for(var a=0;15>a;a++)this.rows[a].clear();this.currRow=14},a.prototype.equals=function(a){for(var b=!0,c=0;15>c;c++)if(!this.rows[c].equals(a.rows[c])){b=!1;break}return b},a.prototype.copy=function(a){for(var b=0;15>b;b++)this.rows[b].copy(a.rows[b])},a.prototype.isEmpty=function(){for(var a=!0,b=0;15>b;b++)if(!this.rows[b].isEmpty()){a=!1;break}return a},a.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},a.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},a.prototype.insertChar=function(a){this.rows[this.currRow].insertChar(a)},a.prototype.setPen=function(a){this.rows[this.currRow].setPenStyles(a)},a.prototype.moveCursor=function(a){this.rows[this.currRow].moveCursor(a)},a.prototype.setCursor=function(a){b.log("INFO","setCursor: "+a);this.rows[this.currRow].setCursor(a)},a.prototype.setPAC=function(a){b.log("INFO","pacData \x3d "+JSON.stringify(a));var c=a.row-1;if(this.nrRollUpRows&&c<this.nrRollUpRows-1&&(c=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==c){for(var d=0;15>d;d++)this.rows[d].clear();var e=this.currRow+1-this.nrRollUpRows,f=this.lastOutputScreen;if(f&&(d=f.rows[e].cueStartTime)&&d<b.time)for(d=0;d<this.nrRollUpRows;d++)this.rows[c-this.nrRollUpRows+d+1].copy(f.rows[e+d])}this.currRow=c;c=this.rows[this.currRow];null!==a.indent&&(e=Math.max(a.indent-1,0),c.setCursor(a.indent),a.color=c.chars[e].penState.foreground);this.setPen({foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1})},a.prototype.setBkgData=function(a){b.log("INFO","bkgData \x3d "+JSON.stringify(a));this.backSpace();this.setPen(a);this.insertChar(32)},a.prototype.setRollUpRows=function(a){this.nrRollUpRows=a},a.prototype.rollUp=function(){if(null!==this.nrRollUpRows){b.log("TEXT",this.getDisplayText());var a=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];a.clear();this.rows.splice(this.currRow,0,a);b.log("INFO","Rolling up")}else b.log("DEBUG","roll_up but nrRollUpRows not set yet")},a.prototype.getDisplayText=function(a){a=a||!1;for(var b=[],c="",d=-1,e=0;15>e;e++){var f=this.rows[e].getTextString();f&&(d=e+1,a?b.push("Row "+d+": '"+f+"'"):b.push(f.trim()))}return 0<b.length&&(c=a?"["+b.join(" | ")+"]":b.join("\n")),c},a.prototype.getTextAndFormat=function(){return this.rows},a}(),y=function(){function a(a,b){this.chNr=a;this.outputFilter=b;this.mode=null;this.verbose=0;this.displayedMemory=new u;this.nonDisplayedMemory=new u;this.lastOutputScreen=new u;this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.cueStartTime=this.mode=null}return a.prototype.reset=function(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.lastCueEndTime=this.cueStartTime=this.mode=null},a.prototype.getHandler=function(){return this.outputFilter},a.prototype.setHandler=function(a){this.outputFilter=a},a.prototype.setPAC=function(a){this.writeScreen.setPAC(a)},a.prototype.setBkgData=function(a){this.writeScreen.setBkgData(a)},a.prototype.setMode=function(a){a!==this.mode&&(this.mode=a,b.log("INFO","MODE\x3d"+a),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=a)},a.prototype.insertChars=function(a){for(var c=0;c<a.length;c++)this.writeScreen.insertChar(a[c]);b.log("INFO",(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0));"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(b.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},a.prototype.ccRCL=function(){b.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")},a.prototype.ccBS=function(){b.log("INFO","BS - BackSpace");"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},a.prototype.ccAOF=function(){},a.prototype.ccAON=function(){},a.prototype.ccDER=function(){b.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()},a.prototype.ccRU=function(a){b.log("INFO","RU("+a+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(a)},a.prototype.ccFON=function(){b.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:!0})},a.prototype.ccRDC=function(){b.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")},a.prototype.ccTR=function(){b.log("INFO","TR");this.setMode("MODE_TEXT")},a.prototype.ccRTD=function(){b.log("INFO","RTD");this.setMode("MODE_TEXT")},a.prototype.ccEDM=function(){b.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)},a.prototype.ccCR=function(){b.log("CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)},a.prototype.ccENM=function(){b.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()},a.prototype.ccEOC=function(){if(b.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var a=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.writeScreen=this.nonDisplayedMemory=a;b.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},a.prototype.ccTO=function(a){b.log("INFO","TO("+a+") - Tab Offset");this.writeScreen.moveCursor(a)},a.prototype.ccMIDROW=function(a){var c={flash:!1};(c.underline=1==a%2,c.italics=46<=a,c.italics)?c.foreground="white":c.foreground="white green blue cyan red yellow magenta".split(" ")[Math.floor(a/2)-16];b.log("INFO","MIDROW: "+JSON.stringify(c));this.writeScreen.setPen(c)},a.prototype.outputDataUpdate=function(a){void 0===a&&(a=!1);var c=b.time;null!==c&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,c,this.lastOutputScreen),!0===a&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:c):this.cueStartTime=c,this.lastOutputScreen.copy(this.displayedMemory))},a.prototype.cueSplitAtTime=function(a){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a))},a}();p=function(){function e(a,b,c){this.field=a||1;this.outputs=[b,c];this.channels=[new y(1,b),new y(2,c)];this.currChNr=-1;this.lastCmdB=this.lastCmdA=null;this.bufferedData=[];this.lastTime=this.startTime=null;this.dataCounters={padding:0,"char":0,cmd:0,other:0}}return e.prototype.getHandler=function(a){return this.channels[a].getHandler()},e.prototype.setHandler=function(a,b){this.channels[a].setHandler(b)},e.prototype.addData=function(a,d){var e,f,g,h=!1;this.lastTime=a;b.setTime(a);for(var l=0;l<d.length;l+=2)if(f=127&d[l],g=127&d[l+1],0!==f||0!==g){if(b.log("DATA","["+c([d[l],d[l+1]])+"] -\x3e ("+c([f,g])+")"),(e=this.parseCmd(f,g))||(e=this.parseMidrow(f,g)),e||(e=this.parsePAC(f,g)),e||(e=this.parseBackgroundAttributes(f,g)),!e)if(h=this.parseChars(f,g))this.currChNr&&0<=this.currChNr?this.channels[this.currChNr-1].insertChars(h):b.log("WARNING","No channel found yet. TEXT-MODE?");e?this.dataCounters.cmd+=2:h?this.dataCounters["char"]+=2:(this.dataCounters.other+=2,b.log("WARNING","Couldn't parse cleaned data "+c([f,g])+" orig: "+c([d[l],d[l+1]])))}else this.dataCounters.padding+=2},e.prototype.parseCmd=function(a,d){var e;if(!((20===a||28===a)&&32<=d&&47>=d||(23===a||31===a)&&33<=d&&35>=d))return!1;if(a===this.lastCmdA&&d===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,b.log("DEBUG","Repeated command ("+c([a,d])+") is dropped"),!0;e=20===a||23===a?1:2;var f=this.channels[e-1];return 20===a||28===a?32===d?f.ccRCL():33===d?f.ccBS():34===d?f.ccAOF():35===d?f.ccAON():36===d?f.ccDER():37===d?f.ccRU(2):38===d?f.ccRU(3):39===d?f.ccRU(4):40===d?f.ccFON():41===d?f.ccRDC():42===d?f.ccTR():43===d?f.ccRTD():44===d?f.ccEDM():45===d?f.ccCR():46===d?f.ccENM():47===d&&f.ccEOC():f.ccTO(d-32),this.lastCmdA=a,this.lastCmdB=d,this.currChNr=e,!0},e.prototype.parseMidrow=function(a,d){var e=null;return(17===a||25===a)&&32<=d&&47>=d&&((e=17===a?1:2)!==this.currChNr?(b.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[e-1].ccMIDROW(d),b.log("DEBUG","MIDROW ("+c([a,d])+")"),!0))},e.prototype.parsePAC=function(a,b){var c;if(!((17<=a&&23>=a||25<=a&&31>=a)&&64<=b&&127>=b||(16===a||24===a)&&64<=b&&95>=b))return!1;if(a===this.lastCmdA&&b===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);c=23>=a?1:2;var e=this.interpretPAC(64<=b&&95>=b?1===c?h[a]:f[a]:1===c?l[a]:d[a],b);return this.channels[c-1].setPAC(e),this.lastCmdA=a,this.lastCmdB=b,this.currChNr=c,!0},e.prototype.interpretPAC=function(a,b){var c=b,d={color:null,italics:!1,indent:null,underline:!1,row:a};return c=95<b?b-96:b-64,d.underline=1==(1&c),13>=c?d.color="white green blue cyan red yellow magenta white".split(" ")[Math.floor(c/2)]:15>=c?(d.italics=!0,d.color="white"):d.indent=4*Math.floor((c-16)/2),d},e.prototype.parseChars=function(a,d){var e=null,f=null,g=null;17<=(g=25<=a?(e=2,a-8):(e=1,a))&&19>=g?(f=17===g?d+80:18===g?d+112:d+144,b.log("INFO","Special char '"+m(f)+"' in channel "+e),f=[f]):32<=a&&127>=a&&(f=0===d?[a]:[a,d]);f&&(e=c(f),b.log("DEBUG","Char codes \x3d  "+e.join(",")),this.lastCmdB=this.lastCmdA=null);return f},e.prototype.parseBackgroundAttributes=function(b,c){var d,e,f;return((16===b||24===b)&&32<=c&&47>=c||(23===b||31===b)&&45<=c&&47>=c)&&(d={},16===b||24===b?(e=Math.floor((c-32)/2),d.background=a[e],1==c%2&&(d.background+="_semi")):45===c?d.background="transparent":(d.foreground="black",47===c&&(d.underline=!0)),f=24>b?1:2,this.channels[f-1].setBkgData(d),this.lastCmdA=null,!(this.lastCmdB=null))},e.prototype.reset=function(){for(var a=0;a<this.channels.length;a++)this.channels[a]&&this.channels[a].reset();this.lastCmdB=this.lastCmdA=null},e.prototype.cueSplitAtTime=function(a){for(var b=0;b<this.channels.length;b++)this.channels[b]&&this.channels[b].cueSplitAtTime(a)},e}();n["default"]=p},"./src/utils/codecs.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};n.isCodecType=function(m,h){var l=t[h];return!!l&&!0===l[m.slice(0,4)]};n.isCodecSupportedInMp4=function(m,h){return window.MediaSource.isTypeSupported((h||"video")+'/mp4;codecs\x3d"'+m+'"')}},"./src/utils/cues.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t=q("./src/utils/vttparser.js");n.newCue=function(m,h,l,f){for(var d,a,b,c,e=window.VTTCue||window.TextTrackCue,g=0;g<f.rows.length;g++)if(a=!0,b=0,c="",!(d=f.rows[g]).isEmpty()){for(var n=0;n<d.chars.length;n++)d.chars[n].uchar.match(/\s/)&&a?b++:(c+=d.chars[n].uchar,a=!1);(d.cueStartTime=h)===l&&(l+=1E-4);d=new e(h,l,t.fixLineBreaks(c.trim()));16<=b?b--:b++;navigator.userAgent.match(/Firefox\//)?d.line=g+1:d.line=7<g?g-2:g+1;d.align="left";d.position=Math.max(0,Math.min(100,b/32*100+(navigator.userAgent.match(/Firefox\//)?50:0)));m.addCue(d)}}},"./src/utils/discontinuities.js":function(p,n,q){(function(p){function m(a,b){for(var c=null,d=0;d<a.length;d+=1){var e=a[d];if(e&&e.cc===b){c=e;break}}return c}function h(a,b,c){var d=!1;return b&&b.details&&c&&(c.endCC>c.startCC||a&&a.cc<c.startCC)&&(d=!0),d}function l(a,b){var d=a.fragments,e=b.fragments;if(e.length&&d.length){if((d=m(d,e[0].cc))&&(!d||d.startPTS))return d;c.logger.log("No frag in previous level to align on")}else c.logger.log("No fragments to align")}function f(a,b){b.fragments.forEach(function(b){if(b){var c=b.start+a;b.start=b.startPTS=c;b.endPTS=c+b.duration}});b.PTSKnown=!0}function d(a,b,d){h(a,d,b)&&(a=l(d.details,b))&&(c.logger.log("Adjusting PTS using last level due to CC increase within current level"),f(a.start,b))}function a(a,b){if(b&&b.fragments.length&&a.hasProgramDateTime&&b.hasProgramDateTime){var d=(a.fragments[0].programDateTime-b.fragments[0].programDateTime)/1E3+b.fragments[0].start;p.isFinite(d)&&(c.logger.log("adjusting PTS using programDateTime delta, sliding:"+d.toFixed(3)),f(d,a))}}Object.defineProperty(n,"__esModule",{value:!0});var b=q("./src/utils/binary-search.js"),c=q("./src/utils/logger.js");n.findFirstFragWithCC=m;n.findFragWithCC=function(a,c){return b["default"].search(a,function(a){return a.cc<c?1:a.cc>c?-1:0})};n.shouldAlignOnDiscontinuities=h;n.findDiscontinuousReferenceFrag=l;n.adjustPts=f;n.alignStream=function(b,c,f){d(b,f,c);!f.PTSKnown&&c&&a(f,c.details)};n.alignDiscontinuities=d;n.alignPDT=a}).call(this,q("./src/polyfills/number.js").Number)},"./src/utils/ewma-bandwidth-estimator.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t=q("./src/utils/ewma.js");p=function(){function m(h,l,f,d){this.hls=h;this.defaultEstimate_=d;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new t["default"](l);this.fast_=new t["default"](f)}return m.prototype.sample=function(h,l){var f=8E3*l/(h=Math.max(h,this.minDelayMs_)),d=h/1E3;this.fast_.sample(d,f);this.slow_.sample(d,f)},m.prototype.canEstimate=function(){var h=this.fast_;return h&&h.getTotalWeight()>=this.minWeight_},m.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},m.prototype.destroy=function(){},m}();n["default"]=p},"./src/utils/ewma.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(m){this.alpha_=m?Math.exp(Math.log(.5)/m):0;this.totalWeight_=this.estimate_=0}return n.prototype.sample=function(m,h){var l=Math.pow(this.alpha_,m);this.estimate_=h*(1-l)+l*this.estimate_;this.totalWeight_+=m},n.prototype.getTotalWeight=function(){return this.totalWeight_},n.prototype.getEstimate=function(){return this.alpha_?this.estimate_/(1-Math.pow(this.alpha_,this.totalWeight_)):this.estimate_},n}();n["default"]=p},"./src/utils/get-self-scope.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n.getSelfScope=function(){return"undefined"==typeof window?self:window}},"./src/utils/logger.js":function(p,n,q){function t(){}function m(d){for(var a=[],b=1;b<arguments.length;b++)a[b-1]=arguments[b];a.forEach(function(a){var b;l[a]=d[a]?d[a].bind(d):(b=f.console[a])?function(){for(var c,d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];d[0]&&(d[0]=(c=d[0],"["+a+"] \x3e "+c));b.apply(f.console,d)}:t})}Object.defineProperty(n,"__esModule",{value:!0});p=q("./src/utils/get-self-scope.js");var h={trace:t,debug:t,log:t,warn:t,info:t,error:t},l=h,f=p.getSelfScope();n.enableLogs=function(d){if(!0===d||"object"==typeof d){m(d,"debug","log","info","warn","error");try{l.log()}catch(a){l=h}}else l=h};n.logger=l},"./src/utils/mediakeys-helper.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;n.requestMediaKeySystemAccess=p},"./src/utils/mediasource-helper.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},"./src/utils/output-filter.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});p=function(){function n(m,h){this.timelineController=m;this.trackName=h;this.screen=this.endTime=this.startTime=null}return n.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},n.prototype.newCue=function(m,h,l){(null===this.startTime||this.startTime>m)&&(this.startTime=m);this.endTime=h;this.screen=l;this.timelineController.createCaptionsTrack(this.trackName)},n}();n["default"]=p},"./src/utils/texttrack-utils.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n.sendAddTrackEvent=function(n,m){var h=null;try{h=new window.Event("addtrack")}catch(l){(h=document.createEvent("Event")).initEvent("addtrack",!1,!1)}h.track=n;m.dispatchEvent(h)};n.clearCurrentCues=function(n){if(n&&n.cues)for(;0<n.cues.length;)n.removeCue(n.cues[0])}},"./src/utils/time-ranges.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n["default"]={toString:function(n){for(var m="",h=n.length,l=0;l<h;l++)m+="["+n.start(l).toFixed(3)+","+n.end(l).toFixed(3)+"]";return m}}},"./src/utils/vttcue.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});n["default"]=function(){function n(d){return"string"==typeof d&&!!f[d.toLowerCase()]&&d.toLowerCase()}function m(d){for(var a=1;a<arguments.length;a++){var b=arguments[a],c;for(c in b)d[c]=b[c]}return d}function h(d,a,b){var c=this,e;e="undefined"!=typeof navigator?/MSIE\s8\.0/.test(navigator.userAgent):void 0;var f={};e?c=document.createElement("custom"):f.enumerable=!0;c.hasBeenReset=!1;var h="",p=!1,q=d,t=a,u=b,x=null,y="",A=!0,aa="auto",Q="start",H=50,ba="middle",T=50,W="middle";if(Object.defineProperty(c,"id",m({},f,{get:function(){return h},set:function(a){h=""+a}})),Object.defineProperty(c,"pauseOnExit",m({},f,{get:function(){return p},set:function(a){p=!!a}})),Object.defineProperty(c,"startTime",m({},f,{get:function(){return q},set:function(a){if("number"!=typeof a)throw new TypeError("Start time must be set to a number.");q=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",m({},f,{get:function(){return t},set:function(a){if("number"!=typeof a)throw new TypeError("End time must be set to a number.");t=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"text",m({},f,{get:function(){return u},set:function(a){u=""+a;this.hasBeenReset=!0}})),Object.defineProperty(c,"region",m({},f,{get:function(){return x},set:function(a){x=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",m({},f,{get:function(){return y},set:function(a){a="string"==typeof a&&!!l[a.toLowerCase()]&&a.toLowerCase();if(!1===a)throw new SyntaxError("An invalid or illegal string was specified.");y=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",m({},f,{get:function(){return A},set:function(a){A=!!a;this.hasBeenReset=!0}})),Object.defineProperty(c,"line",m({},f,{get:function(){return aa},set:function(a){if("number"!=typeof a&&"auto"!==a)throw new SyntaxError("An invalid number or illegal string was specified.");aa=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",m({},f,{get:function(){return Q},set:function(a){a=n(a);if(!a)throw new SyntaxError("An invalid or illegal string was specified.");Q=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"position",m({},f,{get:function(){return H},set:function(a){if(0>a||100<a)throw Error("Position must be between 0 and 100.");H=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",m({},f,{get:function(){return ba},set:function(a){a=n(a);if(!a)throw new SyntaxError("An invalid or illegal string was specified.");ba=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"size",m({},f,{get:function(){return T},set:function(a){if(0>a||100<a)throw Error("Size must be between 0 and 100.");T=a;this.hasBeenReset=!0}})),Object.defineProperty(c,"align",m({},f,{get:function(){return W},set:function(a){a=n(a);if(!a)throw new SyntaxError("An invalid or illegal string was specified.");W=a;this.hasBeenReset=!0}})),c.displayState=void 0,e)return c}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var l={"":!0,lr:!0,rl:!0},f={start:!0,middle:!0,end:!0,left:!0,right:!0};return h.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},h}()},"./src/utils/vttparser.js":function(p,n,q){function t(){this.window=window;this.state="INITIAL";this.buffer="";this.decoder=new a;this.regionList=[]}function m(){this.values=Object.create(null)}function h(a,b,c,d){a=d?a.split(d):[a];for(var e in a)"string"==typeof a[e]&&(d=a[e].split(c),2===d.length&&b(d[0],d[1]))}function l(a,d,f){function e(){var b=function(a){function b(a,b,c,d){return 3600*(0|a)+60*(0|b)+(0|c)+(0|d)/1E3}return(a=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/))?a[3]?b(a[1],a[2],a[3].replace(":",""),a[4]):59<a[1]?b(a[1],a[2],0,a[4]):b(0,a[1],a[2],a[4]):null}(a);if(null===b)throw Error("Malformed timestamp: "+l);return a=a.replace(/^[^\sa-zA-Z-]+/,""),b}function g(){a=a.replace(/^\s+/,"")}var l=a;if(g(),d.startTime=e(),g(),"--\x3e"!==a.substr(0,3))throw Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+l);a=a.substr(3);g();d.endTime=e();g();(function(a,d){var e=new m;h(a,function(a,b){switch(a){case "region":for(var d=f.length-1;0<=d;d--)if(f[d].id===b){e.set(a,f[d].region);break}break;case "vertical":e.alt(a,b,["rl","lr"]);break;case "line":var d=b.split(","),g=d[0];e.integer(a,g);e.percent(a,g)&&e.set("snapToLines",!1);e.alt(a,g,["auto"]);2===d.length&&e.alt("lineAlign",d[1],["start",c,"end"]);break;case "position":d=b.split(",");e.percent(a,d[0]);2===d.length&&e.alt("positionAlign",d[1],["start",c,"end","line-left","line-right","auto"]);break;case "size":e.percent(a,b);break;case "align":e.alt(a,b,["start",c,"end","left","right"])}},/:/,/\s/);d.region=e.get("region",null);d.vertical=e.get("vertical","");var g=e.get("line","auto");"auto"===g&&-1===b.line&&(g=-1);d.line=g;d.lineAlign=e.get("lineAlign","start");d.snapToLines=e.get("snapToLines",!0);d.size=e.get("size",100);d.align=e.get("align",c);g=e.get("position","auto");"auto"===g&&50===b.position&&(g="start"===d.align||"left"===d.align?0:"end"===d.align||"right"===d.align?100:50);d.position=g})(a,d)}function f(a){return a.replace(/<br(?: \/)?>/gi,"\n")}Object.defineProperty(n,"__esModule",{value:!0});var d=q("./src/utils/vttcue.js"),a=function(){return{decode:function(a){if(!a)return"";if("string"!=typeof a)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}};m.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){return!!(b.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(b=parseFloat(b))&&100>=b)&&(this.set(a,b),!0)}};var b=new d["default"](0,0,0),c="middle"===b.align?"middle":"center";n.fixLineBreaks=f;t.prototype={parse:function(a){function b(){for(var a=c.buffer,b=0,a=f(a);b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var d=a.substr(0,b);return"\r"===a[b]&&++b,"\n"===a[b]&&++b,c.buffer=a.substr(b),d}var c=this;a&&(c.buffer+=c.decoder.decode(a,{stream:!0}));try{a=void 0;if("INITIAL"===c.state){if(!/\r\n|\n/.test(c.buffer))return this;var e=(a=b()).match(/^(\u8302\u7984\u9a74)?WEBVTT([ \t].*)?$/);if(!e||!e[0])throw Error("Malformed WebVTT signature.");c.state="HEADER"}for(e=!1;c.buffer;){if(!/\r\n|\n/.test(c.buffer))return this;switch(e?e=!1:a=b(),c.state){case "HEADER":/:/.test(a)?h(a,function(a,b){},/:/):a||(c.state="ID");continue;case "NOTE":a||(c.state="ID");continue;case "ID":if(/^NOTE($|[ \t])/.test(a)){c.state="NOTE";break}if(!a)continue;if(c.cue=new d["default"](0,0,""),c.state="CUE",-1===a.indexOf("--\x3e")){c.cue.id=a;continue}case "CUE":try{l(a,c.cue,c.regionList)}catch(v){c.cue=null;c.state="BADCUE";continue}c.state="CUETEXT";continue;case "CUETEXT":var m=-1!==a.indexOf("--\x3e");if(!a||m&&(e=!0)){c.oncue&&c.oncue(c.cue);c.cue=null;c.state="ID";continue}c.cue.text&&(c.cue.text+="\n");c.cue.text+=a;continue;case "BADCUE":a||(c.state="ID")}}}catch(v){"CUETEXT"===c.state&&c.cue&&c.oncue&&c.oncue(c.cue),c.cue=null,c.state="INITIAL"===c.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw Error("Malformed WebVTT signature.");}catch(e){throw e;}return this.onflush&&this.onflush(),this}};n["default"]=t},"./src/utils/webvtt-parser.js":function(p,n,q){(function(p){Object.defineProperty(n,"__esModule",{value:!0});var m=q("./src/utils/vttparser.js"),h=q("./src/demux/id3.js"),l=function(d,a,b){return d.substr(b||0,a.length)===a},f=function(d){for(var a=5381,b=d.length;b;)a=33*a^d.charCodeAt(--b);return(a>>>0).toString()};n["default"]={parse:function(d,a,b,c,e,g){var n;d=h.utf8ArrayToStr(new Uint8Array(d)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n");var q="00:00.000",t=0,u=0,x=0,y=[],A=!0,S=new m["default"];S.oncue=function(a){var d=b[c],e=b.ccOffset;if(d&&d["new"])if(void 0!==u)e=b.ccOffset=d.start;else{var d=x,g=b[c],h=b[g.prevCC];if(!h||!h["new"]&&g["new"])b.ccOffset=b.presentationOffset=g.start,g["new"]=!1;else{for(;h&&h["new"];)b.ccOffset+=g.start-h.start,g["new"]=!1,h=b[(g=h).prevCC];b.presentationOffset=d}}x&&(e=x-b.presentationOffset);a.startTime+=e-u;a.endTime+=e-u;a.id=f(a.startTime.toString())+f(a.endTime.toString())+f(a.text);a.text=decodeURIComponent(encodeURIComponent(a.text));0<a.endTime&&y.push(a)};S.onparsingerror=function(a){n=a};S.onflush=function(){n&&g?g(n):e(y)};d.forEach(function(d){if(A){if(l(d,"X-TIMESTAMP-MAP\x3d")){A=!1;d.substr(16).split(",").forEach(function(a){l(a,"LOCAL:")?q=a.substr(6):l(a,"MPEGTS:")&&(t=parseInt(a.substr(7)))});try{0>a+(9E4*b[c].start||0)&&(a+=8589934592),t-=a,e=q,f=parseInt(e.substr(-3)),g=parseInt(e.substr(-6,2)),h=parseInt(e.substr(-9,2)),m=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0,u=(p.isFinite(f)&&p.isFinite(g)&&p.isFinite(h)&&p.isFinite(m)?(f+=1E3*g,f+=6E4*h,f+=36E5*m):-1)/1E3,x=t/9E4,-1===u&&(n=Error("Malformed X-TIMESTAMP-MAP: "+d))}catch(J){n=Error("Malformed X-TIMESTAMP-MAP: "+d)}return}""===d&&(A=!1)}var e,f,g,h,m;S.parse(d+"\n")});S.flush()}}}).call(this,q("./src/polyfills/number.js").Number)},"./src/utils/xhr-loader.js":function(p,n,q){Object.defineProperty(n,"__esModule",{value:!0});var t=q("./src/utils/logger.js"),m=window.performance,h=window.XMLHttpRequest;p=function(){function l(f){f&&f.xhrSetup&&(this.xhrSetup=f.xhrSetup)}return l.prototype.destroy=function(){this.abort();this.loader=null},l.prototype.abort=function(){var f=this.loader;f&&4!==f.readyState&&(this.stats.aborted=!0,f.abort());window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null},l.prototype.load=function(f,d,a){this.context=f;this.config=d;this.callbacks=a;this.stats={trequest:m.now(),retry:0};this.retryDelay=d.retryDelay;this.loadInternal()},l.prototype.loadInternal=function(){var f,d=this.context;f=this.loader=new h;var a=this.stats;a.tfirst=0;a.loaded=0;a=this.xhrSetup;try{if(a)try{a(f,d.url)}catch(b){f.open("GET",d.url,!0),a(f,d.url)}f.readyState||f.open("GET",d.url,!0)}catch(b){return void this.callbacks.onError({code:f.status,text:b.message},d,f)}d.rangeEnd&&f.setRequestHeader("Range","bytes\x3d"+d.rangeStart+"-"+(d.rangeEnd-1));f.onreadystatechange=this.readystatechange.bind(this);f.onprogress=this.loadprogress.bind(this);f.responseType=d.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);f.send()},l.prototype.readystatechange=function(f){f=f.currentTarget;var d=f.readyState,a=this.stats,b=this.context,c=this.config;!a.aborted&&2<=d&&((window.clearTimeout(this.requestTimeout),0===a.tfirst&&(a.tfirst=Math.max(m.now(),a.trequest)),4===d)?(d=f.status,200<=d&&300>d?(a.tload=Math.max(a.tfirst,m.now()),c=void 0,d="arraybuffer"===b.responseType?(c=f.response).byteLength:(c=f.responseText).length,a.loaded=a.total=d,this.callbacks.onSuccess({url:f.responseURL,data:c},a,b,f)):a.retry>=c.maxRetry||400<=d&&499>d?(t.logger.error(d+" while loading "+b.url),this.callbacks.onError({code:d,text:f.statusText},b,f)):(t.logger.warn(d+" while loading "+b.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,c.maxRetryDelay),a.retry++)):this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),c.timeout))},l.prototype.loadtimeout=function(){t.logger.warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)},l.prototype.loadprogress=function(f){var d=f.currentTarget,a=this.stats;a.loaded=f.loaded;f.lengthComputable&&(a.total=f.total);(f=this.callbacks.onProgress)&&f(a,this.context,null,d)},l}();n["default"]=p}})["default"]},t.exports=u())}]);